<!DOCTYPE html><html lang="en">
<head>
<meta charset="utf-8">
<meta name="format-detection" content="telephone=no">
<title>Lecture 6: Capabilities | Lecture Videos | Computer Systems Security | Electrical Engineering and Computer Science | MIT OpenCourseWare</title>
<!-- Begin Automatic Metadata Insertion --><meta content="6-858-computer-systems-security-fall-2014" name="WT.cg_n">
<meta content="Lecture 6: Capabilities" name="WT.cg_s">
<meta content="In this lecture, Professor Zeldovich continues the topic of privilege separation, discussing the usage of capabilities with regards to privilege." name="Description">
<meta content="Zeldovich, Nickolai" name="Author">
<meta content="6.858,Capsicum,confused deputy problem,ambient authority,sandboxing,virtual machine,DAC,MAC,Computer Design and Engineering,Software Design and Engineering" name="keywords">
<meta content="6.858 Computer Systems Security | Lecture 6: Capabilities" name="Search_Display">
<meta content="Computer Design and Engineering" itemprop="about">
<meta content="Software Design and Engineering" itemprop="about">
<!-- End Automatic Metadata Insertion --><link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/grid.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/base.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/menu.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.bubblepopup.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/courses_new.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/jquery.jscrollpane.css">
<link title="default" rel="stylesheet" type="text/css" href="../../../common/styles/media_tabs.css">
<link href="https://ocw.mit.edu/xml/ocwcc.rdf" type="application/rdf+xml" rel="metadata">
<link rel="canonical" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-6-capabilities/">
<link rel="apple-touch-icon" href="../../../common/images/apple-touch-icon.png">
<script type="text/javascript" src="../../../common/scripts/jquery.js"></script><script type="text/javascript" src="../../../common/scripts/ocw-media-utils-offline.js"></script><script type="text/javascript" src="../../../common/scripts/ocw-offline.js"></script><script type="text/javascript" src="../../../common/scripts/jquery.bubblepopup.min.js"></script><script type="text/javascript" src="../../../common/scripts/jquery-ui.min.js"></script><script type="text/javascript" src="../../../common/scripts/jquery.jscrollpane.min.js"></script><script type="text/javascript" src="../../../common/scripts/expandy.js"></script><script type="text/javascript" src="../../../common/scripts/bubble-popup-offline.js"></script><script type="text/javascript">
      $(document).ready(function() {
        $("#tabs").tabs();
        IpadScroller();
      });
    </script>
</head>
<body itemscope itemtype="http://schema.org/WebPage">
        
	

        <header id="top"><div id="grid">
				
				
					
<div id="portletwrapper-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572" class="portletWrapper kssattr-portlethash-6f63772e746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d686561646572">
<div class="portletStaticText portlet-static-site-header">
<!--googleoff: index-->
<div class="grid_6 alpha" id="banner"><a href="https://ocw.mit.edu/"><img src="../../../common/images/ocw_mast.png" class="logo" alt="MIT OpenCourseWare, Massachusetts Institute of Technology"></a></div>
<div class="grid_6 omega" id="subscribe">
<aside class="module" aria-label="Connect with OCW"><table class="social"><tbody><tr>
<td class="socialbutton"><a aria-label="Subscribe to the OCW Newsletter" href="https://ocw.mit.edu/subscribe/index.htm?utm_source=header"><img src="../../../common/images/trans.gif" alt="An icon depicting an envelope.">Subscribe to the OCW Newsletter</a></td>
            <td>
<a aria-label="Facebook" href="https://facebook.com/mitocw"><img src="../../../common/images/icon_fb.png" alt="Click to visit our Facebook page."></a>   <a aria-label="Twitter" href="https://twitter.com/mitocw"><img src="https://ocw.mit.edu/images/icon_twitter.png" alt="Click to visit our Twitter feed."></a>   <a aria-label="YouTube" href="https://www.youtube.com/mitocw"><img src="https://ocw.mit.edu/images/icon_yt.png" alt="Click to visit our YouTube page."></a>   <a aria-label="Open Matters blog on WordPress" href="https://mitopencourseware.wordpress.com/"><img src="https://ocw.mit.edu/images/icon_wp.png" alt="Click to visit our blog on WordPress."></a>
</td>
        </tr></tbody></table></aside><nav aria-label="Help Links" class="helplinks"><a aria-label="OCW Site Help" href="https://ocw.mit.edu/help">Help</a><span aria-hidden="true">|</span>     <a href="../../../common/jsp/feedback.htm">Contact Us</a>   </nav>
</div>
<div class="clear"> </div>
<!--googleon: index-->
</div>

</div>





<!--googleoff: index-->
<nav id="mega" class="grid_8 alpha" aria-label="Site"><ul id="menu" role="presentation">
<li id="menu_home">
        <a href="https://ocw.mit.edu/" aria-label="Homepage"><img src="../../../common/images/top-nav_home.png" class="home_icon" alt="Click for site home page."></a><!-- Begin Home Item -->
    </li>
<!-- End Home Item -->
    
    <li id="drop_1" aria-label="Find Courses" class="selected">
     <a href="#" aria-hidden="true">FIND COURSES</a><!-- Begin 5 columns Item -->
      <div class="dropdown_5columns-a mega-courses">
        <div class="col_1a">
          <div class="row_1a">
            <nav aria-labelledby="mm-find-courses-by"><span id="mm-find-courses-by" class="nav" aria-hidden="true">Find courses by:</span>
              <ul class="find_by" role="presentation">
<li><a href="https://ocw.mit.edu/courses/find-by-topic/">Topic</a></li>
                <li><a href="https://ocw.mit.edu/courses/find-by-number/">MIT Course Number</a></li>
                <li><a href="https://ocw.mit.edu/courses/find-by-department/">Department</a></li>
				<li><a href="https://ocw.mit.edu/educator/?view=instructional&amp;utm_campaign=Educator&amp;utm_source=megamenu&amp;utm_medium=find-courses&amp;utm_content=approaches">Instructional Approach</a></li>
				<li><a href="https://ocw.mit.edu/educator/?view=teaching&amp;utm_campaign=Educator&amp;utm_source=megamenu&amp;utm_medium=find-courses&amp;utm_content=materials">Teaching Materials</a></li>
             </ul></nav><nav aria-labelledby="mm-collections"><span id="mm-collections" class="nav" aria-hidden="true">Collections</span>
              <ul role="presentation">
<li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
                <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
                <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
                <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Lectures</a></li>
                <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
                <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
                <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
              </ul></nav><nav class="col_1b" aria-labelledby="mm-translated-courses"><span id="mm-translated-courses" class="nav" aria-hidden="true" style="line-height: 1.3;">Cross-Disciplinary Topic Lists</span>
							<ul role="presentation">
<li><a href="https://ocw.mit.edu/courses/energy-courses">Energy</a></li>
                				<li><a href="https://ocw.mit.edu/courses/entrepreneurship">Entrepreneurship</a></li>
				                <li><a href="https://ocw.mit.edu/courses/environment-courses">Environment</a></li>
				              	<li><a href="https://ocw.mit.edu/courses/intro-programming">Introductory Programming</a></li>
				                <li><a href="https://ocw.mit.edu/courses/life-sciences">Life Sciences</a></li>
                				<li><a href="https://ocw.mit.edu/courses/transportation-courses">Transportation</a></li>
							</ul></nav>
</div>
          <div class="row_1b">
            <nav aria-labelledby="mm-cross-disciplinary-topic-lists"><span id="mm-cross-disciplinary-topic-lists" class="nav" aria-hidden="true">Translated Courses</span>
            	<ul role="presentation">
<li><a href="https://ocw.mit.edu/courses/translated-courses/traditional-chinese" aria-label="Traditional Chinese">繁體字 / Traditional Chinese</a></li>
					<li><a href="https://ocw.mit.edu/courses/translated-courses/spanish" aria-label="Spanish">Español / Spanish</a></li>
					<li><a href="https://ocw.mit.edu/courses/translated-courses/portuguese" aria-label="Portuguese">Português / Portuguese</a></li>
					<li><a href="https://ocw.mit.edu/courses/translated-courses/persian" aria-label="Persian">فارسی / Persian</a></li>
					<li><a href="https://ocw.mit.edu/courses/translated-courses/turkish" aria-label="Turkish">Türkçe / Turkish</a></li>
					<li><a href="https://ocw.mit.edu/courses/translated-courses/korean" aria-label="Korean">(비디오)한국 / Korean</a></li>
              </ul></nav>
</div>
        </div>

      </div>
    </li>
    <li id="drop_2">
        <a href="" aria-hidden="true">About</a>
        <div class="dropdown_1column-a">
            <nav class="col_1" aria-label="About"><ul role="presentation">
<li><a href="https://ocw.mit.edu/about/">About MIT OpenCourseWare</a></li>
                    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
                    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
                    <li><a href="https://ocw.mit.edu/about/newsletter/">News</a></li>
                </ul></nav>
</div>
    </li>
    <li id="drop_3">
        <a href="" aria-hidden="true">Give Now</a>
        <div class="dropdown_1column-a">
          <nav class="col_1" aria-label="Donate"><ul role="presentation">
<li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
              <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
              <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
              <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
              <li><a href="https://ocw.mit.edu/give/shop-ocw">Shop OCW</a></li>
              <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
            </ul></nav>
</div>
    </li>
    <li id="drop_4">
      <a href="" aria-hidden="true">Featured Sites</a>
      <div class="dropdown_1column-a">
        <nav class="col_1" aria-labelledby="mm-featured-sites"><span id="mm-featured-sites" class="nav" aria-hidden="true">OCW Initiatives</span>
          <ul role="presentation">
<li><a href="https://ocw.mit.edu/high-school/">Highlights for High School</a></li>
            <li><a href="https://ocw.mit.edu/educator/?utm_campaign=Educator&amp;utm_source=megamenu&amp;utm_medium=featured-sites">OCW Educator</a></li>
            <li><a href="https://ocw.mit.edu/courses/crosslinks/">MIT Crosslinks and OCW</a></li>
            <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx and Related OCW Courses</a></li>
					</ul></nav><nav class="col_1" aria-labelledby="mm-featured-external-links"><span id="mm-featured-external-links" class="nav" aria-hidden="true">Beyond OCW</span>
					<ul>
<li><a href="https://www.k12videos.mit.edu/videos" aria-label="External Link: MIT Plus K12 Videos">MIT+K12 Videos</a></li>
						<li><a href="http://climatex.mit.edu/" aria-label="External Link: MIT ClimateX">MIT ClimateX</a></li>
            <li><a href="https://teachingexcellence.mit.edu/" aria-label="External Link: Teaching Excellence at MIT">Teaching Excellence at MIT</a></li>
						<li><a href="https://outreach.mit.edu" aria-label="External Link: Outreach at MIT">Outreach @ MIT</a></li>
						<li><a href="http://www.oeconsortium.org/" aria-label="External Link: Open Education Consortium">Open Education Consortium</a></li>
          </ul></nav>
</div>
    </li>
  </ul></nav><div id="search" role="search" class="grid_4 omega">
  
    <form aria-label="Advanced Search" method="get" action="../../../common/search/AdvancedSearch.htm">
		  <table class="search"><tbody><tr>
<td class="black"><input type="text" onblur="fillSearchBox()" onfocus="clearSearchBox()" maxlength="255" value="Search" name="q" class="greytext searchField" id="terms"></td>
            <td class="black"><input type="image" src="../../../common/images/button_search.png" name="btnG" class="sub_button"></td>
            <td class="text2"><a href="../../../common/search/AdvancedSearch.htm">Advanced<br>Search</a></td>
          </tr></tbody></table>
</form>
</div>
<div class="clear"></div>
<!--googleon: index-->
<!-- *end header* -->

				
				
			</div>
<!-- top grid end -->
		</header><!-- top end --><div id="center_media">
      	<div id="grid">
      		<div id="left">
        		<nav id="breadcrumb_media" aria-label="Breadcrumb"><p>

    <a href="https://ocw.mit.edu/">Home</a>
    
        »
        
    
    
        
            <a href="https://ocw.mit.edu/courses">Courses</a>
            
                »
                
            
            
         
    
    
        
            <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science">Electrical Engineering and Computer Science</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/index.htm">Computer Systems Security</a>
            
                »
                
            
            
         
    
    
        
            <a href="../../../contents/video-lectures/index.htm">Lecture Videos</a>
            
                »
                
            
            
         
    
    
        
            
            
            Lecture 6: Capabilities
         
    
</p>

            	</nav><div class="clear"></div>
        		<div id="media_title">
        		<h1 class="title" itemprop="name" property="dct:title">
        <span class="" id="parent-fieldname-title">
            Lecture 6: Capabilities
        </span>
    </h1>
        		</div>
           		<div class="clear"></div>
           		<div id="course_wrapper_media">
           			<nav id="course_nav" aria-label="Course"><script language="javascript" type="text/javascript">
function toggleMenu(objID) {
  if (!document.getElementById) return;
  var ob = document.getElementById(objID);
  ob.className = (ob.className == 'selected')?'': 'selected';
}
function toggleClass(id)
{
  var divtoggleClass= document.getElementById(id);
  divtoggleClass.className = (divtoggleClass.className == 'mO')?'mC': 'mO';
  return false;
}
function changeAlt(id)
{
  id.alt = (id.alt == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
  id.title = (id.title == 'Expand Menu')?'Collapse Menu' : 'Expand Menu';
}
</script><!--Left Nav Starts --><ul>
<li class="">
			   			<a href="../../../contents/index.htm">
		                  Course Home  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/syllabus/index.htm">
		                  Syllabus  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/calendar/index.htm">
		                  Calendar  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/readings/index.htm">
		                  Readings  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/lecture-notes/index.htm">
		                  Lecture Notes  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="selected">
			   			<a href="../../../contents/video-lectures/index.htm">
		                  Lecture Videos  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/labs/index.htm">
		                  Labs  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/exams/index.htm">
		                  Exams  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/final-project/index.htm">
		                  Final Project  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    <li class="">
			   			<a href="../../../contents/related-resources/index.htm">
		                  Related Resources  			                
	                    </a>
		        </li>
		    
         	
	
	
	    	
	    	    
		    
         	
	<!--second tal block close-->  
	
</ul>
<!--Left Nav Ends --></nav><main id="course_inner_media" aria-labelledby="media_title"><div class="" id="parent-fieldname-text">
            
            
        </div>
    
      					 

<script type="text/javascript">var caption_embed_1 ={'English - US': '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-6-capabilities/TQhmua7Z2cY.srt'}</script><div id="media-embed">
         <div class="attention_message" id="embed_1">
<p>Flash and JavaScript are required for this feature.</p>
<p>Download the video from <a href="https://itunes.apple.com/us/itunes-u/id1017908130">iTunes U</a> or the <a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec06_300k.mp4">Internet Archive</a>.</p>
</div>
     </div>
    
     <script type="text/javascript">ocw_embed_chapter_media('embed_1', 'https://www.youtube.com/v/TQhmua7Z2cY', 'youtube', '/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-6-capabilities', 'https://img.youtube.com/vi/TQhmua7Z2cY/0.jpg',0,0, 'https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-858-computer-systems-security-fall-2014/video-lectures/lecture-6-capabilities/TQhmua7Z2cY.srt')</script><div id="transcript1"></div>
				 <script type="text/javascript">createThreePlayParams(2, 662949, "embed_1", 0, 0)</script><div id="media_resource_next_prev_nav" style="margin-top: 1em;">
        <p>
        
            <a href="../../../contents/video-lectures/lecture-4-privilege-separation/index.htm">
                <img src="../../../common/images/btn_previous_resource.png" style="margin: 0 30px 0 50px;" alt="Previous track" title="Previous track"></a>
     	
     	
        
            <a href="../../../contents/video-lectures/lecture-7-sandboxing-native-code/index.htm"> 
                <img src="../../../common/images/btn_next_resource.png" alt="Next track" title="Next track"></a>
       
       </p>
     </div>
 


<script type="text/javascript">
		window.onload=function(){
		init();
		
		}
		var tabLinks = new Array();
		var contentDivs = new Array();
		function init() {
		  // Grab the tab links and content divs from the page
		  var tabListItems = document.getElementById('tabs').childNodes;
		  for ( var i = 0; i < tabListItems.length; i++ ) {
			if ( tabListItems[i].nodeName == "LI" ) {
			  var tabLink = getFirstChildWithTagName( tabListItems[i], 'A' );
			  var id = getHash( tabLink.getAttribute('href') );
			  tabLinks[id] = tabLink;
			  contentDivs[id] = document.getElementById( id );
			}
		  }
		  // Assign onclick events to the tab links, and
		  // highlight the first tab
		  var i = 0;
		  for ( var id in tabLinks ) {
			tabLinks[id].onclick = showTab;
			tabLinks[id].onfocus = function() { this.blur() };
			if ( i == 0 ) tabLinks[id].className = 'selected';
			i++;
		  }
		  // Hide all content divs except the first
		  var i = 0;
		  for ( var id in contentDivs ) {
			if ( i != 0 ) contentDivs[id].className = 'tabContent hide';
			i++;
		  }
		}
		function showTab() {
		  var selectedId = getHash( this.getAttribute('href') );
		  // Highlight the selected tab, and dim all others.
		  // Also show the selected content div, and hide all others.
		  for ( var id in contentDivs ) {
			if ( id == selectedId ) {
			  tabLinks[id].className = 'selected';
			  contentDivs[id].className = 'tabContent';
			} else {
			  tabLinks[id].className = '';
			  contentDivs[id].className = 'tabContent hide';
			}
		  }
		  // Stop the browser following the link
		  return false;
		}
		function getFirstChildWithTagName( element, tagName ) {
		  for ( var i = 0; i < element.childNodes.length; i++ ) {
			if ( element.childNodes[i].nodeName == tagName ) return element.childNodes[i];
		  }
		}
		function getHash( url ) {
		  var hashPos = url.lastIndexOf ( '#' );
		  return url.substring( hashPos + 1 );
		}
 </script><div id="media_tabs">
     
        <ul id="tabs">
<li class="first">
                <a href="#vid_about" class="selected">About this Video</a>
            </li>
            <li class="">
                <a href="#vid_index" class="">Playlist</a>
            </li>
            <li class="">
                <a href="#vid_playlist" class="">Transcript</a>
            </li>
            <li class="">
                <a href="#vid_related" class="">Download this Video</a>
            </li>
        </ul>
<div id="vid_about" itemprop="description" class="tabContent">
<p><strong>Description:</strong> In this lecture, Professor Zeldovich continues the topic of privilege separation, discussing the usage of capabilities with regards to privilege.</p>
<p><strong>Instructor:</strong> Nickolai Zeldovich</p>
</div>
        <div id="vid_index" itemprop="description" class="tabContent hide">
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-1-introduction-threat-models/index.htm">
<img src="https://img.youtube.com/vi/GqmQg-cszw4/default.jpg" title="Lecture 1: Introduction, Threat Models" alt="Lecture 1: Introduction, Threat Models"><p>Lecture 1: Introduction, Th...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-2-control-hijacking-attacks/index.htm">
<img src="https://img.youtube.com/vi/r4KjHEgg9Wg/default.jpg" title="Lecture 2: Control Hijacking Attacks" alt="Lecture 2: Control Hijacking Attacks"><p>Lecture 2: Control Hijackin...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-3-buffer-overflow-exploits-and-defenses/index.htm">
<img src="https://img.youtube.com/vi/xSQxaie_h1o/default.jpg" title="Lecture 3: Buffer Overflow Exploits and Defenses" alt="Lecture 3: Buffer Overflow Exploits and Defenses"><p>Lecture 3: Buffer Overflow ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-4-privilege-separation/index.htm">
<img src="https://img.youtube.com/vi/dNl22h1kW1k/default.jpg" title="Lecture 4: Privilege Separation" alt="Lecture 4: Privilege Separation"><p>Lecture 4: Privilege Separa...</p></a>
</div>
<div class="related-media-thumbnail-nolink">
<div class="now-playing-resource">Now Playing</div>
<img src="https://img.youtube.com/vi/TQhmua7Z2cY/default.jpg" title="Lecture 6: Capabilities" alt="Lecture 6: Capabilities"><p>Lecture 6: Capabilities</p>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-7-sandboxing-native-code/index.htm">
<img src="https://img.youtube.com/vi/I0Psvvky-44/default.jpg" title="Lecture 7: Sandboxing Native Code	" alt="Lecture 7: Sandboxing Native Code	"><p>Lecture 7: Sandboxing Nativ...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-8-web-security-model/index.htm">
<img src="https://img.youtube.com/vi/eRJ_r8WF1Y0/default.jpg" title="Lecture 8: Web Security Model" alt="Lecture 8: Web Security Model"><p>Lecture 8: Web Security Model</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-9-securing-web-applications/index.htm">
<img src="https://img.youtube.com/vi/WlmKwIe9z1Q/default.jpg" title="Lecture 9: Securing Web Applications" alt="Lecture 9: Securing Web Applications"><p>Lecture 9: Securing Web App...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-10-symbolic-execution/index.htm">
<img src="https://img.youtube.com/vi/yRVZPvHYHzw/default.jpg" title="Lecture 10: Symbolic Execution" alt="Lecture 10: Symbolic Execution"><p>Lecture 10: Symbolic Execution</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-11-ur-web/index.htm">
<img src="https://img.youtube.com/vi/XMEFdofERLI/default.jpg" title="Lecture 11: Ur/Web" alt="Lecture 11: Ur/Web"><p>Lecture 11: Ur/Web</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-12-network-security/index.htm">
<img src="https://img.youtube.com/vi/BZTWXl9QNK8/default.jpg" title="Lecture 12: Network Security" alt="Lecture 12: Network Security"><p>Lecture 12: Network Security</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-13-network-protocols/index.htm">
<img src="https://img.youtube.com/vi/QOtA76ga_fY/default.jpg" title="Lecture 13: Network Protocols" alt="Lecture 13: Network Protocols"><p>Lecture 13: Network Protocols</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-14-ssl-and-https/index.htm">
<img src="https://img.youtube.com/vi/q1OF_0ICt9A/default.jpg" title="Lecture 14: SSL and HTTPS" alt="Lecture 14: SSL and HTTPS"><p>Lecture 14: SSL and HTTPS</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-15-medical-software/index.htm">
<img src="https://img.youtube.com/vi/bA3xCpYLA34/default.jpg" title="Lecture 15: Medical Software" alt="Lecture 15: Medical Software"><p>Lecture 15: Medical Software</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-16-side-channel-attacks/index.htm">
<img src="https://img.youtube.com/vi/3v5Von-oNUg/default.jpg" title="Lecture 16: Side-Channel Attacks" alt="Lecture 16: Side-Channel Attacks"><p>Lecture 16: Side-Channel At...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-17-user-authentication/index.htm">
<img src="https://img.youtube.com/vi/MT7X17ZRo1U/default.jpg" title="Lecture 17: User Authentication" alt="Lecture 17: User Authentication"><p>Lecture 17: User Authentica...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-18-private-browsing/index.htm">
<img src="https://img.youtube.com/vi/YTWXAFJf8bw/default.jpg" title="Lecture 18: Private Browsing" alt="Lecture 18: Private Browsing"><p>Lecture 18: Private Browsing</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-19-anonymous-communication/index.htm">
<img src="https://img.youtube.com/vi/OgGTJIgNewE/default.jpg" title="Lecture 19: Anonymous Communication" alt="Lecture 19: Anonymous Communication"><p>Lecture 19: Anonymous Commu...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-20-mobile-phone-security/index.htm">
<img src="https://img.youtube.com/vi/uT7BXusDgDM/default.jpg" title="Lecture 20: Mobile Phone Security" alt="Lecture 20: Mobile Phone Security"><p>Lecture 20: Mobile Phone Se...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-21-data-tracking/index.htm">
<img src="https://img.youtube.com/vi/WG5UbMrUiLU/default.jpg" title="Lecture 21: Data Tracking" alt="Lecture 21: Data Tracking"><p>Lecture 21: Data Tracking</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-22-guest-lecture-by-mit-is-t/index.htm">
<img src="https://img.youtube.com/vi/2PO8h1pVW50/default.jpg" title="Lecture 22: Guest Lecture by MIT IS&amp;T" alt="Lecture 22: Guest Lecture by MIT IS&amp;T"><p>Lecture 22: Guest Lecture b...</p></a>
</div>
<div class="related-media-thumbnail">
<a href="../../../contents/video-lectures/lecture-23-security-economics/index.htm">
<img src="https://img.youtube.com/vi/8PdnOZI7H5E/default.jpg" title="Lecture 23: Security Economics" alt="Lecture 23: Security Economics"><p>Lecture 23: Security Economics</p></a>
</div>
</div>
        <div id="vid_playlist" itemprop="description" class="tabContent hide">
<ul><li><a class="transcript-link" title="Open in a new window." alt="Open in a new window." style="text-decoration: none; font-size: 1.0em;" target="_blank" text-decoration: none font-size: href="../../../contents/video-lectures/lecture-6-capabilities/TQhmua7Z2cY.pdf"> Download this transcript - PDF (English - US)</a></li></ul>
<p><span m="70">The</span> <span m="170">following</span> <span m="610">content</span> <span m="1120">is</span> <span m="1230">provided</span> <span m="1670">under</span> <span m="1940">a</span> <span m="1980">Creative</span> <span m="2430">Commons</span> <span m="2830">license.</span> <span m="3820">Your</span> <span m="3920">support</span> <span m="4420">will</span> <span m="4560">help</span> <span m="4830">MIT</span> <span m="5310">OpenCourseWare</span> <span m="6060">continue</span> <span m="6540">to</span> <span m="6680">offer</span> <span m="7000">high</span> <span m="7210">quality,</span> <span m="7720">educational</span> <span m="8370">resources</span> <span m="8940">for</span> <span m="9080">free.</span> <span m="10150">To</span> <span m="10250">make</span> <span m="10340">a</span> <span m="10400">donation,</span> <span m="11090">or</span> <span m="11340">to</span> <span m="11450">view</span> <span m="11660">additional</span> <span m="12070">materials</span> <span m="12700">from</span> <span m="12860">hundreds</span> <span m="13190">of</span> <span m="13300">MIT</span> <span m="13680">courses,</span> <span m="15000">visit</span> <span m="15160">MIT</span> <span m="15690">OpenCourseWare</span> <span m="16600">at</span> <span m="16830">ocw.mit.edu.</span> </p>
<p><span m="27290">PROFESSOR: All</span> <span m="27390">right.</span> <span m="27860">Let's</span> <span m="28590">get</span> <span m="28850">started.</span> <span m="29760">So</span> <span m="29930">today</span> <span m="30150">we're</span> <span m="30270">going</span> <span m="30390">to</span> <span m="31150">talk</span> <span m="31410">about</span> <span m="31690">capabilities,</span> <span m="32409">continue</span> <span m="32810">our</span> <span m="32930">discussion</span> <span m="33430">of</span> <span m="33810">how</span> <span m="34150">to</span> <span m="34410">do</span> <span m="34570">privilege</span> <span m="35160">separation.</span> <span m="36310">And</span> <span m="36430">remember</span> <span m="36640">last</span> <span m="36880">week</span> <span m="37010">we</span> <span m="37110">talked</span> <span m="37330">about</span> <span m="37790">how</span> <span m="38120">Unix</span> <span m="39140">provides</span> <span m="39960">some</span> <span m="40140">mechanisms</span> <span m="40670">for</span> <span m="40790">applications</span> <span m="41440">to</span> <span m="41540">use</span> <span m="41910">if</span> <span m="42070">they</span> <span m="42180">want</span> <span m="42390">to</span> <span m="42870">privilege</span> <span m="43310">separate</span> <span m="44760">the</span> <span m="44900">application's</span> <span m="45600">internal</span> <span m="45980">structure.</span> </p>
<p><span m="47220">And</span> <span m="47660">today we're</span> <span m="47750">going</span> <span m="47850">to</span> <span m="48030">talk</span> <span m="48180">about</span> <span m="48360">capabilities,</span> <span m="48830">which</span> <span m="48940">is</span> <span m="49010">a</span> <span m="49110">very</span> <span m="49440">different</span> <span m="50150">way</span> <span m="50780">of</span> <span m="50870">thinking</span> <span m="52100">about</span> <span m="52700">privileges</span> <span m="53720">that</span> <span m="54030">an</span> <span m="54130">application</span> <span m="54760">might</span> <span m="55020">have.</span> <span m="56220">And</span> <span m="56380">this is</span> <span m="56610">why</span> <span m="56790">we</span> <span m="56900">have</span> <span m="57080">actually</span> <span m="57320">these</span> <span m="57610">two</span> <span m="57930">somewhat</span> <span m="58440">distinct</span> <span m="59030">readings</span> <span m="59540">for</span> <span m="59750">today,</span> <span m="60510">one</span> <span m="60790">of</span> <span m="60920">which</span> <span m="61480">is</span> <span m="62160">this</span> <span m="62500">confused</span> <span m="63000">deputy</span> <span m="63370">problem</span> <span m="66840">and</span> <span m="67790">how</span> <span m="68130">to</span> <span m="68680">make</span> <span m="69130">your</span> <span m="69410">privileges</span> <span m="69960">much</span> <span m="70140">more</span> <span m="70290">explicit</span> <span m="70910">when</span> <span m="71040">you're</span> <span m="71200">writing</span> <span m="71500">software</span> <span m="72090">so</span> <span m="72140">that</span> <span m="72250">you</span> <span m="72320">don't</span> <span m="72510">accidentally</span> <span m="72940">use</span> <span m="73160">the</span> <span m="73240">wrong</span> <span m="73410">privileges.</span> </p>
<p><span m="74770">And</span> <span m="74870">then</span> <span m="75020">the</span> <span m="75120">second</span> <span m="75400">paper</span> <span m="75760">is</span> <span m="75840">about</span> <span m="76080">the</span> <span m="76130">system</span> <span m="76470">called</span> <span m="76730">Capsicum,</span> <span m="77240">which</span> <span m="77370">is</span> <span m="77440">all</span> <span m="77710">about</span> <span m="78440">sandboxing</span> <span m="79380">and</span> <span m="80080">running</span> <span m="80700">some</span> <span m="80890">piece</span> <span m="81120">of</span> <span m="81270">code</span> <span m="81600">with</span> <span m="81840">fewer</span> <span m="82300">privileges</span> <span m="82930">so</span> <span m="83300">that</span> <span m="84110">it,</span> <span m="84360">very</span> <span m="85110">much</span> <span m="85330">like</span> <span m="85440">[INAUDIBLE],</span> <span m="86420">if</span> <span m="86510">it's</span> <span m="86660">compromised,</span> <span m="87640">the</span> <span m="88100">damage</span> <span m="88280">isn't</span> <span m="88430">that</span> <span m="88700">great.</span> </p>
<p><span m="89786">Now it</span> <span m="90150">turns</span> <span m="90390">out</span> <span m="90630">that</span> <span m="91370">the</span> <span m="91500">authors</span> <span m="91830">of</span> <span m="92010">both</span> <span m="92240">of</span> <span m="92280">these</span> <span m="93170">readings</span> <span m="93910">really</span> <span m="94160">think</span> <span m="94380">capabilities</span> <span m="95020">are</span> <span m="95160">the</span> <span m="95270">answer,</span> <span m="95590">because</span> <span m="95900">they</span> <span m="96100">let</span> <span m="96350">you</span> <span m="96870">manipulate</span> <span m="97610">privileges</span> <span m="97870">in</span> <span m="98130">a</span> <span m="98680">rather</span> <span m="98940">different</span> <span m="99370">way</span> <span m="99710">from</span> <span m="100000">how</span> <span m="100810">Unix,</span> <span m="101350">let's</span> <span m="101610">say,</span> <span m="102540">thinks</span> <span m="102730">about</span> <span m="102980">privileges.</span> </p>
<p><span m="104830">So</span> <span m="105140">to</span> <span m="105210">get</span> <span m="105370">started,</span> <span m="105850">maybe let's</span> <span m="106050">look</span> <span m="106250">at</span> <span m="106410">this</span> <span m="106600">confused</span> <span m="106990">deputy</span> <span m="107270">problem</span> <span m="107630">and</span> <span m="107930">try</span> <span m="108060">to</span> <span m="108130">understand</span> <span m="108640">what</span> <span m="108880">is</span> <span m="109010">this</span> <span m="109220">problem</span> <span m="109740">that</span> <span m="110450">Norman</span> <span m="110860">Hardy</span> <span m="111480">ran</span> <span m="111680">into</span> <span m="112420">and</span> <span m="112800">was</span> <span m="112980">so</span> <span m="113200">perplexed</span> <span m="113660">by.</span> <span m="114590">So</span> <span m="115020">the</span> <span m="115120">paper is</span> <span m="115510">written--</span> <span m="116580">well,</span> <span m="116860">it was</span> <span m="117050">written</span> <span m="117450">quite</span> <span m="117610">a</span> <span m="117660">while</span> <span m="117880">ago,</span> <span m="118180">and</span> <span m="118360">it uses</span> <span m="118620">syntax</span> <span m="118985">for</span> <span m="119350">file</span> <span m="119660">names</span> <span m="120010">that's</span> <span m="120180">a</span> <span m="120410">bit</span> <span m="120590">surprising.</span> <span m="121020">But</span> <span m="121450">we</span> <span m="121710">can</span> <span m="122080">try</span> <span m="122370">to</span> <span m="122560">at least</span> <span m="122900">transcribe</span> <span m="123840">his</span> <span m="124040">problem</span> <span m="124480">into</span> <span m="124750">more</span> <span m="125090">familiar</span> <span m="125590">syntax</span> <span m="126150">with</span> <span m="126330">Unix-style</span> <span m="127340">path</span> <span m="127690">names,</span> <span m="127920">et</span> <span m="128030">cetera.</span> </p>
<p><span m="129680">So</span> <span m="129900">as far as I can tell,</span> <span m="130180">what is</span> <span m="130310">going</span> <span m="130530">on</span> <span m="130729">in their</span> <span m="130900">system</span> <span m="131680">is</span> <span m="131980">that</span> <span m="132090">they</span> <span m="132270">had a</span> <span m="132660">Fortran</span> <span m="133090">compiler,</span> <span m="133700">which</span> <span m="133880">sort</span> <span m="134020">of</span> <span m="134140">dates</span> <span m="134580">their</span> <span m="134920">design</span> <span m="135330">at</span> <span m="135366">some</span> <span m="135403">level,</span> <span m="135710">too.</span> <span m="136310">But</span> <span m="136840">their</span> <span m="136980">Fortran</span> <span m="137400">compiler</span> <span m="137920">lived</span> <span m="138330">in</span> <span m="138480">/sysx/fort,</span> <span m="142030">and</span> <span m="143060">they</span> <span m="143370">wanted</span> <span m="143890">to</span> <span m="144410">change</span> <span m="144920">this</span> <span m="145130">Fortran</span> <span m="145490">compiler,</span> <span m="146150">so</span> <span m="146240">they</span> <span m="146390">would</span> <span m="147110">keep</span> <span m="147680">statistics</span> <span m="148350">about</span> <span m="148430">what</span> <span m="148710">was</span> <span m="148870">compiled,</span> <span m="149600">what</span> <span m="149860">parts</span> <span m="150090">of a</span> <span m="150200">compiler</span> <span m="150650">were</span> <span m="150770">particularly</span> <span m="151250">expensive</span> <span m="151720">presumably,</span> <span m="152200">et</span> <span m="152320">cetera.</span> </p>
<p><span m="153410">So</span> <span m="153510">he</span> <span m="153610">wanted</span> <span m="153680">to</span> <span m="153740">make</span> <span m="153920">sure</span> <span m="154160">this</span> <span m="154400">Fortran</span> <span m="154750">compiler</span> <span m="155540">would</span> <span m="155730">somehow</span> <span m="156120">end</span> <span m="156360">up</span> <span m="156540">writing</span> <span m="157320">to</span> <span m="157410">this</span> <span m="157670">file</span> <span m="158430">/sysx/stat,</span> <span m="159110">that it</span> <span m="161010">would</span> <span m="161550">record</span> <span m="162190">information</span> <span m="162690">about</span> <span m="163410">various</span> <span m="163710">invocations</span> <span m="164360">of</span> <span m="164500">the</span> <span m="164600">compiler.</span> <span m="166350">And</span> <span m="166490">the</span> <span m="166580">way</span> <span m="166710">they</span> <span m="166870">did</span> <span m="167180">this</span> <span m="167680">is,</span> <span m="168880">in</span> <span m="169010">their</span> <span m="169250">operating</span> <span m="169640">system,</span> <span m="169990">they</span> <span m="170070">had</span> <span m="170230">something</span> <span m="170610">kind</span> <span m="171010">of</span> <span m="171130">like</span> <span m="171340">the</span> <span m="171460">setuid</span> <span m="172170">that</span> <span m="172460">we</span> <span m="172600">talked</span> <span m="172800">about</span> <span m="173010">in</span> <span m="173080">Unix.</span> <span m="174040">Except</span> <span m="174410">there,</span> <span m="174650">they</span> <span m="174770">called</span> <span m="175070">it</span> <span m="175140">the</span> <span m="175220">home</span> <span m="175710">files</span> <span m="176270">license.</span> <span m="177360">And</span> <span m="177470">what</span> <span m="177630">it</span> <span m="177690">means</span> <span m="177940">is</span> <span m="178070">that</span> <span m="178460">if</span> <span m="178580">you</span> <span m="178760">ran</span> <span m="179630">/sysx/fort,</span> <span m="181380">and</span> <span m="181660">this</span> <span m="181830">program</span> <span m="182540">had</span> <span m="182830">this</span> <span m="182950">so-called</span> <span m="183900">home</span> <span m="184220">files</span> <span m="184660">license,</span> <span m="185710">then</span> <span m="186130">this</span> <span m="186520">process</span> <span m="187100">that</span> <span m="187220">you</span> <span m="187310">just</span> <span m="187580">ran</span> <span m="188110">would</span> <span m="188300">have</span> <span m="188590">extra</span> <span m="189280">privileges</span> <span m="189860">on</span> <span m="190040">being</span> <span m="190270">able</span> <span m="190460">to</span> <span m="190540">write</span> <span m="190840">everything</span> <span m="191440">in</span> <span m="191580">/sysx.</span> </p>
<p><span m="193420">So</span> <span m="193490">it would</span> <span m="193650">have</span> <span m="193810">these</span> <span m="193960">extra privileges</span> <span m="194265">on</span> <span m="194830">everything</span> <span m="195310">in</span> <span m="195710">/sysx/,</span> <span m="196210">basically,</span> <span m="197210">star.</span> <span m="198840">It could</span> <span m="199350">access all</span> <span m="199510">those</span> <span m="199730">files</span> <span m="200190">in</span> <span m="200310">addition</span> <span m="200610">to anything</span> <span m="200970">that it could</span> <span m="201370">access</span> <span m="201740">because</span> <span m="202120">the</span> <span m="202340">user ran it,</span> <span m="202840">for</span> <span m="202970">example.</span> <span m="205190">So</span> <span m="205350">the</span> <span m="205720">particular</span> <span m="205940">problem</span> <span m="206400">they</span> <span m="206550">ran</span> <span m="206730">into</span> <span m="207030">is</span> <span m="207310">that</span> <span m="208480">some</span> <span m="208780">clever</span> <span m="209090">user</span> <span m="210350">was</span> <span m="210570">able</span> <span m="210800">to</span> <span m="210880">do</span> <span m="211040">this.</span> <span m="211340">So</span> <span m="211440">they</span> <span m="211580">would</span> <span m="211700">run</span> <span m="211910">the</span> <span m="212000">Fortran</span> <span m="212380">compiler,</span> <span m="212860">and</span> <span m="212950">the</span> <span m="213080">Fortran</span> <span m="213440">compiler</span> <span m="213780">would</span> <span m="213920">take</span> <span m="214130">arguments</span> <span m="214650">very</span> <span m="214780">much</span> <span m="215010">like</span> <span m="215180">GCC</span> <span m="215610">takes</span> <span m="215880">arguments.</span> <span m="216790">And</span> <span m="216920">they</span> <span m="217010">would</span> <span m="217230">compile</span> <span m="217700">something</span> <span m="218080">like</span> <span m="219400">foo.f.</span> <span m="219590">Here is</span> <span m="220070">my</span> <span m="220280">Fortran</span> <span m="220670">source</span> <span m="220980">code.</span> <span m="221620">And</span> <span m="221840">they'd say,</span> <span m="222030">well,</span> <span m="222260">put that</span> <span m="222360">output</span> <span m="223060">-o</span> <span m="224500">into</span> <span m="225320">/sysx/stat.</span> </p>
<p><span m="228120">Or</span> <span m="229040">more</span> <span m="229250">damagingly</span> <span m="229880">in</span> <span m="229970">their</span> <span m="230180">case,</span> <span m="230700">there</span> <span m="230810">was</span> <span m="230930">another</span> <span m="231390">file</span> <span m="231960">in</span> <span m="232100">/sysx</span> <span m="233010">that</span> <span m="233360">was</span> <span m="233470">the</span> <span m="233710">billing</span> <span m="234050">file</span> <span m="234470">for</span> <span m="234580">all</span> <span m="234770">the</span> <span m="234890">customers</span> <span m="235360">on</span> <span m="235460">the</span> <span m="235550">system.</span> <span m="236390">So you could</span> <span m="236620">similarly</span> <span m="237280">ask</span> <span m="237780">the</span> <span m="238360">Fortran</span> <span m="238790">compiler</span> <span m="239990">to</span> <span m="241380">compile</span> <span m="241850">the</span> <span m="241950">source</span> <span m="242330">file</span> <span m="242630">and put the</span> <span m="243020">output</span> <span m="243860">into</span> <span m="244640">some</span> <span m="245010">special</span> <span m="245450">file</span> <span m="245800">in</span> <span m="245930">/sysx.</span> </p>
<p><span m="247980">And</span> <span m="248490">in</span> <span m="248590">their</span> <span m="248780">case,</span> <span m="249030">this</span> <span m="249130">actually</span> <span m="250230">worked.</span> <span m="250860">Even</span> <span m="251070">though</span> <span m="251260">the</span> <span m="251400">user</span> <span m="251930">themselves</span> <span m="252400">didn't</span> <span m="252570">have</span> <span m="252740">access</span> <span m="253080">to</span> <span m="253170">write</span> <span m="253430">to</span> <span m="253490">this</span> <span m="253840">file</span> <span m="254310">or</span> <span m="254470">directory,</span> <span m="255430">because</span> <span m="256160">the</span> <span m="256300">compiler</span> <span m="256920">had</span> <span m="257100">this</span> <span m="257360">extra</span> <span m="257730">privilege--</span> <span m="258620">this</span> <span m="259140">home</span> <span m="259450">files</span> <span m="259839">license,</span> <span m="260190">in</span> <span m="260269">their</span> <span m="260430">case--</span> <span m="261660">it</span> <span m="261779">was</span> <span m="261920">able</span> <span m="262290">to</span> <span m="262710">override</span> <span m="263220">these</span> <span m="263420">files</span> <span m="264590">despite</span> <span m="265230">that</span> <span m="265625">not</span> <span m="266020">being</span> <span m="266260">really</span> <span m="266490">the</span> <span m="266620">developer's</span> <span m="267040">intention.</span> <span m="268910">This</span> <span m="269030">make</span> <span m="269160">sense?</span> <span m="269450">This is the</span> <span m="269530">rough</span> <span m="270010">problem</span> <span m="270440">they ran</span> <span m="270750">into?</span> </p>
<p><span m="271100">So who</span> <span m="271555">do</span> <span m="272010">they</span> <span m="272440">blame?</span> <span m="272755">What do they</span> <span m="273070">think</span> <span m="273240">went</span> <span m="273480">wrong?</span> <span m="280995">Or</span> <span m="281270">how would</span> <span m="281700">you</span> <span m="281780">design</span> <span m="282045">it</span> <span m="282310">differently</span> <span m="282780">to</span> <span m="282900">avoid</span> <span m="284370">running</span> <span m="284780">into such</span> <span m="284990">problems?</span> <span m="286150">So the</span> <span m="286510">thing</span> <span m="286680">they</span> <span m="287190">sort</span> <span m="287310">of</span> <span m="287900">think</span> <span m="288110">about</span> <span m="288460">here,</span> <span m="288770">or</span> <span m="288900">they</span> <span m="290540">talk</span> <span m="290740">about</span> <span m="290940">in</span> <span m="291030">this</span> <span m="291500">write up,</span> <span m="291930">is</span> <span m="292160">that</span> <span m="292780">they</span> <span m="292920">believe</span> <span m="293420">this</span> <span m="293610">Fortran</span> <span m="294090">compiler</span> <span m="295040">should</span> <span m="295240">be</span> <span m="295350">very</span> <span m="295690">careful</span> <span m="296310">when</span> <span m="296670">it's</span> <span m="296950">using</span> <span m="297350">its</span> <span m="297490">privileges.</span> </p>
<p><span m="297990">Because,</span> <span m="298560">at</span> <span m="298700">some</span> <span m="298840">level,</span> <span m="299120">the</span> <span m="299210">Fortran</span> <span m="299530">compiler</span> <span m="299960">has</span> <span m="300270">two</span> <span m="300700">types</span> <span m="301130">of</span> <span m="301260">privileges.</span> <span m="301570">It</span> <span m="301880">has</span> <span m="302630">one</span> <span m="303620">stemming</span> <span m="304130">from</span> <span m="304300">the</span> <span m="304400">fact the</span> <span m="304770">user</span> <span m="305130">invoked</span> <span m="305470">it,</span> <span m="305660">so</span> <span m="305910">the</span> <span m="306030">user</span> <span m="306330">should</span> <span m="306490">be</span> <span m="306580">able</span> <span m="306810">to</span> <span m="306870">access</span> <span m="307500">the</span> <span m="307640">source</span> <span m="308140">file,</span> <span m="308500">like</span> <span m="308850">foo.f.</span> <span m="310050">And</span> <span m="310260">if it was</span> <span m="310690">some other</span> <span m="310870">user,</span> <span m="311240">maybe</span> <span m="311860">it</span> <span m="311960">wouldn't</span> <span m="312150">be</span> <span m="312250">able</span> <span m="312420">to</span> <span m="312490">access</span> <span m="312800">the</span> <span m="313120">user</span> <span m="313510">source</span> <span m="313860">code.</span> </p>
<p><span m="314680">And</span> <span m="314890">in</span> <span m="315000">other</span> <span m="315110">sorts</span> <span m="315300">of</span> <span m="315400">privileges</span> <span m="316110">is</span> <span m="316250">from</span> <span m="316420">those</span> <span m="316570">home</span> <span m="317140">files</span> <span m="317590">license</span> <span m="317940">thing</span> <span m="318290">that</span> <span m="318390">allows</span> <span m="318710">us</span> <span m="318820">to</span> <span m="318920">write</span> <span m="319160">to these</span> <span m="319390">special</span> <span m="319770">files.</span> <span m="320830">And</span> <span m="321160">internally,</span> <span m="321535">in</span> <span m="321910">the</span> <span m="322000">source</span> <span m="322470">code of the</span> <span m="322730">compiler,</span> <span m="323480">when</span> <span m="323610">they</span> <span m="323850">open</span> <span m="324200">a</span> <span m="324260">file,</span> <span m="325180">the</span> <span m="325280">compiler</span> <span m="325920">should</span> <span m="326260">have</span> <span m="326450">been</span> <span m="326790">very</span> <span m="327010">explicit</span> <span m="327570">about</span> <span m="327810">which</span> <span m="327990">of</span> <span m="328080">these</span> <span m="328320">privileges</span> <span m="328900">it</span> <span m="329030">wants</span> <span m="329220">to</span> <span m="329320">exercise</span> <span m="330490">when</span> <span m="331200">opening</span> <span m="331550">a</span> <span m="331610">file</span> <span m="331910">or</span> <span m="332000">performing</span> <span m="332490">some</span> <span m="332680">privileged</span> <span m="333120">operation.</span> </p>
<p><span m="334460">But</span> <span m="335070">their</span> <span m="335200">compiler</span> <span m="335590">was</span> <span m="335740">not written</span> <span m="335850">in this way.</span> <span m="336330">It was</span> <span m="336450">just</span> <span m="336690">called</span> <span m="336920">open,</span> <span m="337560">read,</span> <span m="337830">write,</span> <span m="338140">like</span> <span m="338310">any</span> <span m="338500">other</span> <span m="338720">program</span> <span m="339020">would</span> <span m="339160">do.</span> <span m="339550">And</span> <span m="339920">it</span> <span m="340020">would</span> <span m="340130">implicitly</span> <span m="340810">use</span> <span m="341070">all</span> <span m="341290">the</span> <span m="341370">privileges</span> <span m="341890">that it</span> <span m="342050">has,</span> <span m="342440">which</span> <span m="342900">combines--</span> <span m="343750">well,</span> <span m="344080">in</span> <span m="344230">their</span> <span m="344550">system</span> <span m="344890">design, it was</span> <span m="345320">sort</span> <span m="345470">of</span> <span m="345570">the</span> <span m="345600">union of</span> <span m="346200">the</span> <span m="346290">user</span> <span m="346600">privileges</span> <span m="347410">and</span> <span m="347720">these</span> <span m="348380">home</span> <span m="348700">files</span> <span m="349160">license</span> <span m="349540">privileges.</span> <span m="351086">That</span> <span m="351540">make</span> <span m="351660">sense?</span> </p>
<p><span m="352790">So these guys were</span> <span m="353110">really</span> <span m="353640">interested</span> <span m="353990">in</span> <span m="354940">fixing</span> <span m="355390">this</span> <span m="355570">problem.</span> <span m="356180">And</span> <span m="357070">they</span> <span m="357340">were</span> <span m="357460">sort</span> <span m="357570">of</span> <span m="357670">calling</span> <span m="358000">this</span> <span m="358190">compiler</span> <span m="358485">this</span> <span m="358780">confused</span> <span m="359240">deputy,</span> <span m="359590">because</span> <span m="359890">it</span> <span m="360010">needs</span> <span m="360190">to</span> <span m="360310">disambiguate</span> <span m="360990">these</span> <span m="361200">multiple</span> <span m="361640">privileges</span> <span m="362080">that it</span> <span m="362260">has and</span> <span m="362750">carefully</span> <span m="363170">use</span> <span m="363360">them</span> <span m="363840">in</span> <span m="364080">the</span> <span m="364580">right</span> <span m="364920">instance.</span> </p>
<p><span m="366800">So</span> <span m="367280">I</span> <span m="367350">guess</span> <span m="367530">one</span> <span m="367950">thing</span> <span m="368270">we</span> <span m="368390">could</span> <span m="368630">try</span> <span m="368840">to</span> <span m="368930">look</span> <span m="369130">at</span> <span m="369350">is</span> <span m="369870">how</span> <span m="370060">would we</span> <span m="371100">design</span> <span m="371700">such</span> <span m="372370">a</span> <span m="373070">compiler</span> <span m="373950">in</span> <span m="374100">Unix?</span> <span m="375120">So</span> <span m="375680">in</span> <span m="375890">their</span> <span m="376180">system,</span> <span m="376540">they had</span> <span m="376730">this</span> <span m="376860">whole</span> <span m="377060">files</span> <span m="377490">license</span> <span m="377950">thing.</span> <span m="378350">Other</span> <span m="378550">mechanisms,</span> <span m="379110">then</span> <span m="379280">they introduced</span> <span m="379670">capabilities.</span> <span m="380190">We'll</span> <span m="380310">talk</span> <span m="380410">about</span> <span m="380570">them</span> <span m="380680">shortly.</span> <span m="381750">But</span> <span m="382015">could</span> <span m="383100">we</span> <span m="383230">solve</span> <span m="383570">this</span> <span m="384110">in</span> <span m="384250">a</span> <span m="384280">Unix</span> <span m="384610">system?</span> <span m="384950">Suppose</span> <span m="385210">you</span> <span m="385280">had</span> <span m="385410">to</span> <span m="385480">write</span> <span m="385680">this</span> <span m="385770">Fortran</span> <span m="386150">compiler in</span> <span m="386650">Unix</span> <span m="387080">and write</span> <span m="387140">to</span> <span m="387295">a</span> <span m="387450">special</span> <span m="387820">file</span> <span m="389140">and</span> <span m="389360">avoid this</span> <span m="389510">confused</span> <span m="389660">deputy</span> <span m="389920">problem.</span> <span m="390190">What would</span> <span m="390510">you</span> <span m="390720">do?</span> <span m="392860">Any</span> <span m="393020">ideas?</span> </p>
<p><span m="396130">I</span> <span m="396150">guess</span> <span m="396170">you</span> <span m="396190">could</span> <span m="396210">just</span> <span m="396230">declare</span> <span m="396660">this a bad</span> <span m="397550">plan.</span> <span m="397760">Like</span> <span m="397880">don't</span> <span m="398110">keep</span> <span m="398250">statistics.</span> <span m="400212">Yeah?</span> </p>
<p><span m="402028">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="404920">PROFESSOR: Sure.</span> <span m="405315">That could be,</span> <span m="405710">right?</span> <span m="406670">Well,</span> <span m="407160">yeah.</span> <span m="407530">So</span> <span m="407650">you could</span> <span m="407950">not</span> <span m="408210">support</span> <span m="408690">flags</span> <span m="409110">like</span> <span m="409300">-o.</span> <span m="410530">On</span> <span m="410660">the</span> <span m="410720">other</span> <span m="410850">hand,</span> <span m="411470">you</span> <span m="411880">might</span> <span m="412060">want</span> <span m="412210">to</span> <span m="412690">allow</span> <span m="414850">specifying</span> <span m="415230">which</span> <span m="415420">source</span> <span m="415650">code</span> <span m="415850">you want</span> <span m="415980">to</span> <span m="416030">compile</span> <span m="416385">so that</span> <span m="417140">maybe</span> <span m="417320">you</span> <span m="417400">could</span> <span m="417570">read</span> <span m="417860">the</span> <span m="417930">billing</span> <span m="418280">file</span> <span m="418650">or read</span> <span m="418900">the</span> <span m="418980">statistics</span> <span m="419460">file,</span> <span m="419630">which</span> <span m="419820">maybe</span> <span m="420060">should</span> <span m="420220">be</span> <span m="420310">secret.</span> <span m="421230">Or</span> <span m="421420">maybe</span> <span m="421600">the</span> <span m="421680">source</span> <span m="421920">code</span> <span m="422290">has--</span> <span m="423070">maybe</span> <span m="423230">you can</span> <span m="423540">support</span> <span m="423790">a</span> <span m="423840">the</span> <span m="424190">source code</span> <span m="424350">on</span> <span m="424495">standard,</span> <span m="424640">but</span> <span m="424820">it has</span> <span m="425140">include</span> <span m="425660">statements,</span> <span m="426150">so</span> <span m="426330">it</span> <span m="426450">needs</span> <span m="426620">to</span> <span m="426690">include</span> <span m="427150">other</span> <span m="427370">pieces</span> <span m="427620">of</span> <span m="427710">source</span> <span m="428030">code.</span> <span m="428370">So that's</span> <span m="428862">a little tricky.</span> </p>
<p><span m="429354">AUDIENCE:</span> <span m="429846">You could split up the</span> <span m="430338">application</span> <span m="430830">[INAUDIBLE].</span> </p>
<p><span m="437240">PROFESSOR: Yes.</span> <span m="437530">So</span> <span m="437770">another</span> <span m="438760">potentially</span> <span m="439130">good</span> <span m="439330">design</span> <span m="439680">is</span> <span m="439820">to</span> <span m="439950">split</span> <span m="440280">it up,</span> <span m="440570">right?</span> <span m="440770">And</span> <span m="440960">realize</span> <span m="441470">that</span> <span m="441610">this</span> <span m="441760">fort</span> <span m="442100">compiler</span> <span m="442520">really</span> <span m="443130">doesn't</span> <span m="443450">need</span> <span m="443730">all</span> <span m="443870">these</span> <span m="444060">two</span> <span m="444190">privileges</span> <span m="444670">at</span> <span m="444780">the</span> <span m="444850">same</span> <span m="445210">time.</span> <span m="445525">So</span> <span m="445840">maybe</span> <span m="446070">we</span> <span m="446120">should</span> <span m="446280">have</span> <span m="447280">our</span> <span m="448410">Unix</span> <span m="448800">world</span> <span m="450250">/bin/fortcc</span> <span m="452110">or</span> <span m="452210">something,</span> <span m="453420">the</span> <span m="453590">compiler,</span> <span m="454380">and</span> <span m="454500">then</span> <span m="454950">this</span> <span m="455150">guy is</span> <span m="455390">just</span> <span m="455560">a</span> <span m="455670">regular</span> <span m="456040">program</span> <span m="456410">with</span> <span m="456570">no</span> <span m="456740">extra</span> <span m="456980">privileges.</span> <span m="457790">And</span> <span m="457990">then we'll also</span> <span m="458370">maybe</span> <span m="458610">have</span> <span m="459070">a</span> <span m="459380">/bin/fortlog,</span> <span m="461980">which</span> <span m="462180">is</span> <span m="462310">going</span> <span m="462420">to</span> <span m="462470">be</span> <span m="462580">a</span> <span m="462640">special</span> <span m="462970">program</span> <span m="463450">with</span> <span m="463920">some</span> <span m="464130">extra</span> <span m="464350">privileges</span> <span m="464800">and it'll</span> <span m="465260">log</span> <span m="465860">some</span> <span m="466160">statistics</span> <span m="466700">about</span> <span m="466950">what's</span> <span m="467400">going</span> <span m="467640">on</span> <span m="468480">in</span> <span m="468610">the</span> <span m="468700">compiler.</span> <span m="469410">And</span> <span m="469770">fortcc</span> <span m="470100">is going to</span> <span m="471110">invoke</span> <span m="471580">this</span> <span m="471780">guy.</span> </p>
<p><span m="473010">So</span> <span m="473100">how</span> <span m="473220">do</span> <span m="473290">we</span> <span m="473370">give</span> <span m="473520">this guy</span> <span m="473700">extra</span> <span m="474010">privileges?</span> <span m="476090">Yeah?</span> </p>
<p><span m="476520">AUDIENCE: Well, maybe</span> <span m="477010">if you use something like</span> <span m="477500">setuid</span> <span m="478153">or</span> <span m="478316">something,</span> <span m="478480">like</span> <span m="478643">fortlog,</span> <span m="478970">then presumably</span> <span m="479460">any other user</span> <span m="480930">could also</span> <span m="481910">log arbitrary</span> <span m="482400">data through it.</span> </p>
<p><span m="483390">PROFESSOR: Yeah.</span> <span m="483700">So</span> <span m="483920">this is</span> <span m="484160">not</span> <span m="484310">so</span> <span m="484440">great.</span> <span m="484730">Because</span> <span m="485040">on</span> <span m="485190">fortlog,</span> <span m="485440">presumably</span> <span m="486210">the only</span> <span m="486320">way</span> <span m="486510">to</span> <span m="486600">give</span> <span m="486740">extra</span> <span m="487030">privileges</span> <span m="487450">in</span> <span m="487540">Unix</span> <span m="487820">is</span> <span m="487960">to in</span> <span m="488110">fact</span> <span m="488810">make</span> <span m="489130">it</span> <span m="489280">owned</span> <span m="489700">by,</span> <span m="489860">I don't know,</span> <span m="490220">maybe</span> <span m="490460">the</span> <span m="490600">fort</span> <span m="490885">UID,</span> <span m="491170">and</span> <span m="491850">that's</span> <span m="492900">also</span> <span m="493170">setuid.</span> <span m="494490">So</span> <span m="494650">every</span> <span m="494920">time</span> <span m="495090">you</span> <span m="495220">run</span> <span m="495500">it,</span> <span m="495760">it switches</span> <span m="496120">to</span> <span m="496210">this</span> <span m="496450">Fortran</span> <span m="497050">UID.</span> <span m="497550">And</span> <span m="497650">maybe</span> <span m="497820">there's</span> <span m="497990">some</span> <span m="498130">special</span> <span m="498450">stats</span> <span m="498860">file.</span> <span m="499580">But</span> <span m="499820">then in</span> <span m="499930">fact</span> <span m="500130">anyone</span> <span m="500450">can</span> <span m="500970">invoke</span> <span m="501360">this</span> <span m="501530">fortlog</span> <span m="502110">thingy.</span> <span m="503170">Which</span> <span m="503370">is</span> <span m="503640">maybe</span> <span m="503930">not</span> <span m="504380">great.</span> <span m="504730">Now</span> <span m="504910">anyone</span> <span m="505220">can</span> <span m="505410">write</span> <span m="505660">to the</span> <span m="505820">stats</span> <span m="506190">file.</span> </p>
<p><span m="506940">But</span> <span m="507300">maybe</span> <span m="507460">this</span> <span m="507610">example</span> <span m="507885">is</span> <span m="508160">not</span> <span m="508480">the</span> <span m="508560">biggest</span> <span m="509170">security</span> <span m="509520">concern</span> <span m="509860">about</span> <span m="510040">someone</span> <span m="510230">corrupting</span> <span m="510570">your</span> <span m="510700">statistics.</span> <span m="511490">But</span> <span m="511940">suppose</span> <span m="512360">this was a</span> <span m="512500">billing</span> <span m="512880">file.</span> <span m="513220">Then</span> <span m="513330">maybe</span> <span m="513990">the</span> <span m="514090">same</span> <span m="514260">problems</span> <span m="514549">would</span> <span m="514679">be</span> <span m="514840">slightly</span> <span m="515150">more</span> <span m="515340">acute.</span> <span m="516125">Yeah?</span> </p>
<p><span m="516571">AUDIENCE: But</span> <span m="517017">you can always</span> <span m="517463">make</span> <span m="517909">your</span> <span m="518355">[INAUDIBLE]</span> <span m="519250">stats</span> <span m="519880">you want, right?</span> <span m="520340">Instead of</span> <span m="520800">[INAUDIBLE].</span> </p>
<p><span m="524940">PROFESSOR: So</span> <span m="525900">in</span> <span m="526070">some</span> <span m="526280">sense,</span> <span m="526660">yeah.</span> <span m="526930">If you're</span> <span m="527100">willing</span> <span m="527540">to</span> <span m="527720">live with</span> <span m="528320">arbitrary</span> <span m="528960">stuff</span> <span m="529350">in</span> <span m="529520">your</span> <span m="529830">statistics</span> <span m="530430">or</span> <span m="530520">logging</span> <span m="530940">file,</span> <span m="531320">then</span> <span m="531480">maybe that's</span> <span m="531790">true.</span> </p>
<p><span m="532220">AUDIENCE: Even if you</span> <span m="532718">[INAUDIBLE],</span> <span m="534212">you can already make your</span> <span m="534710">C</span> <span m="535208">code</span> <span m="535706">have whatever</span> <span m="536204">statistics</span> <span m="536702">that you'd want to be</span> <span m="537698">recorded.</span> </p>
<p><span m="538530">PROFESSOR: You could.</span> <span m="538690">Yeah.</span> <span m="539585">Yeah.</span> <span m="539860">So it</span> <span m="540530">might</span> <span m="540690">be</span> <span m="540750">that in</span> <span m="540980">this</span> <span m="541150">case,</span> <span m="541620">it</span> <span m="541720">doesn't</span> <span m="541890">really</span> <span m="542180">matter</span> <span m="542550">that</span> <span m="542730">you</span> <span m="542840">can</span> <span m="542970">log</span> <span m="543170">arbitrary</span> <span m="543540">stuff.</span> <span m="543940">So</span> <span m="544205">that's</span> <span m="544470">true.</span> <span m="545240">Yeah.</span> <span m="546040">So if you</span> <span m="546360">cared</span> <span m="546590">about</span> <span m="546680">who can</span> <span m="547080">invoke</span> <span m="547500">this</span> <span m="547690">fortlog</span> <span m="548230">thing,</span> <span m="548480">could</span> <span m="548650">you</span> <span m="548840">really</span> <span m="549050">do</span> <span m="549210">something</span> <span m="549510">about</span> <span m="549720">it</span> <span m="549810">in</span> <span m="549950">Unix,</span> <span m="550450">or</span> <span m="551530">not</span> <span m="551770">so</span> <span m="551840">much?</span> <span m="552507">Yeah?</span> </p>
<p><span m="552984">AUDIENCE: [INAUDIBLE].</span> <span m="554892">It would</span> <span m="555369">make both of them</span> <span m="555846">setuid.</span> <span m="558090">Now</span> <span m="558925">the</span> <span m="559200">fortcc</span> <span m="560110">would</span> <span m="561700">read</span> <span m="561920">that</span> <span m="562470">source files.</span> <span m="563120">It would switch</span> <span m="563430">back to the</span> <span m="563775">saved UID,</span> <span m="564510">just the user</span> <span m="564900">UID.</span> <span m="566430">Remote</span> <span m="567000">fortlog</span> <span m="568291">in</span> <span m="568521">a</span> <span m="568752">setuid,</span> <span m="570596">which has</span> <span m="571060">permissions</span> <span m="571560">to</span> <span m="571930">execute</span> <span m="572160">fortlog.</span> <span m="572485">And</span> <span m="572810">that</span> <span m="573292">fortlog</span> <span m="574256">would</span> <span m="575220">setuid</span> <span m="576666">again</span> <span m="577148">[INAUDIBLE].</span> </p>
<p><span m="578120">PROFESSOR: Right.</span> <span m="578520">Yeah.</span> <span m="578720">So</span> <span m="578850">there is</span> <span m="579155">this</span> <span m="580130">rather</span> <span m="581260">elaborate</span> <span m="581700">mechanism</span> <span m="582190">in</span> <span m="582300">Unix</span> <span m="582710">that</span> <span m="583000">we</span> <span m="583430">skipped</span> <span m="583730">on</span> <span m="584470">last</span> <span m="584720">Monday's</span> <span m="585000">lecture,</span> <span m="586140">that</span> <span m="586280">actually</span> <span m="586830">allows</span> <span m="587220">an</span> <span m="587310">application</span> <span m="587950">to</span> <span m="588410">switch</span> <span m="588780">between</span> <span m="589210">multiple</span> <span m="589670">UIDs.</span> <span m="590190">if</span> <span m="590520">it</span> <span m="590730">was</span> <span m="590890">setuid</span> <span m="591660">to</span> <span m="592070">some</span> <span m="592460">user</span> <span m="592730">ID,</span> <span m="593070">then</span> <span m="593320">it</span> <span m="593370">could</span> <span m="593580">say,</span> <span m="593800">well,</span> <span m="594075">now</span> <span m="594350">I</span> <span m="594390">want</span> <span m="594530">to</span> <span m="594580">run</span> <span m="594790">with</span> <span m="594900">this</span> <span m="594980">user</span> <span m="595360">ID.</span> <span m="595740">Now I</span> <span m="595910">want</span> <span m="596030">to</span> <span m="596090">run</span> <span m="596240">with this</span> <span m="596420">other</span> <span m="596630">user</span> <span m="596890">ID.</span> <span m="597480">And</span> <span m="597730">it could sort of</span> <span m="598070">carefully</span> <span m="598870">alternate</span> <span m="599320">between</span> <span m="599670">these.</span> <span m="600880">It's</span> <span m="601080">a</span> <span m="601120">little</span> <span m="601320">tricky</span> <span m="601530">to</span> <span m="601620">do</span> <span m="601750">it</span> <span m="601870">right,</span> <span m="602320">but</span> <span m="602870">it's</span> <span m="603070">probably</span> <span m="603340">doable.</span> <span m="604213">So that's one</span> <span m="604960">potential</span> <span m="605640">design.</span> </p>
<p><span m="606430">I guess</span> <span m="606640">another</span> <span m="606920">hack</span> <span m="607150">you</span> <span m="607240">could</span> <span m="607460">maybe</span> <span m="607700">try</span> <span m="607910">to</span> <span m="608000">do</span> <span m="608140">is</span> <span m="608270">make</span> <span m="608540">this</span> <span m="609020">fortlog</span> <span m="609500">binary</span> <span m="609860">only</span> <span m="610090">executable</span> <span m="610740">to</span> <span m="610830">a</span> <span m="610910">particular</span> <span m="611310">group</span> <span m="612080">and</span> <span m="612240">make</span> <span m="612420">fortcc</span> <span m="612770">a</span> <span m="613530">setgid</span> <span m="614350">binary</span> <span m="614790">to that</span> <span m="615070">group.</span> <span m="615930">It's not</span> <span m="616150">great,</span> <span m="616400">because</span> <span m="616610">it</span> <span m="616810">obliterates</span> <span m="617220">whatever</span> <span m="617630">group</span> <span m="617830">list the</span> <span m="618150">user had</span> <span m="618520">initially.</span> <span m="619950">But</span> <span m="620370">who knows?</span> <span m="621200">Maybe</span> <span m="621510">that's</span> <span m="622190">better</span> <span m="622510">than</span> <span m="622620">nothing.</span> </p>
<p><span m="624190">Anyway,</span> <span m="624450">so</span> <span m="624620">it's</span> <span m="624920">a</span> <span m="625240">fairly</span> <span m="625790">tricky</span> <span m="626140">problem</span> <span m="626550">to</span> <span m="626670">solve</span> <span m="626955">in</span> <span m="627240">an</span> <span m="628220">entirely</span> <span m="628600">satisfactory</span> <span m="629180">fashion</span> <span m="629600">with these</span> <span m="630015">Unix</span> <span m="630430">mechanisms.</span> <span m="631830">Although,</span> <span m="632280">maybe</span> <span m="632570">you</span> <span m="632720">should</span> <span m="632970">rethink</span> <span m="633290">your</span> <span m="633400">problem</span> <span m="633770">and</span> <span m="634050">not</span> <span m="634310">worry</span> <span m="634530">about</span> <span m="634890">your</span> <span m="635220">statistics</span> <span m="635640">file as</span> <span m="636010">much</span> <span m="636290">in the</span> <span m="636570">first place.</span> <span m="638970">But</span> <span m="639650">how</span> <span m="639780">do</span> <span m="639930">we</span> <span m="640410">think</span> <span m="640700">about</span> <span m="640980">what's</span> <span m="641560">going</span> <span m="641850">wrong</span> <span m="642370">in</span> <span m="642570">the</span> <span m="642790">design?</span> </p>
<p><span m="645150">Well,</span> <span m="645300">there's</span> <span m="645570">two</span> <span m="646460">things</span> <span m="646690">we</span> <span m="646800">could</span> <span m="647160">try to learn</span> <span m="647480">from this,</span> <span m="647920">or</span> <span m="648800">basically,</span> <span m="649170">what</span> <span m="649390">went</span> <span m="649590">wrong.</span> <span m="653120">And</span> <span m="654040">one</span> <span m="654320">interpretation</span> <span m="655220">that</span> <span m="655570">one</span> <span m="656010">party</span> <span m="656720">wants</span> <span m="656920">us to</span> <span m="657350">take away</span> <span m="658180">is</span> <span m="659000">this</span> <span m="659340">notion</span> <span m="659840">that</span> <span m="659960">he calls</span> <span m="660470">ambient</span> <span m="661090">authority.</span> <span m="666730">So</span> <span m="666995">what is</span> <span m="667260">ambient</span> <span m="667530">authority?</span> <span m="668300">Can anyone</span> <span m="668610">figure</span> <span m="669060">out</span> <span m="669480">what they</span> <span m="669730">meant?</span> <span m="670230">They've never</span> <span m="670730">exactly</span> <span m="671230">defined this.</span> <span m="672230">Yeah?</span> </p>
<p><span m="672730">AUDIENCE: It means</span> <span m="673230">you have the</span> <span m="673730">authority</span> <span m="674145">given to you by</span> <span m="674560">the environment.</span> <span m="675590">So</span> <span m="676420">as</span> <span m="676700">if</span> <span m="676990">[INAUDIBLE]</span> <span m="677630">user</span> <span m="678130">with no</span> <span m="678630">limitations.</span> </p>
<p><span m="679630">PROFESSOR: Yeah.</span> <span m="680130">So</span> <span m="681550">you're</span> <span m="681890">making</span> <span m="682090">an</span> <span m="682400">operation,</span> <span m="683300">and</span> <span m="683710">you can</span> <span m="683890">specify what</span> <span m="684190">operation</span> <span m="684460">you want.</span> <span m="685230">But</span> <span m="685700">the decision</span> <span m="686250">of whether that</span> <span m="686520">operation is</span> <span m="686810">going</span> <span m="687250">to</span> <span m="687300">succeed</span> <span m="687760">comes from</span> <span m="688260">some</span> <span m="688400">extra</span> <span m="688880">implicit</span> <span m="689410">parameters</span> <span m="690000">in</span> <span m="690160">your</span> <span m="690430">process,</span> <span m="690850">for</span> <span m="690970">example.</span> <span m="691660">And</span> <span m="691800">in</span> <span m="691960">Unix,</span> <span m="692650">you can</span> <span m="692860">figure</span> <span m="693140">out</span> <span m="693630">what</span> <span m="693830">this</span> <span m="694120">ambient</span> <span m="694530">authority</span> <span m="694970">check</span> <span m="695520">might</span> <span m="695920">look</span> <span m="696140">like.</span> </p>
<p><span m="696490">So if you</span> <span m="696960">make</span> <span m="697170">a</span> <span m="697230">system</span> <span m="697570">call,</span> <span m="697960">then you</span> <span m="698460">probably</span> <span m="698860">supplied</span> <span m="699180">some sort of a</span> <span m="699620">name</span> <span m="699955">to</span> <span m="700290">a</span> <span m="700490">system</span> <span m="700690">call.</span> <span m="701080">And</span> <span m="701760">inside</span> <span m="702130">of</span> <span m="702310">the</span> <span m="702480">kernel,</span> <span m="702810">this</span> <span m="703140">gets</span> <span m="703340">mapped</span> <span m="703710">to</span> <span m="704110">some sort</span> <span m="704420">of</span> <span m="704640">an</span> <span m="704740">object.</span> <span m="705570">And</span> <span m="705950">the object</span> <span m="706235">presumably</span> <span m="706520">has</span> <span m="707030">some</span> <span m="707410">kind</span> <span m="707640">of</span> <span m="707730">an</span> <span m="707810">access</span> <span m="708160">control</span> <span m="708580">list</span> <span m="708680">on it,</span> <span m="708950">like</span> <span m="709220">the</span> <span m="709400">permissions</span> <span m="710050">on a</span> <span m="710290">file,</span> <span m="710660">et</span> <span m="711030">cetera.</span> <span m="712110">So</span> <span m="712400">there</span> <span m="712520">are</span> <span m="712600">some</span> <span m="712770">permissions</span> <span m="713610">that</span> <span m="713780">you</span> <span m="713930">can</span> <span m="714750">get</span> <span m="715070">from</span> <span m="715350">the</span> <span m="715440">object.</span> <span m="716460">And that should</span> <span m="716560">decide</span> <span m="717460">whether</span> <span m="718110">an</span> <span m="718210">operation</span> <span m="718770">is</span> <span m="718860">going</span> <span m="718970">to</span> <span m="719040">be</span> <span m="719270">allowed</span> <span m="719670">on</span> <span m="719820">this</span> <span m="720040">name</span> <span m="720480">of</span> <span m="720840">the</span> <span m="720895">application</span> <span m="721120">supplied.</span> <span m="722180">This</span> <span m="722315">is</span> <span m="722450">sort</span> <span m="722517">of</span> <span m="722585">what</span> <span m="722652">the</span> <span m="722720">application</span> <span m="723130">gets</span> <span m="723540">to</span> <span m="723670">see.</span> </p>
<p><span m="724400">Inside</span> <span m="725040">of</span> <span m="725140">the</span> <span m="725290">kernel,</span> <span m="725840">there's</span> <span m="726060">also</span> <span m="726850">the</span> <span m="727130">current</span> <span m="727630">user</span> <span m="727925">ID</span> <span m="728220">of</span> <span m="728330">the</span> <span m="728440">process</span> <span m="729010">making</span> <span m="729330">the</span> <span m="729440">calls.</span> <span m="729780">So this</span> <span m="730593">is the</span> <span m="731540">current</span> <span m="732030">prox</span> <span m="732315">UID.</span> <span m="735140">And</span> <span m="735520">this</span> <span m="735840">thing</span> <span m="736360">goes</span> <span m="736760">into</span> <span m="737720">the</span> <span m="737880">decision</span> <span m="738250">of</span> <span m="739010">whether</span> <span m="739340">to</span> <span m="739880">allow</span> <span m="740360">a</span> <span m="740420">particular</span> <span m="740890">operation</span> <span m="741480">or</span> <span m="741550">not.</span> <span m="742710">So</span> <span m="742920">it's the</span> <span m="743430">current</span> <span m="743860">process</span> <span m="744145">user</span> <span m="744430">ID</span> <span m="744770">that's this</span> <span m="745495">ambient</span> <span m="746155">privilege.</span> <span m="747210">Whatever</span> <span m="747400">operation</span> <span m="747725">you're going to</span> <span m="748260">try</span> <span m="748560">to</span> <span m="748690">do,</span> <span m="749240">the</span> <span m="749360">kernel</span> <span m="749685">will actually</span> <span m="750410">try,</span> <span m="750715">in some</span> <span m="751020">sense,</span> <span m="751540">as</span> <span m="751960">hard</span> <span m="752210">as</span> <span m="752320">possible</span> <span m="752580">to</span> <span m="752840">allow it</span> <span m="753680">by</span> <span m="754460">using your</span> <span m="755190">current</span> <span m="755440">UID,</span> <span m="755815">and</span> <span m="756190">your</span> <span m="756690">current</span> <span m="757010">GID</span> <span m="757380">and</span> <span m="757750">whatever</span> <span m="758080">other</span> <span m="758650">extra</span> <span m="758940">privileges</span> <span m="759410">you</span> <span m="759510">might</span> <span m="759770">have.</span> </p>
<p><span m="760500">And</span> <span m="760790">as</span> <span m="761080">long as</span> <span m="761330">there's</span> <span m="761450">some</span> <span m="761790">set</span> <span m="762010">of</span> <span m="762330">privileges</span> <span m="762660">that</span> <span m="762920">allow</span> <span m="763100">you to do</span> <span m="763160">it,</span> <span m="763425">it'll let</span> <span m="763690">you</span> <span m="764020">do it.</span> <span m="765930">Which</span> <span m="766060">is</span> <span m="766160">maybe</span> <span m="766390">not</span> <span m="766580">the</span> <span m="766670">best</span> <span m="767010">thing to</span> <span m="767120">do</span> <span m="767880">if you</span> <span m="768230">aren't</span> <span m="768620">fully</span> <span m="769400">aware</span> <span m="769750">of</span> <span m="769870">what all</span> <span m="770110">these</span> <span m="770330">problems</span> <span m="770770">are.</span> <span m="771080">Maybe you don't want</span> <span m="771380">to use</span> <span m="771630">all of</span> <span m="772300">them</span> <span m="773010">to</span> <span m="773200">open</span> <span m="773440">a</span> <span m="774140">particular</span> <span m="774510">file or</span> <span m="774880">make</span> <span m="775060">some</span> <span m="775200">other</span> <span m="776010">operation.</span> </p>
<p><span m="777910">Does this</span> <span m="778080">make sense,</span> <span m="778190">roughly</span> <span m="778790">what</span> <span m="779590">ambient</span> <span m="780220">privilege</span> <span m="781040">is?</span> <span m="781965">In the</span> <span m="782300">case</span> <span m="782520">of an</span> <span m="782650">operating</span> <span m="783010">system,</span> <span m="783325">it</span> <span m="783640">basically ends</span> <span m="783870">up being</span> <span m="784690">the</span> <span m="784770">fact that a</span> <span m="785410">process</span> <span m="785860">has some</span> <span m="785960">sort of</span> <span m="786370">a</span> <span m="786790">user</span> <span m="787040">ID.</span> <span m="787680">Are</span> <span m="788030">there</span> <span m="788250">non-OS</span> <span m="788800">examples</span> <span m="789850">of</span> <span m="790710">ambient</span> <span m="791090">privilege</span> <span m="791570">you guys</span> <span m="791810">can</span> <span m="791930">think</span> <span m="792090">of?</span> <span m="792710">Like</span> <span m="793170">when</span> <span m="793280">you're</span> <span m="793400">making an</span> <span m="793750">operation,</span> <span m="794860">something</span> <span m="795280">about</span> <span m="795550">the</span> <span m="796010">identity</span> <span m="796490">of</span> <span m="796580">the</span> <span m="796690">caller,</span> <span m="797030">the</span> <span m="797180">terms</span> <span m="797352">of</span> <span m="797525">whether</span> <span m="797697">they'll</span> <span m="797870">succeed</span> <span m="798390">or</span> <span m="798450">not.</span> </p>
<p><span m="801640">Like one</span> <span m="801840">example</span> <span m="802260">is probably</span> <span m="802710">firewalls,</span> <span m="802980">as well.</span> <span m="803765">So this is</span> <span m="804270">just</span> <span m="804660">an</span> <span m="805050">OS</span> <span m="805380">example.</span> <span m="805610">And</span> <span m="805920">in privilege,</span> <span m="806337">another is</span> <span m="807171">the</span> <span m="807590">firewalls</span> <span m="808020">on the</span> <span m="808080">network.</span> <span m="809940">Because</span> <span m="811190">any</span> <span m="811440">operation</span> <span m="811760">you do</span> <span m="812080">from a</span> <span m="812290">machine</span> <span m="812570">inside</span> <span m="812870">of</span> <span m="813250">a</span> <span m="813400">firewall</span> <span m="814320">is going</span> <span m="814450">to be</span> <span m="814690">allowed</span> <span m="815180">because,</span> <span m="815890">well,</span> <span m="816160">you just</span> <span m="816640">have that</span> <span m="817120">IP address,</span> <span m="817410">or</span> <span m="818020">you're</span> <span m="818540">on</span> <span m="818700">that side</span> <span m="818760">of</span> <span m="819180">a</span> <span m="819250">network.</span> <span m="819930">And</span> <span m="820050">if</span> <span m="820110">you're</span> <span m="820260">outside,</span> <span m="820760">the</span> <span m="820820">same</span> <span m="821030">operation</span> <span m="821450">will</span> <span m="821570">be</span> <span m="821700">disallowed.</span> <span m="823870">So</span> <span m="823961">it's</span> <span m="824053">also</span> <span m="824145">a</span> <span m="824420">solar</span> <span m="824970">problem.</span> </p>
<p><span m="827330">Say you</span> <span m="827700">visit</span> <span m="828000">some</span> <span m="828060">website,</span> <span m="828425">and</span> <span m="828790">the</span> <span m="828830">website</span> <span m="829590">includes</span> <span m="829910">a</span> <span m="829990">link</span> <span m="830850">to</span> <span m="831010">some</span> <span m="831710">different</span> <span m="832080">server,</span> <span m="833070">well,</span> <span m="833390">maybe</span> <span m="834100">you</span> <span m="834190">don't</span> <span m="834440">want</span> <span m="834650">to</span> <span m="834730">use</span> <span m="834880">the</span> <span m="835110">privileges</span> <span m="835600">that you have</span> <span m="835710">or the</span> <span m="836190">inside</span> <span m="836640">of</span> <span m="836760">your</span> <span m="836870">network</span> <span m="837190">to access</span> <span m="837680">that</span> <span m="837840">link.</span> <span m="838560">Because</span> <span m="838680">maybe</span> <span m="838800">it'll</span> <span m="839070">access</span> <span m="839390">your internal</span> <span m="839790">printer</span> <span m="840500">and</span> <span m="840750">exploit it</span> <span m="841260">in</span> <span m="841470">some</span> <span m="841720">way.</span> <span m="842470">And</span> <span m="842630">really,</span> <span m="843260">the</span> <span m="843380">guy</span> <span m="843650">that provided</span> <span m="843950">you the</span> <span m="844250">link</span> <span m="845230">shouldn't have</span> <span m="845670">been</span> <span m="846110">able</span> <span m="846210">to reach the</span> <span m="846490">printer in</span> <span m="846860">the</span> <span m="847190">first</span> <span m="847420">place,</span> <span m="848212">because</span> <span m="848800">they were on the</span> <span m="849060">outside.</span> <span m="849230">Or a</span> <span m="849360">firewall</span> <span m="849850">that</span> <span m="850530">your</span> <span m="850800">browser,</span> <span m="851650">maybe by</span> <span m="853120">visiting</span> <span m="853730">uplink,</span> <span m="854190">will</span> <span m="854310">be</span> <span m="854490">tricked into doing this.</span> </p>
<p><span m="855885">It's</span> <span m="856170">sort of</span> <span m="856465">a</span> <span m="857060">moral</span> <span m="857315">equivalent</span> <span m="857790">of this</span> <span m="858510">confused</span> <span m="859510">problem</span> <span m="860010">on</span> <span m="860260">the</span> <span m="860510">network models.</span> <span m="861010">Yeah?</span> </p>
<p><span m="862010">AUDIENCE: [INAUDIBLE]</span> <span m="863510">permission are</span> <span m="864010">directly</span> <span m="864510">affected also.</span> </p>
<p><span m="865510">PROFESSOR: Yeah.</span> </p>
<p><span m="866010">AUDIENCE: Because</span> <span m="866510">it's essentially</span> <span m="867010">DAC,</span> <span m="867690">potentially,</span> <span m="868070">in</span> <span m="868260">the</span> <span m="868450">Capsicum.</span> </p>
<p><span m="868830">PROFESSOR: Yeah.</span> <span m="869280">So this is</span> <span m="869620">pretty</span> <span m="869790">much</span> <span m="870010">what</span> <span m="870330">the</span> <span m="870550">Capsicum</span> <span m="870930">guys</span> <span m="871250">think</span> <span m="871480">of</span> <span m="871550">as</span> <span m="871620">discretionary</span> <span m="872500">access</span> <span m="872880">control.</span> <span m="873550">And the fact</span> <span m="873975">that it's</span> <span m="874710">discretionary,</span> <span m="875250">well,</span> <span m="875800">this is</span> <span m="876090">not</span> <span m="876500">quite</span> <span m="876880">what</span> <span m="877690">discretionary</span> <span m="878230">access</span> <span m="878520">control means.</span> <span m="879470">But</span> <span m="880000">what</span> <span m="880600">discretionary</span> <span m="880970">access</span> <span m="881170">control</span> <span m="881510">means</span> <span m="881790">is</span> <span m="882000">that</span> <span m="882420">the user,</span> <span m="882868">or the</span> <span m="883316">owner</span> <span m="883764">of</span> <span m="884212">an</span> <span m="884660">object,</span> <span m="885350">can</span> <span m="885490">decide</span> <span m="886200">what</span> <span m="886440">security</span> <span m="886900">policy</span> <span m="887280">will look</span> <span m="887560">like</span> <span m="887850">to an</span> <span m="888000">object.</span> <span m="889000">Which</span> <span m="889070">seems very</span> <span m="889360">natural</span> <span m="889790">in a Unix</span> <span m="890010">setting.</span> <span m="890300">it's my</span> <span m="890720">files,</span> <span m="891025">I can decide</span> <span m="891330">what I</span> <span m="891600">want.</span> <span m="891970">I can</span> <span m="892150">give them to you,</span> <span m="892630">or I can</span> <span m="892690">keep them</span> <span m="892970">private,</span> <span m="893060">great.</span> </p>
<p><span m="895960">So</span> <span m="896910">almost all</span> <span m="897610">DAC</span> <span m="897900">systems</span> <span m="898380">do</span> <span m="898540">look</span> <span m="898700">like</span> <span m="898840">this,</span> <span m="899020">because</span> <span m="899490">they</span> <span m="899620">want</span> <span m="899860">to</span> <span m="899900">have</span> <span m="900110">some</span> <span m="900390">sort</span> <span m="900570">of</span> <span m="900700">permissions</span> <span m="901300">that</span> <span m="901570">a</span> <span m="901660">user could</span> <span m="901980">modify</span> <span m="902830">to</span> <span m="902990">control</span> <span m="903390">the</span> <span m="904070">security</span> <span m="904450">policy for their</span> <span m="905070">files.</span> <span m="907800">The</span> <span m="907880">flip</span> <span m="908170">side</span> <span m="908480">is</span> <span m="908590">mandatory</span> <span m="909050">access</span> <span m="909400">control.</span> <span m="911910">We'll</span> <span m="912300">talk about it</span> <span m="912725">in</span> <span m="913150">a</span> <span m="913240">little</span> <span m="913420">while,</span> <span m="913680">but</span> <span m="914570">at</span> <span m="914690">some</span> <span m="914830">level,</span> <span m="915440">they</span> <span m="915530">have</span> <span m="915670">this</span> <span m="915830">very</span> <span m="916060">philosophically</span> <span m="916660">different</span> <span m="917080">view</span> <span m="917340">of</span> <span m="917420">the</span> <span m="917500">world.</span> <span m="917860">They think,</span> <span m="918050">well,</span> <span m="918590">you're</span> <span m="919230">the</span> <span m="919330">user.</span> <span m="920000">But</span> <span m="920290">someone</span> <span m="920690">else</span> <span m="921030">will</span> <span m="921200">set</span> <span m="921380">the</span> <span m="921460">security</span> <span m="921880">policy</span> <span m="922240">for</span> <span m="922360">how</span> <span m="922630">you</span> <span m="922920">use this</span> <span m="923100">computer.</span> </p>
<p><span m="924460">And</span> <span m="924860">this sort of</span> <span m="925150">came</span> <span m="925400">out</span> <span m="925780">of the</span> <span m="925960">military</span> <span m="926920">in the</span> <span m="927980">'70s</span> <span m="928490">or</span> <span m="928610">'80s,</span> <span m="929000">when</span> <span m="929200">they</span> <span m="929550">really</span> <span m="929810">wanted</span> <span m="930050">to</span> <span m="930090">have</span> <span m="930840">classified</span> <span m="932240">computer</span> <span m="932650">systems</span> <span m="933050">where,</span> <span m="933550">well,</span> <span m="933840">you're</span> <span m="934020">working</span> <span m="934320">on</span> <span m="934420">some stuff and it's</span> <span m="935050">marked</span> <span m="935370">secret.</span> <span m="935850">I'm working on</span> <span m="936280">some stuff</span> <span m="936640">that's marked</span> <span m="937170">top secret.</span> <span m="937440">So my</span> <span m="938030">stuff just</span> <span m="938330">can't go to</span> <span m="939090">you.</span> <span m="939270">It's</span> <span m="939600">not up to</span> <span m="939920">me</span> <span m="940180">whether</span> <span m="940440">to set</span> <span m="940700">the permissions on a file,</span> <span m="941133">et cetera.</span> <span m="942000">It's</span> <span m="942820">just not</span> <span m="943300">allowed by</span> <span m="943440">some</span> <span m="943670">guy in charge.</span> </p>
<p><span m="944830">So</span> <span m="945240">mandatory</span> <span m="945500">access</span> <span m="945920">control</span> <span m="946175">is</span> <span m="946430">really</span> <span m="946630">trying</span> <span m="946860">to</span> <span m="947020">enforce</span> <span m="947270">these</span> <span m="947890">different</span> <span m="948370">kinds</span> <span m="948790">of</span> <span m="949010">policies</span> <span m="949640">in</span> <span m="949690">the</span> <span m="949760">first</span> <span m="950020">place,</span> <span m="950360">where</span> <span m="951610">there's</span> <span m="952500">the</span> <span m="952670">user</span> <span m="952880">and the</span> <span m="953090">application</span> <span m="953560">developer.</span> <span m="954610">And</span> <span m="954720">then there's</span> <span m="954900">some</span> <span m="955110">guy</span> <span m="955450">separate</span> <span m="956090">from</span> <span m="956440">the</span> <span m="956650">user</span> <span m="956910">and the</span> <span m="957050">developer</span> <span m="957710">that</span> <span m="957910">sets</span> <span m="958130">the</span> <span m="958240">policy.</span> </p>
<p><span m="959472">And,</span> <span m="959964">as</span> <span m="960456">you</span> <span m="960950">can sort of guess,</span> <span m="961285">it</span> <span m="961620">doesn't</span> <span m="961870">always</span> <span m="962210">work</span> <span m="962480">out.</span> <span m="962810">Well, we'll</span> <span m="963140">talk</span> <span m="963280">about</span> <span m="963460">it in a bit.</span> <span m="963950">But</span> <span m="964215">that's</span> <span m="964480">what</span> <span m="965040">discretionary</span> <span m="965470">versus</span> <span m="965760">mandatory means</span> <span m="966243">at</span> <span m="966726">this</span> <span m="967209">control.</span> </p>
<p><span m="970110">All right.</span> <span m="971310">So there's</span> <span m="971670">many</span> <span m="972330">other</span> <span m="972787">examples</span> <span m="973244">that you could</span> <span m="973701">imagine</span> <span m="974160">where</span> <span m="974480">we</span> <span m="974650">have</span> <span m="975110">ambient</span> <span m="975460">authority.</span> <span m="976040">And</span> <span m="976600">it's</span> <span m="976770">not</span> <span m="976930">inherently</span> <span m="977530">bad,</span> <span m="978450">law</span> <span m="978990">but</span> <span m="979540">it's</span> <span m="979700">just</span> <span m="980520">something</span> <span m="980910">that</span> <span m="981110">you</span> <span m="981190">have</span> <span m="981350">to</span> <span m="981430">be</span> <span m="981600">very</span> <span m="981880">careful</span> <span m="982370">about.</span> <span m="983030">If you have</span> <span m="983230">a</span> <span m="983620">system with</span> <span m="983740">ambient</span> <span m="984150">authority,</span> <span m="984470">you should</span> <span m="985300">probably</span> <span m="985590">be</span> <span m="986110">very</span> <span m="986340">careful</span> <span m="987020">if</span> <span m="987220">you're</span> <span m="987370">performing</span> <span m="988080">privileged</span> <span m="988510">operations.</span> <span m="989820">You</span> <span m="989930">should</span> <span m="990090">make</span> <span m="990270">sure</span> <span m="990550">that</span> <span m="990730">you're</span> <span m="990930">really</span> <span m="991220">using</span> <span m="991530">the</span> <span m="991800">right</span> <span m="992050">authority</span> <span m="994320">and</span> <span m="994650">not</span> <span m="995570">accidentally</span> <span m="995730">being</span> <span m="995980">tricked</span> <span m="996250">very</span> <span m="996385">much</span> <span m="996520">like</span> <span m="996600">this</span> <span m="996830">Fortran</span> <span m="997230">compiler</span> <span m="997770">20</span> <span m="998140">years</span> <span m="998420">ago.</span> <span m="999146">25</span> <span m="999642">now.</span> </p>
<p><span m="1001580">All</span> <span m="1001660">right.</span> <span m="1002450">So</span> <span m="1003190">this</span> <span m="1003360">is</span> <span m="1003500">one</span> <span m="1004100">interpretation of</span> <span m="1004640">what</span> <span m="1004880">goes</span> <span m="1005080">wrong.</span> <span m="1005470">And</span> <span m="1006890">it's not necessarily</span> <span m="1007330">the</span> <span m="1007520">only</span> <span m="1007820">way</span> <span m="1007960">to</span> <span m="1008060">think</span> <span m="1008260">about</span> <span m="1008420">what</span> <span m="1008590">goes wrong,</span> <span m="1008820">right?</span> <span m="1009070">Another</span> <span m="1009570">possibility</span> <span m="1010110">is</span> <span m="1010250">that,</span> <span m="1011080">well,</span> <span m="1011270">wouldn't it be</span> <span m="1011430">nice if it</span> <span m="1011850">was</span> <span m="1012270">easy for</span> <span m="1012720">an</span> <span m="1012890">application</span> <span m="1013400">to</span> <span m="1013480">tell</span> <span m="1014430">whether</span> <span m="1014830">it should</span> <span m="1015000">access</span> <span m="1015420">a</span> <span m="1015510">file</span> <span m="1015890">on</span> <span m="1015970">behalf</span> <span m="1016440">of some</span> <span m="1016540">principle?</span> </p>
<p><span m="1017445">So</span> <span m="1017840">maybe</span> <span m="1018070">another</span> <span m="1018420">problem</span> <span m="1019020">is</span> <span m="1019320">that the</span> <span m="1020050">access</span> <span m="1020350">control</span> <span m="1020700">checks</span> <span m="1021050">are</span> <span m="1021537">complicated.</span> <span m="1027381">So in some</span> <span m="1027880">sense,</span> <span m="1028800">when the</span> <span m="1028950">Fortran</span> <span m="1029359">compiler</span> <span m="1029659">is</span> <span m="1030020">running,</span> <span m="1030294">and it's</span> <span m="1031030">opening</span> <span m="1031460">a</span> <span m="1031520">file</span> <span m="1031940">on</span> <span m="1032079">behalf</span> <span m="1032569">of</span> <span m="1032720">a</span> <span m="1032780">user,</span> <span m="1033900">it</span> <span m="1034050">basically</span> <span m="1034329">needs to</span> <span m="1034609">replicate</span> <span m="1035210">the</span> <span m="1035300">same</span> <span m="1035670">exact</span> <span m="1036130">logic</span> <span m="1036660">we</span> <span m="1036920">see</span> <span m="1037200">drawn</span> <span m="1037450">out</span> <span m="1037609">here,</span> <span m="1038099">except</span> <span m="1038510">that</span> <span m="1038950">the</span> <span m="1039313">Fortran compiler</span> <span m="1040040">needs</span> <span m="1040240">to</span> <span m="1040349">plug-in</span> <span m="1041180">something</span> <span m="1041609">else</span> <span m="1042060">here.</span> <span m="1042490">Instead</span> <span m="1042730">of</span> <span m="1042920">using</span> <span m="1043200">its</span> <span m="1043380">current</span> <span m="1043970">privileges,</span> <span m="1044360">and</span> <span m="1045109">all of</span> <span m="1045440">them,</span> <span m="1045770">it should just</span> <span m="1046153">replicate</span> <span m="1046536">this</span> <span m="1047030">check</span> <span m="1047470">and</span> <span m="1048550">try</span> <span m="1048740">to</span> <span m="1048850">make</span> <span m="1049050">it</span> <span m="1049200">with</span> <span m="1049340">a</span> <span m="1049430">different</span> <span m="1049870">set</span> <span m="1049990">of</span> <span m="1050120">privileges.</span> </p>
<p><span m="1052150">So in</span> <span m="1052310">Unix,</span> <span m="1052450">this turns</span> <span m="1052750">out</span> <span m="1053090">to</span> <span m="1053160">be</span> <span m="1053830">fairly</span> <span m="1054110">tricky</span> <span m="1054350">to</span> <span m="1054460">do,</span> <span m="1055300">because</span> <span m="1055660">there's</span> <span m="1055850">many</span> <span m="1056640">places</span> <span m="1056920">where</span> <span m="1057480">these</span> <span m="1057730">security checks</span> <span m="1058180">happen.</span> <span m="1058500">if you have</span> <span m="1059270">symbolic</span> <span m="1059820">links,</span> <span m="1060230">then the</span> <span m="1060420">symbolic</span> <span m="1060720">link</span> <span m="1061020">gets</span> <span m="1061260">looked</span> <span m="1061500">up,</span> <span m="1061830">and</span> <span m="1062100">that</span> <span m="1062965">path name</span> <span m="1063570">also</span> <span m="1063660">gets</span> <span m="1063820">evaluated</span> <span m="1064250">with</span> <span m="1065370">someone's</span> <span m="1065625">privileges,</span> <span m="1065880">et</span> <span m="1066140">cetera.</span> </p>
<p><span m="1067540">But</span> <span m="1068930">it might be that,</span> <span m="1069370">in some system,</span> <span m="1070220">you</span> <span m="1070350">could</span> <span m="1070820">simplify</span> <span m="1071290">this</span> <span m="1071410">access</span> <span m="1071675">control</span> <span m="1071940">check,</span> <span m="1072150">where you could</span> <span m="1072460">do</span> <span m="1072670">it</span> <span m="1072770">yourself</span> <span m="1074060">in</span> <span m="1074170">an</span> <span m="1074260">application.</span> <span m="1075632">Does that seem</span> <span m="1076350">like</span> <span m="1076520">a</span> <span m="1076550">reasonable</span> <span m="1076860">plan</span> <span m="1077050">to</span> <span m="1077110">you guys?</span> <span m="1079320">Would</span> <span m="1079530">you</span> <span m="1079790">go</span> <span m="1079926">with</span> <span m="1080063">that?</span> <span m="1081960">Any</span> <span m="1082010">dangers</span> <span m="1082520">of</span> <span m="1083110">replicating</span> <span m="1083375">these checks?</span> <span m="1083640">Yeah?</span> </p>
<p><span m="1084260">AUDIENCE: Well,</span> <span m="1085572">if</span> <span m="1086003">you do</span> <span m="1086434">the checks in the application,</span> <span m="1086865">you could just</span> <span m="1087296">not</span> <span m="1087730">do</span> <span m="1087990">the checks.</span> </p>
<p><span m="1088930">PROFESSOR: Yeah.</span> <span m="1089260">So you could</span> <span m="1089770">easily miss</span> <span m="1089940">the</span> <span m="1090050">checks.</span> <span m="1090360">That's absolutely</span> <span m="1090830">right.</span> <span m="1091060">So</span> <span m="1091540">in</span> <span m="1091690">some</span> <span m="1091890">sense,</span> <span m="1092300">what the Fortran</span> <span m="1092570">compiler</span> <span m="1092980">did</span> <span m="1093210">here,</span> <span m="1093680">well,</span> <span m="1093930">they didn't</span> <span m="1094100">even</span> <span m="1094260">bother</span> <span m="1094580">trying</span> <span m="1094780">to</span> <span m="1094860">do</span> <span m="1094950">the</span> <span m="1095060">checks,</span> <span m="1095370">now</span> <span m="1095500">that</span> <span m="1095630">they</span> <span m="1095760">screwed</span> <span m="1096000">them</span> <span m="1096130">up.</span> </p>
<p><span m="1096810">Another</span> <span m="1097170">possibility,</span> <span m="1097690">in addition to</span> <span m="1098310">missing</span> <span m="1098580">the</span> <span m="1098630">checks,</span> <span m="1098950">is</span> <span m="1100070">maybe</span> <span m="1100270">the</span> <span m="1100420">kernel</span> <span m="1100780">will</span> <span m="1101100">change</span> <span m="1101430">over</span> <span m="1101610">time,</span> <span m="1102090">and it</span> <span m="1102160">will</span> <span m="1102280">have</span> <span m="1102460">slightly</span> <span m="1102690">different</span> <span m="1103000">checks.</span> <span m="1103380">It will introduce</span> <span m="1103690">some</span> <span m="1103840">extra</span> <span m="1104080">security</span> <span m="1104410">measure,</span> <span m="1105100">and the</span> <span m="1105340">application</span> <span m="1105870">will be</span> <span m="1105980">left</span> <span m="1106180">behind.</span> <span m="1106670">And</span> <span m="1106920">it will</span> <span m="1107490">implement</span> <span m="1107850">old style checks.</span> <span m="1108455">And</span> <span m="1109570">probably</span> <span m="1109680">not</span> <span m="1110010">a</span> <span m="1110435">great</span> <span m="1110860">plan.</span> </p>
<p><span m="1111280">So</span> <span m="1111470">recall,</span> <span m="1112870">one</span> <span m="1113680">good</span> <span m="1114020">idea</span> <span m="1114480">in</span> <span m="1114735">security is</span> <span m="1114990">to</span> <span m="1115370">have</span> <span m="1115620">economy</span> <span m="1115980">of</span> <span m="1116110">mechanisms.</span> <span m="1116590">So</span> <span m="1116890">there's</span> <span m="1117120">only</span> <span m="1117620">a</span> <span m="1117680">small</span> <span m="1118100">number</span> <span m="1118380">of places that</span> <span m="1118950">are enforcing</span> <span m="1119310">your</span> <span m="1119470">security</span> <span m="1119840">policies.</span> <span m="1120180">You</span> <span m="1120280">probably</span> <span m="1120520">don't</span> <span m="1120660">want</span> <span m="1120850">to</span> <span m="1121340">replicate</span> <span m="1121890">the</span> <span m="1121970">same</span> <span m="1122300">functionality</span> <span m="1123500">in</span> <span m="1124160">applications</span> <span m="1124645">in the</span> <span m="1125130">kernel,</span> <span m="1125800">et cetera.</span> <span m="1126020">You really want</span> <span m="1126270">to boil it</span> <span m="1126830">down</span> <span m="1127110">to one place.</span> <span m="1128090">That</span> <span m="1128420">roughly</span> <span m="1128910">makes</span> <span m="1129090">sense?</span> <span m="1130900">OK.</span> </p>
<p><span m="1132070">So</span> <span m="1135300">what</span> <span m="1135490">is</span> <span m="1135950">this</span> <span m="1136180">capability,</span> <span m="1136580">I</span> <span m="1136780">guess,</span> <span m="1136980">idea</span> <span m="1139068">where</span> <span m="1139470">thinking</span> <span m="1140250">might</span> <span m="1140540">solve</span> <span m="1140610">this</span> <span m="1140680">authority</span> <span m="1141400">problem?</span> <span m="1142220">Well,</span> <span m="1143065">there's</span> <span m="1143440">some</span> <span m="1143970">formal</span> <span m="1144290">definition</span> <span m="1144680">for</span> <span m="1144840">the</span> <span m="1144940">thing.</span> <span m="1145150">But</span> <span m="1145490">really,</span> <span m="1145890">you can</span> <span m="1146670">get</span> <span m="1146850">very</span> <span m="1147060">close</span> <span m="1147360">by</span> <span m="1147500">thinking</span> <span m="1147840">of</span> <span m="1148010">Unix</span> <span m="1148340">file</span> <span m="1148570">descriptors</span> <span m="1149220">as</span> <span m="1149590">a</span> <span m="1150010">capability.</span> </p>
<p><span m="1151270">So</span> <span m="1153340">I guess the</span> <span m="1153740">alternative</span> <span m="1154200">to</span> <span m="1154280">this</span> <span m="1154570">picture,</span> <span m="1155210">in</span> <span m="1155450">capability</span> <span m="1155970">world,</span> <span m="1156730">is</span> <span m="1157070">that</span> <span m="1158180">instead</span> <span m="1158470">of</span> <span m="1158580">having the</span> <span m="1159370">application</span> <span m="1159745">supply</span> <span m="1160120">name,</span> <span m="1160510">and you</span> <span m="1160920">look up</span> <span m="1161260">an</span> <span m="1161340">object,</span> <span m="1161820">you get</span> <span m="1161980">a</span> <span m="1162245">permission,</span> <span m="1162510">you decide whether</span> <span m="1162980">to allow it</span> <span m="1163810">based</span> <span m="1164180">on some ambient</span> <span m="1164540">authority,</span> <span m="1165050">instead,</span> <span m="1165910">the</span> <span m="1166130">capability</span> <span m="1166460">is</span> <span m="1166510">the</span> <span m="1166590">picture</span> <span m="1166850">looks</span> <span m="1167490">very</span> <span m="1167710">simple.</span> <span m="1168920">You</span> <span m="1169030">have</span> <span m="1169150">a</span> <span m="1169220">capability,</span> <span m="1169920">and</span> <span m="1170382">if you have</span> <span m="1170844">a capability,</span> <span m="1172230">it</span> <span m="1172470">points to</span> <span m="1172880">an</span> <span m="1172970">object.</span> <span m="1175270">And</span> <span m="1175600">maybe</span> <span m="1176170">the</span> <span m="1176260">capability</span> <span m="1176750">has</span> <span m="1176910">some</span> <span m="1177300">small number of</span> <span m="1177850">restrictions</span> <span m="1178800">of</span> <span m="1178860">what</span> <span m="1179010">you can</span> <span m="1179100">do</span> <span m="1179360">with</span> <span m="1179510">an</span> <span m="1179580">object.</span> </p>
<p><span m="1180450">But</span> <span m="1180580">basically,</span> <span m="1181360">if</span> <span m="1181530">you</span> <span m="1181590">have</span> <span m="1181810">the</span> <span m="1181880">capability</span> <span m="1182170">to</span> <span m="1182460">an</span> <span m="1182580">object,</span> <span m="1183340">you</span> <span m="1183460">can</span> <span m="1183800">access the</span> <span m="1184180">object.</span> <span m="1184830">It's</span> <span m="1185170">actually</span> <span m="1185850">very</span> <span m="1186060">simple.</span> <span m="1186420">So</span> <span m="1186520">there's</span> <span m="1186800">no</span> <span m="1187510">ambient</span> <span m="1188110">authority</span> <span m="1188670">that</span> <span m="1189280">decides</span> <span m="1190130">whether</span> <span m="1190460">an</span> <span m="1190590">operation</span> <span m="1191210">on a</span> <span m="1191300">capability</span> <span m="1191470">is going</span> <span m="1191970">to</span> <span m="1192130">be</span> <span m="1192230">allowed.</span> <span m="1193310">The</span> <span m="1193380">only</span> <span m="1193690">thing</span> <span m="1193940">is</span> <span m="1194070">that</span> <span m="1194240">maybe</span> <span m="1194480">the</span> <span m="1194630">capability</span> <span m="1195070">has</span> <span m="1195290">a</span> <span m="1195310">couple</span> <span m="1195570">of extra</span> <span m="1195790">bits,</span> <span m="1196180">or</span> <span m="1196570">this</span> <span m="1196770">mass</span> <span m="1197035">that</span> <span m="1197300">they described in the</span> <span m="1198000">paper,</span> <span m="1198550">which</span> <span m="1198790">says,</span> <span m="1199180">well,</span> <span m="1199570">you have a capability for this</span> <span m="1200280">file,</span> <span m="1201090">as</span> <span m="1201520">it's</span> <span m="1201720">restricted</span> <span m="1202240">to</span> <span m="1202390">read</span> <span m="1202650">operations</span> <span m="1203120">only.</span> <span m="1203470">Or it's</span> <span m="1203730">restricted</span> <span m="1204220">to</span> <span m="1204650">write</span> <span m="1205070">or</span> <span m="1205380">append</span> <span m="1205590">operations</span> <span m="1205965">only.</span> </p>
<p><span m="1207440">And</span> <span m="1207900">then</span> <span m="1208150">your</span> <span m="1208280">security</span> <span m="1208540">decisions</span> <span m="1208890">are</span> <span m="1209240">all of</span> <span m="1209660">a sudden</span> <span m="1210010">very</span> <span m="1210440">easy.</span> <span m="1211080">Because</span> <span m="1211480">if you</span> <span m="1211640">have</span> <span m="1211850">a</span> <span m="1211950">capability,</span> <span m="1212260">you can</span> <span m="1212650">do</span> <span m="1212800">something.</span> <span m="1213410">If you</span> <span m="1213850">don't,</span> <span m="1214250">you</span> <span m="1214460">can't.</span> <span m="1215248">Make</span> <span m="1215696">sense?</span> </p>
<p><span m="1217940">So</span> <span m="1219260">I</span> <span m="1219280">guess</span> <span m="1219440">one</span> <span m="1219660">important</span> <span m="1220420">property</span> <span m="1220760">of</span> <span m="1220890">capability</span> <span m="1221430">is</span> <span m="1221560">that</span> <span m="1221960">they</span> <span m="1222540">should</span> <span m="1222810">actually</span> <span m="1223200">be</span> <span m="1223940">unforgeable,</span> <span m="1225000">as</span> <span m="1225670">the</span> <span m="1225780">papers</span> <span m="1226210">talk</span> <span m="1226640">about.</span> <span m="1227440">So</span> <span m="1227810">what does it</span> <span m="1228160">mean</span> <span m="1228400">to</span> <span m="1228460">be</span> <span m="1228750">unforgeable,</span> <span m="1229020">or</span> <span m="1229230">why</span> <span m="1229420">do</span> <span m="1229510">we</span> <span m="1229570">want</span> <span m="1229880">this</span> <span m="1230330">in this</span> <span m="1231030">capability</span> <span m="1231520">world?</span> </p>
<p><span m="1234980">Well,</span> <span m="1235100">I guess this</span> <span m="1235320">actually may</span> <span m="1235490">be</span> <span m="1236420">almost too</span> <span m="1236660">obvious</span> <span m="1237170">here.</span> <span m="1237700">Well,</span> <span m="1237810">if you can</span> <span m="1238130">make</span> <span m="1238500">up any</span> <span m="1238670">capability</span> <span m="1238945">you want--</span> <span m="1240030">I</span> <span m="1240110">can make up</span> <span m="1240260">a</span> <span m="1240570">capability</span> <span m="1240825">for</span> <span m="1241240">any of</span> <span m="1241440">your</span> <span m="1241600">guys'</span> <span m="1241920">files</span> <span m="1242480">and</span> <span m="1242550">go access it.</span> <span m="1243140">So if I</span> <span m="1243270">can</span> <span m="1243680">make</span> <span m="1243850">it up,</span> <span m="1244270">and</span> <span m="1244570">I'll access it,</span> <span m="1244640">and there's</span> <span m="1245070">nothing</span> <span m="1245320">else</span> <span m="1246000">in</span> <span m="1246120">the</span> <span m="1246220">security</span> <span m="1246600">design,</span> <span m="1247040">that stops</span> <span m="1247590">me</span> <span m="1247760">from</span> <span m="1248015">accessing</span> <span m="1248270">an object</span> <span m="1249400">once</span> <span m="1249710">I can</span> <span m="1249960">manufacture</span> <span m="1250890">a</span> <span m="1251290">capability.</span> </p>
<p><span m="1254030">So</span> <span m="1254150">it's</span> <span m="1254350">important</span> <span m="1254650">that these</span> <span m="1254940">capabilities</span> <span m="1255870">can't</span> <span m="1256080">be</span> <span m="1256570">made</span> <span m="1256980">up</span> <span m="1257190">out</span> <span m="1257490">of</span> <span m="1257890">thin air</span> <span m="1258090">by the</span> <span m="1258420">application</span> <span m="1258765">or</span> <span m="1259110">by whatever's</span> <span m="1259880">running.</span> <span m="1261340">How</span> <span m="1261880">is this getting</span> <span m="1262190">forced,</span> <span m="1263230">if</span> <span m="1263580">we</span> <span m="1263770">think</span> <span m="1263970">of</span> <span m="1264235">file descriptors</span> <span m="1265170">as</span> <span m="1266850">capabilities?</span> <span m="1267630">So many of you</span> <span m="1268220">guys actually</span> <span m="1268650">submitted this</span> <span m="1269040">as</span> <span m="1269640">the big</span> <span m="1269940">question</span> <span m="1270280">about</span> <span m="1270480">Capsicum.</span> <span m="1271300">What do you</span> <span m="1271540">think?</span> <span m="1273080">What</span> <span m="1273270">prevents</span> <span m="1274700">an</span> <span m="1274770">application</span> <span m="1275250">from</span> <span m="1275860">synthesizing</span> <span m="1276350">a</span> <span m="1276840">capability</span> <span m="1277490">in this</span> <span m="1277985">file descriptor world?</span> </p>
<p><span m="1280490">Could you</span> <span m="1280990">synthesize</span> <span m="1281370">a capability?</span> <span m="1284310">Yeah?</span> </p>
<p><span m="1284950">AUDIENCE: Well, it was</span> <span m="1285180">probably</span> <span m="1285630">like a</span> <span m="1285860">structure</span> <span m="1286270">and</span> <span m="1286746">a</span> <span m="1287222">construct</span> <span m="1287698">that</span> <span m="1288174">says</span> <span m="1288650">that</span> <span m="1289126">they have</span> <span m="1289602">a</span> <span m="1289721">capability</span> <span m="1289840">for</span> <span m="1289959">certain</span> <span m="1290078">file</span> <span m="1290554">descriptors.</span> </p>
<p><span m="1291510">PROFESSOR: Yeah.</span> <span m="1292170">So it's</span> <span m="1292270">actually</span> <span m="1293260">fairly</span> <span m="1294880">easy</span> <span m="1295090">to</span> <span m="1295180">see</span> <span m="1295510">what</span> <span m="1295850">goes</span> <span m="1296280">on</span> <span m="1296410">once you</span> <span m="1296580">look at what</span> <span m="1297070">exactly</span> <span m="1297500">is</span> <span m="1297590">a</span> <span m="1297650">file descriptor,</span> <span m="1298040">right?</span> <span m="1298160">So a file</span> <span m="1298540">descriptor</span> <span m="1299360">is</span> <span m="1299870">basically</span> <span m="1300230">just</span> <span m="1300460">some sort of</span> <span m="1301160">an</span> <span m="1301260">integer.</span> <span m="1302040">And</span> <span m="1302180">this</span> <span m="1302280">integer--</span> <span m="1303480">like</span> <span m="1303740">in</span> <span m="1304035">Unix,</span> <span m="1304620">you have</span> <span m="1304910">file descriptor</span> <span m="1305350">0,</span> <span m="1305830">which</span> <span m="1306070">refers</span> <span m="1306140">to your</span> <span m="1306450">input,</span> <span m="1306880">file</span> <span m="1307450">descriptor</span> <span m="1307800">1</span> <span m="1308055">which refers</span> <span m="1308310">to your output.</span> <span m="1308550">Rockwell</span> </p>
<p><span m="1309470">But</span> <span m="1309830">really,</span> <span m="1310060">these are just</span> <span m="1310480">integers</span> <span m="1311320">in</span> <span m="1311490">user</span> <span m="1311820">space.</span> <span m="1312580">And</span> <span m="1314130">this is</span> <span m="1314310">what the</span> <span m="1314640">application</span> <span m="1315180">can</span> <span m="1315560">presumably</span> <span m="1315910">do,</span> <span m="1316120">and it</span> <span m="1316310">can</span> <span m="1316640">choose</span> <span m="1316930">any</span> <span m="1317200">integer</span> <span m="1317540">it wants.</span> <span m="1318380">But</span> <span m="1318520">whenever</span> <span m="1318890">you</span> <span m="1319040">try</span> <span m="1319280">to</span> <span m="1319400">do</span> <span m="1319670">something</span> <span m="1320190">to</span> <span m="1320420">a</span> <span m="1320470">file</span> <span m="1320690">descriptor,</span> <span m="1321130">which</span> <span m="1321270">is</span> <span m="1321350">one</span> <span m="1321520">of</span> <span m="1321560">these</span> <span m="1321730">integers,</span> <span m="1322570">the</span> <span m="1322700">kernel</span> <span m="1323500">will</span> <span m="1323760">always</span> <span m="1324480">interpret</span> <span m="1324810">the</span> <span m="1325140">integer</span> <span m="1325640">according</span> <span m="1326130">to</span> <span m="1326280">your</span> <span m="1326600">current</span> <span m="1327100">process's</span> <span m="1327960">file</span> <span m="1328230">descriptor</span> <span m="1328680">table.</span> </p>
<p><span m="1329490">So</span> <span m="1329730">for</span> <span m="1329910">every</span> <span m="1330200">PID--</span> <span m="1330690">let's</span> <span m="1331170">say,</span> <span m="1331310">well,</span> <span m="1331510">this is</span> <span m="1331970">PID,</span> <span m="1332430">I don't know,</span> <span m="1333040">57.</span> <span m="1333395">So I'm</span> <span m="1333750">process</span> <span m="1334120">running.</span> <span m="1334830">It</span> <span m="1334970">has</span> <span m="1335590">an</span> <span m="1335820">open</span> <span m="1336170">file</span> <span m="1336510">table,</span> <span m="1337380">and</span> <span m="1337910">each</span> <span m="1338120">integer</span> <span m="1338750">from</span> <span m="1338960">supply</span> <span m="1339250">from user</span> <span m="1339740">space,</span> <span m="1340320">refers to</span> <span m="1340800">some</span> <span m="1341080">entry</span> <span m="1342070">in</span> <span m="1342240">this</span> <span m="1342340">table.</span> <span m="1343185">And</span> <span m="1343490">of</span> <span m="1343630">course,</span> <span m="1344010">the</span> <span m="1344200">kernel</span> <span m="1344660">should</span> <span m="1345560">check</span> <span m="1345840">that</span> <span m="1346010">the</span> <span m="1346130">integer</span> <span m="1346650">is</span> <span m="1346820">in bounds</span> <span m="1347400">in</span> <span m="1347480">this</span> <span m="1347580">stable.</span> <span m="1348000">It</span> <span m="1348950">isn't</span> <span m="1349290">negative.</span> <span m="1349630">It</span> <span m="1349970">doesn't</span> <span m="1350240">go</span> <span m="1350840">past</span> <span m="1351110">the</span> <span m="1351180">end</span> <span m="1351320">of</span> <span m="1351370">the</span> <span m="1351460">table.</span> <span m="1351890">Otherwise,</span> <span m="1352370">it will have</span> <span m="1352970">the</span> <span m="1353240">usual buffer</span> <span m="1353510">overflow</span> <span m="1354050">problems,</span> <span m="1354440">et cetera.</span> </p>
<p><span m="1355630">But</span> <span m="1356570">if</span> <span m="1356750">you</span> <span m="1357010">carefully</span> <span m="1357430">check that</span> <span m="1357880">the</span> <span m="1358120">integer</span> <span m="1358385">is in</span> <span m="1358650">bounds</span> <span m="1359670">in</span> <span m="1359800">the</span> <span m="1359950">kernel</span> <span m="1360240">implementation,</span> <span m="1361380">then</span> <span m="1361700">the</span> <span m="1361810">only</span> <span m="1362190">possible</span> <span m="1362820">things</span> <span m="1363210">that the</span> <span m="1364040">application</span> <span m="1364670">can</span> <span m="1364810">refer</span> <span m="1365190">to</span> <span m="1365290">by a file</span> <span m="1365585">descriptor</span> <span m="1366550">are</span> <span m="1367120">entries</span> <span m="1367570">in</span> <span m="1367690">this</span> <span m="1367790">table.</span> <span m="1368910">So</span> <span m="1369070">presumably,</span> <span m="1369520">the</span> <span m="1369630">kernel</span> <span m="1370030">will</span> <span m="1370720">somehow</span> <span m="1371060">make</span> <span m="1371330">sure</span> <span m="1371600">that</span> <span m="1371790">you</span> <span m="1371950">legitimately</span> <span m="1372570">guard</span> <span m="1372890">a</span> <span m="1372950">particular</span> <span m="1373420">capability.</span> </p>
<p><span m="1374640">So</span> <span m="1374670">when</span> <span m="1374770">you,</span> <span m="1374970">for</span> <span m="1374980">example,</span> <span m="1375340">open</span> <span m="1375660">a</span> <span m="1375720">file</span> <span m="1377670">outside</span> <span m="1378090">of</span> <span m="1378220">this</span> <span m="1378340">capability</span> <span m="1378810">model</span> <span m="1379290">in</span> <span m="1379400">Unix,</span> <span m="1380080">well,</span> <span m="1380630">the</span> <span m="1380790">kernel,</span> <span m="1381420">after</span> <span m="1381780">the</span> <span m="1381880">open</span> <span m="1382190">call</span> <span m="1382370">succeeds,</span> <span m="1383240">it's</span> <span m="1383400">going to</span> <span m="1383910">change</span> <span m="1384290">that</span> <span m="1385610">file</span> <span m="1386830">descriptor</span> <span m="1387150">table</span> <span m="1387420">entry</span> <span m="1387950">to</span> <span m="1388060">point</span> <span m="1388310">to</span> <span m="1388370">a</span> <span m="1388430">particular</span> <span m="1388820">open</span> <span m="1389170">file,</span> <span m="1390090">like</span> <span m="1390420">maybe</span> <span m="1390720">open/etc/pwd.</span> </p>
<p><span m="1394350">And</span> <span m="1395060">now,</span> <span m="1395670">the</span> <span m="1395780">entry</span> <span m="1396130">at</span> <span m="1396250">this</span> <span m="1396360">slot</span> <span m="1396860">on</span> <span m="1396930">the</span> <span m="1397030">table</span> <span m="1397380">points to an</span> <span m="1397740">open</span> <span m="1398050">file.</span> <span m="1398670">Some of them</span> <span m="1399120">might</span> <span m="1399320">actually</span> <span m="1399590">be</span> <span m="1399810">null.</span> <span m="1400080">Maybe</span> <span m="1400330">you</span> <span m="1400520">don't</span> <span m="1400750">have</span> <span m="1400940">an</span> <span m="1401010">open</span> <span m="1401310">file</span> <span m="1401910">with</span> <span m="1402130">a</span> <span m="1402230">particular</span> <span m="1402890">index</span> <span m="1403260">in</span> <span m="1403340">this</span> <span m="1403430">table.</span> <span m="1404660">And as</span> <span m="1404920">a</span> <span m="1404980">result,</span> <span m="1405580">what</span> <span m="1405680">does</span> <span m="1405750">it</span> <span m="1405860">mean</span> <span m="1406110">to</span> <span m="1407390">forge</span> <span m="1407540">a</span> <span m="1408020">capability?</span> <span m="1409000">The only thing</span> <span m="1409250">you can</span> <span m="1409540">do in</span> <span m="1410070">user</span> <span m="1410300">space</span> <span m="1410700">is make</span> <span m="1410970">up</span> <span m="1411100">an</span> <span m="1411200">integer.</span> <span m="1412460">And</span> <span m="1412780">the</span> <span m="1412880">only integers</span> <span m="1413180">that would</span> <span m="1413830">make</span> <span m="1414100">sense</span> <span m="1414340">to</span> <span m="1414420">make</span> <span m="1414640">up</span> <span m="1415230">would</span> <span m="1415400">be</span> <span m="1415530">entries</span> <span m="1415890">that</span> <span m="1416000">point</span> <span m="1416330">to</span> <span m="1416600">non-null</span> <span m="1417080">entries</span> <span m="1417460">in</span> <span m="1417530">this</span> <span m="1417640">table.</span> <span m="1418560">And</span> <span m="1419130">those</span> <span m="1419360">guys</span> <span m="1419750">are</span> <span m="1419950">exactly</span> <span m="1420410">the</span> <span m="1420510">capabilities</span> <span m="1420770">that you have.</span> </p>
<p><span m="1422910">So</span> <span m="1423010">does that</span> <span m="1423190">make</span> <span m="1423330">sense</span> <span m="1423550">why</span> <span m="1423760">it's</span> <span m="1423920">difficult,</span> <span m="1424710">in</span> <span m="1425030">this</span> <span m="1425140">file</span> <span m="1425620">descriptor world, to</span> <span m="1425960">actually</span> <span m="1426180">forge</span> <span m="1427240">capabilities</span> <span m="1427750">in</span> <span m="1427790">the</span> <span m="1427860">first</span> <span m="1428110">place?</span> <span m="1429060">So it's kind of</span> <span m="1429260">cool,</span> <span m="1429570">right?</span> <span m="1429630">Like</span> <span m="1429810">the only</span> <span m="1430140">files</span> <span m="1430550">that</span> <span m="1430730">you</span> <span m="1431160">have</span> <span m="1431310">opened</span> <span m="1431590">are</span> <span m="1431900">exactly the</span> <span m="1432360">things you can</span> <span m="1432770">operate</span> <span m="1433260">on.</span> <span m="1433420">And there's</span> <span m="1433640">nothing</span> <span m="1433900">else</span> <span m="1434140">that</span> <span m="1434800">you</span> <span m="1434920">can</span> <span m="1435100">potentially</span> <span m="1436740">touch</span> <span m="1437200">and</span> <span m="1438120">effect.</span> <span m="1439996">Make sense?</span> <span m="1440934">Any questions?</span> </p>
<p><span m="1445630">All right.</span> <span m="1446910">OK.</span> <span m="1447110">So</span> <span m="1447210">I</span> <span m="1447270">guess,</span> <span m="1447520">how would</span> <span m="1449400">capabilities</span> <span m="1449990">help</span> <span m="1450390">solve</span> <span m="1450770">the</span> <span m="1451330">ambient</span> <span m="1451720">authority</span> <span m="1452080">problem</span> <span m="1452540">that</span> <span m="1452700">Norman Hardy</span> <span m="1452995">is</span> <span m="1453290">excited</span> <span m="1453690">about</span> <span m="1454370">with his</span> <span m="1454650">Fortran</span> <span m="1454820">compiler?</span> <span m="1456020">So what would be</span> <span m="1456620">the</span> <span m="1457220">file</span> <span m="1458110">descriptor</span> <span m="1458450">moral</span> <span m="1459040">equivalent</span> <span m="1459790">solution</span> <span m="1461060">to this</span> <span m="1461670">sysx/fort</span> <span m="1462370">thing?</span> <span m="1466340">Do they</span> <span m="1466570">actually solve</span> <span m="1466750">the problem?</span> <span m="1467140">Yeah?</span> </p>
<p><span m="1468016">AUDIENCE: Well,</span> <span m="1468454">they just</span> <span m="1469768">use</span> <span m="1470206">the</span> <span m="1470650">appropriate</span> <span m="1471240">capabilities</span> <span m="1471590">whenever they're needed.</span> <span m="1473160">So</span> <span m="1473290">when</span> <span m="1473410">you</span> <span m="1474170">have to access</span> <span m="1474450">the</span> <span m="1474660">output</span> <span m="1475140">file,</span> <span m="1475635">in the</span> <span m="1476130">statistics,</span> <span m="1476660">you</span> <span m="1476810">use</span> <span m="1477200">the</span> <span m="1477310">capability</span> <span m="1477980">[INAUDIBLE]</span> <span m="1478446">file.</span> <span m="1479378">But</span> <span m="1479844">when you're</span> <span m="1480780">accessing</span> <span m="1481240">the file you're about</span> <span m="1481700">to read,</span> <span m="1482320">you don't</span> <span m="1482781">use</span> <span m="1483242">that</span> <span m="1483703">capability.</span> </p>
<p><span m="1485090">PROFESSOR: Yeah.</span> <span m="1485380">So</span> <span m="1485460">I</span> <span m="1485560">guess</span> <span m="1485880">really</span> <span m="1486210">what</span> <span m="1486980">it boils</span> <span m="1487460">down to</span> <span m="1487610">is that</span> <span m="1487940">somehow</span> <span m="1488370">the</span> <span m="1488470">Fortran</span> <span m="1488940">compiler</span> <span m="1489710">should</span> <span m="1489990">just already</span> <span m="1490450">have</span> <span m="1490680">a file</span> <span m="1491210">descriptor</span> <span m="1491560">open</span> <span m="1492220">for</span> <span m="1492430">that</span> <span m="1492750">/sysx/stat</span> <span m="1493510">file.</span> <span m="1494280">So they don't really</span> <span m="1494730">describe,</span> <span m="1496360">in</span> <span m="1496580">their</span> <span m="1497030">short</span> <span m="1497290">paper,</span> <span m="1497660">about</span> <span m="1497930">how</span> <span m="1498240">we</span> <span m="1498350">don't get</span> <span m="1498680">that</span> <span m="1498960">capability.</span> </p>
<p><span m="1499950">But</span> <span m="1501040">it</span> <span m="1501530">basically</span> <span m="1501830">means you shouldn't</span> <span m="1502130">really pass</span> <span m="1502550">file</span> <span m="1502970">names</span> <span m="1503520">around.</span> <span m="1504250">You shouldn't set</span> <span m="1504480">past</span> <span m="1504710">file descriptors.</span> <span m="1505925">So you could</span> <span m="1506410">actually</span> <span m="1506900">come</span> <span m="1507070">up</span> <span m="1507210">with</span> <span m="1507300">a</span> <span m="1507530">perhaps</span> <span m="1507860">much</span> <span m="1508080">more</span> <span m="1508270">elegant</span> <span m="1508670">design</span> <span m="1509200">for</span> <span m="1510160">our</span> <span m="1510980">Unix</span> <span m="1511510">replacement</span> <span m="1511880">on</span> <span m="1512090">the</span> <span m="1512160">Fortran</span> <span m="1512540">compiler</span> <span m="1513360">using</span> <span m="1513720">capabilities.</span> <span m="1514290">So</span> <span m="1514590">maybe the plan is</span> <span m="1516050">we</span> <span m="1516170">should</span> <span m="1516500">just have</span> <span m="1517225">a</span> <span m="1518320">Fortran</span> <span m="1518730">compiler</span> <span m="1519530">front end</span> <span m="1520460">that doesn't have</span> <span m="1521030">any extra</span> <span m="1521390">privileges,</span> <span m="1522310">and</span> <span m="1522560">it takes</span> <span m="1522820">all</span> <span m="1522960">these</span> <span m="1523100">arguments</span> <span m="1523500">you</span> <span m="1523590">give</span> <span m="1523800">it,</span> <span m="1524380">and</span> <span m="1525160">converts</span> <span m="1525750">all</span> <span m="1526120">the</span> <span m="1526530">path names you</span> <span m="1527070">supply to</span> <span m="1527410">it into</span> <span m="1528540">open</span> <span m="1528830">file</span> <span m="1529030">descriptors.</span> </p>
<p><span m="1530340">So</span> <span m="1530920">the</span> <span m="1531490">alternative</span> <span m="1531900">design</span> <span m="1532250">I am</span> <span m="1532600">thinking of here</span> <span m="1533540">is</span> <span m="1534090">that</span> <span m="1534260">maybe</span> <span m="1534490">we'd</span> <span m="1534600">have</span> <span m="1535580">a</span> <span m="1535660">program</span> <span m="1536160">fort1,</span> <span m="1537010">which</span> <span m="1537180">is</span> <span m="1537270">the</span> <span m="1537350">front</span> <span m="1537680">end.</span> <span m="1538200">And</span> <span m="1538370">it</span> <span m="1538590">would take some sort of</span> <span m="1538860">a</span> <span m="1538950">file,</span> <span m="1539435">foo.f,</span> <span m="1540345">and</span> <span m="1540930">all the other</span> <span m="1541090">arguments,</span> <span m="1541850">-o,</span> <span m="1543540">whatever.</span> <span m="1545390">And</span> <span m="1547270">it</span> <span m="1547350">doesn't</span> <span m="1547550">actually</span> <span m="1547770">implement</span> <span m="1548080">any of the</span> <span m="1548430">compiler</span> <span m="1548470">logic,</span> <span m="1549330">anything</span> <span m="1549650">else.</span> <span m="1550020">All it</span> <span m="1550390">looks</span> <span m="1550650">for is</span> <span m="1551070">path</span> <span m="1551350">names</span> <span m="1551630">in its</span> <span m="1551820">arguments,</span> <span m="1552080">and it's</span> <span m="1552340">going</span> <span m="1552760">to</span> <span m="1552990">open</span> <span m="1553280">them</span> <span m="1553790">and</span> <span m="1554440">establish</span> <span m="1554870">file descriptors for</span> <span m="1555740">them.</span> </p>
<p></p>
<p><span m="1556490">And</span> <span m="1556660">the</span> <span m="1556730">cool</span> <span m="1556920">thing</span> <span m="1557130">is that,</span> <span m="1558000">because it has no</span> <span m="1558520">extra</span> <span m="1558830">privileges,</span> <span m="1559910">if</span> <span m="1560080">the</span> <span m="1560160">user</span> <span m="1560540">can't</span> <span m="1560970">have</span> <span m="1561220">access</span> <span m="1561570">to</span> <span m="1561670">some</span> <span m="1561880">file</span> <span m="1562190">name,</span> <span m="1562450">then</span> <span m="1562710">it</span> <span m="1562780">will</span> <span m="1562910">fail.</span> <span m="1563520">Those</span> <span m="1563710">are</span> <span m="1563900">great.</span> <span m="1564720">And then once</span> <span m="1565210">this</span> <span m="1565330">front end</span> <span m="1565625">has</span> <span m="1566180">opened</span> <span m="1566690">all</span> <span m="1566910">these</span> <span m="1567090">file</span> <span m="1567280">descriptors,</span> <span m="1567830">it can</span> <span m="1568550">execute</span> <span m="1569000">some</span> <span m="1569330">privileged</span> <span m="1570140">extra</span> <span m="1570470">component,</span> <span m="1570990">like</span> <span m="1571640">the</span> <span m="1571850">actual</span> <span m="1572320">setuid</span> <span m="1573450">Fortran</span> <span m="1573940">compiler.</span> <span m="1574500">So</span> <span m="1574590">maybe</span> <span m="1574865">then it'll</span> <span m="1575500">run</span> <span m="1575720">fort.</span> <span m="1576520">This guy's</span> <span m="1576960">maybe</span> <span m="1577220">setuid</span> <span m="1577710">to some</span> <span m="1578160">special</span> <span m="1578630">user ID</span> <span m="1578986">that has access to</span> <span m="1579700">the</span> <span m="1579830">stats</span> <span m="1580260">file.</span> <span m="1581230">But</span> <span m="1581600">it</span> <span m="1581680">doesn't</span> <span m="1581860">actually</span> <span m="1582070">accept</span> <span m="1582500">any</span> <span m="1582830">path names</span> <span m="1583320">as</span> <span m="1583420">input.</span> <span m="1583750">All it's</span> <span m="1584060">going</span> <span m="1584190">to</span> <span m="1584280">do</span> <span m="1584800">is</span> <span m="1584930">accept</span> <span m="1585340">file</span> <span m="1585817">descriptors.</span> </p>
<p><span m="1587250">And,</span> <span m="1587840">in</span> <span m="1587900">that</span> <span m="1588090">case,</span> <span m="1588400">the</span> <span m="1588840">file</span> <span m="1589050">descriptor</span> <span m="1589550">is</span> <span m="1589740">already</span> <span m="1590910">prove</span> <span m="1591590">that</span> <span m="1591710">the</span> <span m="1591830">caller</span> <span m="1592310">had</span> <span m="1592510">access</span> <span m="1592940">to</span> <span m="1593110">open</span> <span m="1593590">them.</span> <span m="1593980">Does</span> <span m="1594370">the</span> <span m="1594530">property make</span> <span m="1594780">sense?</span> <span m="1595845">So it</span> <span m="1596400">of course</span> <span m="1596610">doesn't</span> <span m="1596700">solve</span> <span m="1597240">every</span> <span m="1597520">issue.</span> <span m="1597800">I'm just sort of</span> <span m="1598240">sketching</span> <span m="1598700">out how</span> <span m="1599150">capabilities</span> <span m="1599630">might</span> <span m="1599830">help.</span> <span m="1600570">But</span> <span m="1600680">that's</span> <span m="1600930">roughly</span> <span m="1601330">the</span> <span m="1601460">plan,</span> <span m="1601960">is that</span> <span m="1602530">you</span> <span m="1602650">should</span> <span m="1603260">demonstrate</span> <span m="1603565">the fact</span> <span m="1603870">that</span> <span m="1604330">you</span> <span m="1604500">have</span> <span m="1604670">access</span> <span m="1605000">to</span> <span m="1605070">a</span> <span m="1605130">particular</span> <span m="1605490">name</span> <span m="1605760">by</span> <span m="1605890">just</span> <span m="1606150">opening</span> <span m="1606560">it</span> <span m="1606980">and</span> <span m="1607150">passing</span> <span m="1607490">a</span> <span m="1607610">capability,</span> <span m="1608500">instead</span> <span m="1608780">of</span> <span m="1608860">saying,</span> <span m="1609190">why</span> <span m="1609210">didn't</span> <span m="1609390">you</span> <span m="1609720">try</span> <span m="1609890">to</span> <span m="1609970">open</span> <span m="1610210">this</span> <span m="1610400">file</span> <span m="1611140">and</span> <span m="1611660">maybe</span> <span m="1612810">accidentally</span> <span m="1613030">use</span> <span m="1613220">some</span> <span m="1613580">extra</span> <span m="1613810">privileges.</span> <span m="1614490">Yes.</span> </p>
<p><span m="1614956">AUDIENCE: So</span> <span m="1615422">does this</span> <span m="1615888">generalize</span> <span m="1616354">to having</span> <span m="1616820">one</span> <span m="1617286">process</span> <span m="1617519">per</span> <span m="1617752">capability?</span> </p>
<p><span m="1619620">PROFESSOR: Does</span> <span m="1619770">this</span> <span m="1619990">generalize?</span> <span m="1620470">Well,</span> <span m="1620775">of course</span> <span m="1621170">you</span> <span m="1621250">can have as many</span> <span m="1621690">processes</span> <span m="1622060">as you want.</span> <span m="1622330">You</span> <span m="1622450">can have</span> <span m="1622660">multiple</span> <span m="1623040">processes per</span> <span m="1623480">capability,</span> <span m="1623990">but</span> <span m="1624600">I'm</span> <span m="1625010">not sure--</span> </p>
<p><span m="1625855">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="1632930">PROFESSOR: I'm still</span> <span m="1633670">not</span> <span m="1633800">sure what you</span> <span m="1634580">mean</span> <span m="1634890">by</span> <span m="1635540">one</span> <span m="1636070">property.</span> </p>
<p><span m="1636480">AUDIENCE: So we have</span> <span m="1636937">[INAUDIBLE]</span> <span m="1638308">capabilities</span> <span m="1638765">the user</span> <span m="1638927">has.</span> </p>
<p></p>
<p><span m="1640140">PROFESSOR: That's right.</span> </p>
<p><span m="1640800">AUDIENCE: And then</span> <span m="1641280">we have the</span> <span m="1641760">fort.s</span> <span m="1642240">access</span> <span m="1642520">to</span> <span m="1642975">this</span> <span m="1643202">past</span> <span m="1643430">file.</span> </p>
<p><span m="1644765">PROFESSOR: That's right.</span> <span m="1645210">Yeah.</span> <span m="1645470">So</span> <span m="1645680">the way to</span> <span m="1645890">think</span> <span m="1646090">of</span> <span m="1646160">it</span> <span m="1646530">is, you</span> <span m="1646610">don't</span> <span m="1646720">necessarily</span> <span m="1647110">need</span> <span m="1647260">a</span> <span m="1647630">separate</span> <span m="1648300">process</span> <span m="1649480">for</span> <span m="1650320">every</span> <span m="1650810">capability.</span> <span m="1651516">Because</span> <span m="1652220">here,</span> <span m="1652510">the</span> <span m="1652765">fort1</span> <span m="1653020">thing</span> <span m="1653400">might</span> <span m="1654030">open</span> <span m="1654300">many</span> <span m="1654640">files</span> <span m="1655140">and</span> <span m="1655220">might</span> <span m="1655370">pass</span> <span m="1655740">many</span> <span m="1656190">capabilities</span> <span m="1657260">to</span> <span m="1657730">the privileged</span> <span m="1658035">fort</span> <span m="1658590">component.</span> <span m="1660590">The</span> <span m="1660690">problem</span> <span m="1661020">here--</span> <span m="1661440">the</span> <span m="1661610">reason</span> <span m="1661810">that</span> <span m="1661880">this</span> <span m="1662060">might</span> <span m="1662320">seem</span> <span m="1662510">like</span> <span m="1662690">you</span> <span m="1662800">want</span> <span m="1663040">a</span> <span m="1663090">separate</span> <span m="1663560">process</span> <span m="1664030">for</span> <span m="1664640">every</span> <span m="1665090">capability</span> <span m="1666070">is</span> <span m="1666270">that</span> <span m="1668080">we're</span> <span m="1668440">sort</span> <span m="1668560">of</span> <span m="1668770">dealing</span> <span m="1669090">with</span> <span m="1669230">this</span> <span m="1669380">weird</span> <span m="1669730">interface</span> <span m="1670290">between</span> <span m="1670670">capabilities</span> <span m="1671010">and</span> <span m="1671350">ambient</span> <span m="1671980">privileges.</span> </p>
<p><span m="1672450">Because</span> <span m="1672770">fort1</span> <span m="1673600">sort of does</span> <span m="1673910">have</span> <span m="1674210">ambient</span> <span m="1674440">privilege.</span> <span m="1675310">And</span> <span m="1675420">what we're</span> <span m="1675680">doing</span> <span m="1675930">is</span> <span m="1676000">basically we're</span> <span m="1676310">converting</span> <span m="1676750">this</span> <span m="1676900">ambient</span> <span m="1677160">privilege</span> <span m="1678060">into</span> <span m="1678340">capabilities</span> <span m="1679100">in</span> <span m="1679250">this</span> <span m="1679350">fort1</span> <span m="1679850">process.</span> <span m="1680890">So if you have</span> <span m="1681330">multiple</span> <span m="1681860">different</span> <span m="1682260">kinds</span> <span m="1682580">of</span> <span m="1682680">ambient</span> <span m="1683020">privilege,</span> <span m="1683620">or</span> <span m="1683760">multiple</span> <span m="1684200">different</span> <span m="1684780">privileges</span> <span m="1685035">that</span> <span m="1685380">you</span> <span m="1685480">want</span> <span m="1685640">to</span> <span m="1685720">carefully</span> <span m="1686190">use,</span> <span m="1686960">then</span> <span m="1687320">maybe what</span> <span m="1687450">you</span> <span m="1687540">want</span> <span m="1687730">is</span> <span m="1687810">a</span> <span m="1687870">separate</span> <span m="1688240">process</span> <span m="1688730">holding</span> <span m="1689240">that</span> <span m="1689490">privilege.</span> <span m="1690360">And</span> <span m="1690670">whenever</span> <span m="1690810">you</span> <span m="1691020">want</span> <span m="1691230">to</span> <span m="1691330">use</span> <span m="1691500">a</span> <span m="1691670">particular</span> <span m="1692100">set</span> <span m="1692240">of</span> <span m="1692330">privileges,</span> <span m="1692820">you'll ask the</span> <span m="1693420">corresponding</span> <span m="1694010">process</span> <span m="1694520">to</span> <span m="1695040">please perform a</span> <span m="1695900">separation.</span> <span m="1696800">And</span> <span m="1696910">if</span> <span m="1696980">it</span> <span m="1697230">succeeds,</span> <span m="1697565">give</span> <span m="1697648">me</span> <span m="1697732">back</span> <span m="1697816">the</span> <span m="1697900">capability.</span> </p>
<p><span m="1699120">So</span> <span m="1699220">that's</span> <span m="1699400">maybe</span> <span m="1699710">one</span> <span m="1700170">way</span> <span m="1700380">to</span> <span m="1700660">think</span> <span m="1700790">of this.</span> <span m="1704000">There's</span> <span m="1704260">been actually</span> <span m="1704500">some</span> <span m="1705430">operating</span> <span m="1705770">system</span> <span m="1706160">designs that are</span> <span m="1706690">entirely</span> <span m="1707410">capability-based,</span> <span m="1707970">there</span> <span m="1708130">are</span> <span m="1708460">no</span> <span m="1709820">ambient</span> <span m="1710300">privileges</span> <span m="1710770">whatsoever.</span> <span m="1711570">And it's kind of cool.</span> <span m="1712480">Unfortunately,</span> <span m="1713170">it's</span> <span m="1713990">more</span> <span m="1714240">of</span> <span m="1714580">sort of an</span> <span m="1714870">interesting</span> <span m="1715530">reading</span> <span m="1716010">experience.</span> <span m="1716460">Like oh,</span> <span m="1716860">yeah, you can</span> <span m="1717610">do it.</span> <span m="1717905">That's pretty cool.</span> <span m="1718920">But</span> <span m="1719420">it's</span> <span m="1719670">probably</span> <span m="1720140">not</span> <span m="1720550">really</span> <span m="1721080">practical</span> <span m="1722160">to</span> <span m="1722270">use</span> <span m="1722680">in a</span> <span m="1723620">real</span> <span m="1723890">system,</span> <span m="1724440">unfortunately.</span> <span m="1725540">It turns out</span> <span m="1726080">that you</span> <span m="1726190">really</span> <span m="1726370">do</span> <span m="1726600">want</span> <span m="1727830">not</span> <span m="1728000">so</span> <span m="1728080">much</span> <span m="1728300">ambient</span> <span m="1728750">privilege</span> <span m="1729260">but</span> <span m="1729510">being</span> <span m="1729750">able</span> <span m="1729990">to</span> <span m="1730140">name</span> <span m="1730560">an</span> <span m="1730660">object</span> <span m="1731200">and</span> <span m="1731380">tell</span> <span m="1731590">someone</span> <span m="1731890">about</span> <span m="1732170">an</span> <span m="1732270">object</span> <span m="1732630">without</span> <span m="1733230">conveying</span> <span m="1733810">necessarily the</span> <span m="1734270">rights to</span> <span m="1734590">that</span> <span m="1734800">object.</span> </p>
<p><span m="1736060">So</span> <span m="1736140">maybe</span> <span m="1736400">I</span> <span m="1736480">don't</span> <span m="1736720">know</span> <span m="1736970">what</span> <span m="1737200">privileges</span> <span m="1737670">you</span> <span m="1737800">might</span> <span m="1738090">have</span> <span m="1738730">over</span> <span m="1739530">some</span> <span m="1739730">shared</span> <span m="1740050">document,</span> <span m="1740440">but</span> <span m="1740560">I do want</span> <span m="1740730">to tell you,</span> <span m="1741010">hey,</span> <span m="1741370">well,</span> <span m="1741570">there's</span> <span m="1741760">a</span> <span m="1741820">shared</span> <span m="1742080">document.</span> <span m="1742890">If you can</span> <span m="1743260">read</span> <span m="1743470">it,</span> <span m="1743680">read</span> <span m="1743860">it.</span> <span m="1744230">If you write it,</span> <span m="1744450">great,</span> <span m="1744620">write it.</span> <span m="1745260">But</span> <span m="1745700">I</span> <span m="1745810">don't</span> <span m="1745950">want</span> <span m="1746200">to</span> <span m="1746250">necessarily</span> <span m="1746560">convey</span> <span m="1747160">any</span> <span m="1747390">rights.</span> <span m="1747830">I</span> <span m="1747880">just</span> <span m="1748030">want</span> <span m="1748120">to</span> <span m="1748190">tell you,</span> <span m="1748340">hey,</span> <span m="1748450">there's</span> <span m="1748597">this</span> <span m="1748745">thing,</span> <span m="1749310">go</span> <span m="1749690">try it.</span> <span m="1750960">So it's</span> <span m="1751160">a</span> <span m="1751540">bit of a bummer</span> <span m="1751810">in a</span> <span m="1752080">capability</span> <span m="1753140">world</span> <span m="1753540">that it</span> <span m="1753760">really</span> <span m="1754340">forces</span> <span m="1754940">you</span> <span m="1755090">to</span> <span m="1755530">never</span> <span m="1756600">talk</span> <span m="1756930">about</span> <span m="1757200">objects</span> <span m="1757760">without</span> <span m="1758270">conveying</span> <span m="1758730">rights</span> <span m="1759210">to that</span> <span m="1759360">object.</span> </p>
<p><span m="1761050">So</span> <span m="1763010">it's</span> <span m="1763285">an</span> <span m="1763560">important</span> <span m="1763950">idea</span> <span m="1764210">to</span> <span m="1764310">know</span> <span m="1764530">about,</span> <span m="1764910">and</span> <span m="1765060">to</span> <span m="1765130">use</span> <span m="1765420">it</span> <span m="1765570">in</span> <span m="1766070">some</span> <span m="1766320">parts</span> <span m="1766610">of</span> <span m="1766700">a</span> <span m="1766840">system,</span> <span m="1767240">but</span> <span m="1768220">probably</span> <span m="1768490">not</span> <span m="1768920">the</span> <span m="1769130">be all end all</span> <span m="1769800">solution</span> <span m="1770115">to security,</span> <span m="1770430">much like</span> <span m="1771260">almost anything else</span> <span m="1771720">[INAUDIBLE]</span> <span m="1771930">about</span> <span m="1772255">here.</span> <span m="1773472">Make sense?</span> <span m="1773918">Yeah?</span> </p>
<p><span m="1774810">AUDIENCE: So</span> <span m="1775145">if</span> <span m="1775480">the</span> <span m="1775580">process</span> <span m="1776030">has</span> <span m="1776520">capabilities</span> <span m="1777150">given to it</span> <span m="1777720">by</span> <span m="1779130">some other</span> <span m="1779570">process,</span> <span m="1780120">and</span> <span m="1780535">it happens to</span> <span m="1780950">already have the</span> <span m="1781365">capability</span> <span m="1781780">to</span> <span m="1781950">that</span> <span m="1782500">object,</span> <span m="1783040">that's</span> <span m="1783550">greater.</span> <span m="1784280">Can</span> <span m="1784550">it compare them</span> <span m="1784820">to make sure that they're about</span> <span m="1784930">the</span> <span m="1786170">same</span> <span m="1786370">object?</span> <span m="1786740">Or will it just</span> <span m="1787085">use</span> <span m="1787430">the one that's</span> <span m="1787730">greater?</span> </p>
<p><span m="1788420">PROFESSOR: So</span> <span m="1788740">the thing</span> <span m="1789100">is</span> <span m="1789210">that a</span> <span m="1789610">process</span> <span m="1790240">doesn't</span> <span m="1790440">implicitly</span> <span m="1790895">use</span> <span m="1791530">the</span> <span m="1791630">capabilities.</span> <span m="1792130">So that's</span> <span m="1792290">the</span> <span m="1792410">cool</span> <span m="1792610">thing</span> <span m="1792770">about</span> <span m="1793000">capabilities.</span> <span m="1793400">You have to</span> <span m="1793620">explicitly</span> <span m="1794060">name</span> <span m="1794400">which</span> <span m="1794570">one</span> <span m="1794790">you're</span> <span m="1794980">using.</span> <span m="1795760">So</span> <span m="1795880">think</span> <span m="1796040">of it</span> <span m="1796180">in</span> <span m="1796250">terms</span> <span m="1796460">of</span> <span m="1796620">file</span> <span m="1796870">descriptors.</span> <span m="1797680">Suppose</span> <span m="1798020">that</span> <span m="1798640">I</span> <span m="1798770">give</span> <span m="1799000">you</span> <span m="1799320">an</span> <span m="1799500">open</span> <span m="1799820">file</span> <span m="1800040">descriptor</span> <span m="1800470">for</span> <span m="1800640">some</span> <span m="1800920">file,</span> <span m="1801820">and</span> <span m="1802080">it's</span> <span m="1802220">read</span> <span m="1802520">only.</span> <span m="1803040">And</span> <span m="1803140">then</span> <span m="1803170">someone</span> <span m="1803490">else</span> <span m="1803640">gives</span> <span m="1803810">you</span> <span m="1803950">another</span> <span m="1804290">capability</span> <span m="1804890">for</span> <span m="1805170">some</span> <span m="1805400">other--</span> <span m="1805680">maybe</span> <span m="1805970">the</span> <span m="1806070">same filem</span> <span m="1806490">maybe a</span> <span m="1806730">different</span> <span m="1807000">file,</span> <span m="1807430">and it's</span> <span m="1807710">read/write.</span> </p>
<p><span m="1808760">It's</span> <span m="1808950">not</span> <span m="1809350">all of a</span> <span m="1809640">sudden</span> <span m="1809970">that</span> <span m="1810100">if</span> <span m="1810220">you're</span> <span m="1810390">trying</span> <span m="1810860">to</span> <span m="1811140">write</span> <span m="1811730">to</span> <span m="1811860">the</span> <span m="1811970">first</span> <span m="1812470">file</span> <span m="1812670">descriptor</span> <span m="1813070">you</span> <span m="1813120">had that was</span> <span m="1813600">read</span> <span m="1813800">only,</span> <span m="1814310">all of a sudden</span> <span m="1814660">those</span> <span m="1814990">will</span> <span m="1815130">start</span> <span m="1815470">succeeding</span> <span m="1816060">because</span> <span m="1816310">you</span> <span m="1816390">have</span> <span m="1816560">this</span> <span m="1816700">extra</span> <span m="1817100">writeable</span> <span m="1817630">file</span> <span m="1817880">descriptor</span> <span m="1818300">open.</span> <span m="1819270">So</span> <span m="1820670">that's sort of</span> <span m="1821010">the</span> <span m="1821130">cool</span> <span m="1821350">thing.</span> <span m="1821560">You</span> <span m="1821690">don't</span> <span m="1821950">want</span> <span m="1822250">this</span> <span m="1822390">ambient</span> <span m="1822690">privilege.</span> <span m="1822990">Because</span> <span m="1823520">if</span> <span m="1823620">you</span> <span m="1823720">think</span> <span m="1823940">of</span> <span m="1824020">these</span> <span m="1824220">capabilities</span> <span m="1824920">as</span> <span m="1825360">a</span> <span m="1825430">bunch</span> <span m="1825670">of</span> <span m="1825780">privileges</span> <span m="1826090">that</span> <span m="1826480">just</span> <span m="1826710">keep</span> <span m="1826860">accumulating</span> <span m="1827245">in</span> <span m="1827630">your</span> <span m="1827770">process,</span> <span m="1828380">then you'll</span> <span m="1828980">actually</span> <span m="1829250">just</span> <span m="1829450">end</span> <span m="1829610">up</span> <span m="1829860">with</span> <span m="1830090">ambient</span> <span m="1830280">privilege</span> <span m="1830600">again.</span> <span m="1830690">You just</span> <span m="1831110">have</span> <span m="1831290">all</span> <span m="1831530">these</span> <span m="1831710">magic</span> <span m="1832010">capabilities,</span> <span m="1833060">and</span> <span m="1833310">people</span> <span m="1833560">have actually</span> <span m="1833770">built</span> <span m="1834210">such</span> <span m="1834510">libraries.</span> <span m="1834765">Basically,</span> <span m="1835370">well, they</span> <span m="1835840">manage your</span> <span m="1836310">capabilities</span> <span m="1836840">for</span> <span m="1837150">you.</span> <span m="1837380">They sort of</span> <span m="1837540">collect</span> <span m="1837920">them.</span> <span m="1838280">And</span> <span m="1838410">when you</span> <span m="1838610">try</span> <span m="1838800">to</span> <span m="1838900">perform</span> <span m="1839170">an</span> <span m="1839240">operation,</span> <span m="1839680">they</span> <span m="1839780">look for the</span> <span m="1839950">capabilities</span> <span m="1840150">and</span> <span m="1840440">find</span> <span m="1840670">the one</span> <span m="1841080">that'll</span> <span m="1841270">make</span> <span m="1841430">it</span> <span m="1841530">work.</span> </p>
<p><span m="1842310">That</span> <span m="1842450">exactly</span> <span m="1842720">brings</span> <span m="1842990">you</span> <span m="1843200">back</span> <span m="1843410">to</span> <span m="1843530">this ambient</span> <span m="1844060">authority</span> <span m="1844500">that you</span> <span m="1844600">were</span> <span m="1845110">trying</span> <span m="1845260">to</span> <span m="1845360">avoid.</span> <span m="1845890">So</span> <span m="1846090">the</span> <span m="1846340">cool</span> <span m="1846540">thing</span> <span m="1846680">about</span> <span m="1846930">capabilities</span> <span m="1847030">is that</span> <span m="1848280">it's</span> <span m="1848710">almost</span> <span m="1848990">like</span> <span m="1849100">a</span> <span m="1849180">programming</span> <span m="1850000">construct,</span> <span m="1850670">where</span> <span m="1851210">it</span> <span m="1851320">makes</span> <span m="1851530">it</span> <span m="1851700">easy</span> <span m="1852080">for</span> <span m="1852240">you--</span> <span m="1852670">which is</span> <span m="1853120">a</span> <span m="1853400">rare thing in</span> <span m="1853680">security--</span> <span m="1853980">it</span> <span m="1854280">makes</span> <span m="1854480">it</span> <span m="1854620">easier</span> <span m="1854875">for you</span> <span m="1855130">to</span> <span m="1855290">write</span> <span m="1855630">code</span> <span m="1855990">that</span> <span m="1856380">specifies</span> <span m="1857130">exactly</span> <span m="1857760">what</span> <span m="1857960">privileges</span> <span m="1858320">you</span> <span m="1858410">want</span> <span m="1858510">to</span> <span m="1858560">do</span> <span m="1858720">from</span> <span m="1858840">a</span> <span m="1858890">security</span> <span m="1859200">standpoint.</span> <span m="1859680">And it's</span> <span m="1860025">actually a</span> <span m="1860370">fairly natural</span> <span m="1861020">code to</span> <span m="1861250">write.</span> </p>
<p><span m="1862570">So</span> <span m="1862710">if</span> <span m="1862820">you</span> <span m="1863000">get</span> <span m="1863200">into that</span> <span m="1863610">mindset</span> <span m="1864050">of</span> <span m="1864250">always</span> <span m="1864650">carrying</span> <span m="1864970">around</span> <span m="1865280">this</span> <span m="1865550">privilege</span> <span m="1866020">with</span> <span m="1866260">the</span> <span m="1866610">object</span> <span m="1866960">you're accessing,</span> <span m="1867450">it seems like a cool</span> <span m="1867590">thing</span> <span m="1868080">to</span> <span m="1868200">do.</span> <span m="1869210">It doesn't</span> <span m="1869570">always</span> <span m="1869640">make</span> <span m="1869900">sense,</span> <span m="1870080">but</span> <span m="1870330">sometimes it does.</span> <span m="1872750">Any</span> <span m="1872900">other</span> <span m="1873290">questions?</span> <span m="1876070">OK.</span> </p>
<p><span m="1876640">So</span> <span m="1878240">that's</span> <span m="1878620">more</span> <span m="1878940">on</span> <span m="1879040">the</span> <span m="1879660">ambient</span> <span m="1879720">authority</span> <span m="1880150">that</span> <span m="1880410">we've</span> <span m="1880690">look</span> <span m="1880920">at</span> <span m="1881100">here.</span> <span m="1881730">It turns out</span> <span m="1882220">that</span> <span m="1882470">capabilities</span> <span m="1883030">are</span> <span m="1883140">also</span> <span m="1883640">great</span> <span m="1884010">for</span> <span m="1884810">other</span> <span m="1885290">problems,</span> <span m="1885630">as</span> <span m="1885750">well.</span> <span m="1886100">And</span> <span m="1886630">in</span> <span m="1886760">particular,</span> <span m="1887880">the</span> <span m="1888020">problem</span> <span m="1888530">of</span> <span m="1888710">managing</span> <span m="1889210">privileges</span> <span m="1890000">often</span> <span m="1890380">shows</span> <span m="1890750">up</span> <span m="1891220">when</span> <span m="1891390">you</span> <span m="1891500">want</span> <span m="1891630">to</span> <span m="1891810">run</span> <span m="1892160">some</span> <span m="1892620">untrustworthy</span> <span m="1893430">code.</span> <span m="1893700">Because</span> <span m="1893950">you</span> <span m="1894040">want</span> <span m="1894190">to</span> <span m="1894540">really</span> <span m="1894770">control</span> <span m="1895370">which</span> <span m="1895640">privileges</span> <span m="1896000">you</span> <span m="1896210">give</span> <span m="1896500">it,</span> <span m="1896960">because</span> <span m="1897160">you</span> <span m="1897280">think</span> <span m="1897460">it will</span> <span m="1897670">misuse</span> <span m="1897870">any</span> <span m="1898350">privileges</span> <span m="1898470">you</span> <span m="1898620">give</span> <span m="1898790">it</span> <span m="1899050">at</span> <span m="1899120">all.</span> </p>
<p><span m="1900590">And</span> <span m="1901520">this</span> <span m="1901670">is</span> <span m="1902250">the</span> <span m="1902760">slightly</span> <span m="1903100">different</span> <span m="1903540">point</span> <span m="1903740">of</span> <span m="1903880">view</span> <span m="1904150">from</span> <span m="1904510">which</span> <span m="1905150">the</span> <span m="1905400">authors</span> <span m="1905800">of</span> <span m="1906000">the</span> <span m="1906130">Capsicum</span> <span m="1906560">paper</span> <span m="1906960">are</span> <span m="1907220">coming</span> <span m="1909010">at</span> <span m="1909270">capabilities.</span> <span m="1910640">So</span> <span m="1910920">they're</span> <span m="1911260">of course</span> <span m="1912060">clearly</span> <span m="1912760">aware of this</span> <span m="1913190">ambient</span> <span m="1913540">authority</span> <span m="1913950">problem,</span> <span m="1914270">but it's sort of</span> <span m="1914590">a</span> <span m="1914710">different</span> <span m="1915050">problem</span> <span m="1915450">that</span> <span m="1915500">you</span> <span m="1916010">might</span> <span m="1916250">or might not</span> <span m="1916550">care</span> <span m="1916680">about</span> <span m="1916920">solving.</span> <span m="1917720">But</span> <span m="1918740">the</span> <span m="1919110">particular</span> <span m="1919370">thing they</span> <span m="1919910">really</span> <span m="1920180">care</span> <span m="1920410">about</span> <span m="1920960">is</span> <span m="1921630">they</span> <span m="1921760">have</span> <span m="1922180">a</span> <span m="1922310">really</span> <span m="1922710">large</span> <span m="1923420">privileged</span> <span m="1924000">application,</span> <span m="1924860">and</span> <span m="1925020">they</span> <span m="1925120">worry</span> <span m="1925650">that</span> <span m="1925830">there's</span> <span m="1926030">going</span> <span m="1926150">to</span> <span m="1926190">be</span> <span m="1926290">bugs</span> <span m="1926890">in</span> <span m="1927040">different</span> <span m="1927450">parts</span> <span m="1927760">of</span> <span m="1927930">that</span> <span m="1928170">application</span> <span m="1929310">source</span> <span m="1929650">code.</span> <span m="1930480">So</span> <span m="1930900">they</span> <span m="1931030">would</span> <span m="1931180">like</span> <span m="1931540">to</span> <span m="1931970">reduce</span> <span m="1932340">the</span> <span m="1932440">privileges</span> <span m="1932900">of</span> <span m="1933030">different</span> <span m="1933350">components</span> <span m="1934060">of</span> <span m="1934990">that</span> <span m="1935110">application.</span> </p>
<p><span m="1936380">So</span> <span m="1936510">in that sense,</span> <span m="1936860">the</span> <span m="1937210">story is</span> <span m="1938590">very</span> <span m="1938790">similar</span> <span m="1939590">to</span> <span m="1939970">OKWS.</span> <span m="1940480">So</span> <span m="1941690">you</span> <span m="1941890">have--</span> <span m="1943500">for</span> <span m="1943910">sandboxing,</span> <span m="1944670">you have</span> <span m="1944960">some</span> <span m="1945030">large</span> <span m="1945380">application,</span> <span m="1946000">you</span> <span m="1946100">break</span> <span m="1946450">it up into</span> <span m="1946710">components,</span> <span m="1947000">and you</span> <span m="1947290">will</span> <span m="1947510">limit</span> <span m="1947780">what</span> <span m="1948000">privileges</span> <span m="1948890">each</span> <span m="1949080">component</span> <span m="1949490">has.</span> <span m="1950680">So</span> <span m="1950800">where does this</span> <span m="1951110">make</span> <span m="1951280">sense?</span> <span m="1951520">Like</span> <span m="1951700">OKWS</span> <span m="1951920">is</span> <span m="1952350">clearly</span> <span m="1952660">one</span> <span m="1952820">example.</span> <span m="1954140">What</span> <span m="1954330">are</span> <span m="1954420">other</span> <span m="1954930">situations</span> <span m="1955510">where</span> <span m="1955650">you</span> <span m="1955720">might</span> <span m="1956010">care</span> <span m="1956240">about</span> <span m="1957620">prileged</span> <span m="1957860">separation?</span> <span m="1960280">Well, I guess</span> <span m="1960420">in</span> <span m="1960530">the</span> <span m="1960640">paper</span> <span m="1960920">they</span> <span m="1961040">describe</span> <span m="1962770">the</span> <span m="1963050">examples</span> <span m="1963480">I</span> <span m="1963740">actually</span> <span m="1963880">got</span> <span m="1964050">to</span> <span m="1964130">run.</span> </p>
<p><span m="1964540">So</span> <span m="1964770">things</span> <span m="1964980">like</span> <span m="1965240">tcpdump</span> <span m="1966350">and</span> <span m="1967370">other</span> <span m="1967700">applications</span> <span m="1968320">that</span> <span m="1968610">parse</span> <span m="1969040">network</span> <span m="1969420">data.</span> <span m="1970285">So why</span> <span m="1970540">do</span> <span m="1970760">they</span> <span m="1971940">worry</span> <span m="1972160">so</span> <span m="1972460">much</span> <span m="1972810">about</span> <span m="1973380">applications</span> <span m="1973890">that</span> <span m="1974040">parse</span> <span m="1974520">network</span> <span m="1974780">inputs?</span> <span m="1976000">What</span> <span m="1976800">goes</span> <span m="1977000">wrong</span> <span m="1977200">in</span> <span m="1977520">tcpdump?</span> <span m="1977580">Why are they so</span> <span m="1977740">paranoid?</span> </p>
<p><span m="1978656">AUDIENCE: Well,</span> <span m="1979132">an attacker</span> <span m="1980084">can</span> <span m="1980560">control what's being sent</span> <span m="1981036">and what's being</span> <span m="1981512">called.</span> </p>
<p><span m="1981988">PROFESSOR: Yeah.</span> <span m="1982470">I</span> <span m="1982560">think</span> <span m="1982730">what</span> <span m="1982860">they</span> <span m="1982970">really</span> <span m="1983200">worry</span> <span m="1983440">about</span> <span m="1983670">is,</span> <span m="1984020">very</span> <span m="1984140">much</span> <span m="1984280">like</span> <span m="1984390">with</span> <span m="1984600">OKWS,</span> <span m="1985000">they</span> <span m="1985090">worry</span> <span m="1985290">about</span> <span m="1985480">that</span> <span m="1985550">attack</span> <span m="1985920">surface</span> <span m="1986410">and</span> <span m="1986510">how</span> <span m="1987060">much</span> <span m="1987390">can an</span> <span m="1987610">attacker</span> <span m="1987860">really</span> <span m="1988110">control</span> <span m="1988520">the inputs?</span> <span m="1988900">And</span> <span m="1989340">with</span> <span m="1989550">these</span> <span m="1989740">network</span> <span m="1990360">parsing</span> <span m="1991410">programs,</span> <span m="1991970">there's</span> <span m="1992170">a</span> <span m="1992240">lot</span> <span m="1992770">of</span> <span m="1992880">control</span> <span m="1993300">that</span> <span m="1993766">that factor</span> <span m="1994232">has.</span> <span m="1994698">They have the exact packet.</span> </p>
<p><span m="1996100">And</span> <span m="1996360">the</span> <span m="1996480">reason</span> <span m="1996850">that</span> <span m="1997550">this was</span> <span m="1997740">so</span> <span m="1998040">problematic</span> <span m="1998355">is</span> <span m="1998670">that if</span> <span m="1998920">you're</span> <span m="1999100">writing</span> <span m="1999920">code</span> <span m="2000420">in</span> <span m="2000690">C</span> <span m="2001240">that</span> <span m="2001400">has</span> <span m="2001680">to</span> <span m="2002070">parse</span> <span m="2002550">data</span> <span m="2002810">structures,</span> <span m="2003115">you're</span> <span m="2003560">presumably</span> <span m="2003920">going</span> <span m="2004060">to</span> <span m="2004110">do</span> <span m="2004260">lots of</span> <span m="2004570">pointer</span> <span m="2005000">manipulations,</span> <span m="2006100">copying</span> <span m="2006550">bites</span> <span m="2006930">into</span> <span m="2007130">arrays,</span> <span m="2007580">allocating</span> <span m="2008030">memory.</span> <span m="2008830">And</span> <span m="2009140">as</span> <span m="2009270">you</span> <span m="2009490">are</span> <span m="2009660">now</span> <span m="2009860">experts,</span> <span m="2010290">this is</span> <span m="2010510">super</span> <span m="2011070">fragile.</span> <span m="2012450">And</span> <span m="2012890">you can</span> <span m="2013000">easily</span> <span m="2013760">have</span> <span m="2014090">memory</span> <span m="2014310">management</span> <span m="2014750">errors that</span> <span m="2015000">lead</span> <span m="2015380">to</span> <span m="2015640">pretty</span> <span m="2016030">disastrous</span> <span m="2016970">consequences.</span> <span m="2018320">So</span> <span m="2018460">this is the</span> <span m="2018620">reason</span> <span m="2018850">why</span> <span m="2019010">they're</span> <span m="2019530">very</span> <span m="2019810">excited</span> <span m="2020160">about</span> <span m="2020830">sandboxing</span> <span m="2021580">various</span> <span m="2022540">network</span> <span m="2023020">protocol,</span> <span m="2023990">parsing</span> <span m="2024430">things,</span> <span m="2024810">et</span> <span m="2025180">cetera.</span> </p>
<p><span m="2025790">Another</span> <span m="2026030">probably</span> <span m="2026680">real</span> <span m="2026880">world</span> <span m="2027530">instance</span> <span m="2027850">where</span> <span m="2028000">you</span> <span m="2028120">really</span> <span m="2028350">care</span> <span m="2028510">about</span> <span m="2028670">this is</span> <span m="2028870">in</span> <span m="2029090">your</span> <span m="2029210">browser.</span> <span m="2030160">You</span> <span m="2030250">probably</span> <span m="2030520">want</span> <span m="2030690">to</span> <span m="2030750">sandbox</span> <span m="2031270">your</span> <span m="2031360">Flash</span> <span m="2031715">plug-in,</span> <span m="2032070">or</span> <span m="2032480">your</span> <span m="2032770">Java</span> <span m="2033630">extension,</span> <span m="2034410">or</span> <span m="2034520">whatnot.</span> <span m="2034960">Because</span> <span m="2035190">they're</span> <span m="2035450">pretty</span> <span m="2036060">large</span> <span m="2036350">attack</span> <span m="2036570">surfaces</span> <span m="2036970">as</span> <span m="2037100">well</span> <span m="2037540">that have</span> <span m="2037960">gotten</span> <span m="2038430">exploited</span> <span m="2039500">pretty</span> <span m="2039690">aggressively.</span> </p>
<p><span m="2041600">So</span> <span m="2042040">it seems</span> <span m="2042160">like</span> <span m="2042240">a</span> <span m="2042330">reasonable plan.</span> <span m="2042810">Like if</span> <span m="2042900">you're</span> <span m="2043160">writing</span> <span m="2043490">some piece of</span> <span m="2043880">software,</span> <span m="2044260">you</span> <span m="2044360">want</span> <span m="2044520">to</span> <span m="2044590">sandbox</span> <span m="2045130">different</span> <span m="2045390">components</span> <span m="2045880">of</span> <span m="2045960">it.</span> <span m="2046980">What about</span> <span m="2047250">more</span> <span m="2047450">generally,</span> <span m="2047870">if you</span> <span m="2048179">download</span> <span m="2048489">something</span> <span m="2048790">from</span> <span m="2048929">the</span> <span m="2049000">internet,</span> <span m="2049409">and</span> <span m="2049500">you</span> <span m="2049580">want</span> <span m="2049719">to</span> <span m="2050080">run</span> <span m="2050370">it</span> <span m="2050489">with</span> <span m="2050730">fewer</span> <span m="2051360">privileges?</span> <span m="2052889">Is</span> <span m="2053100">this sort of</span> <span m="2053429">Capsicum</span> <span m="2053550">style</span> <span m="2054500">isolation</span> <span m="2054770">a</span> <span m="2055040">good</span> <span m="2055219">plan</span> <span m="2055570">for</span> <span m="2055690">that?</span> <span m="2056989">I could</span> <span m="2057190">download</span> <span m="2057650">some</span> <span m="2057730">random</span> <span m="2058080">screensaver</span> <span m="2058534">or</span> <span m="2058989">some</span> <span m="2059150">game</span> <span m="2059500">from</span> <span m="2059650">the</span> <span m="2059719">internet.</span> <span m="2060290">And</span> <span m="2060610">I want to run</span> <span m="2060909">it on</span> <span m="2061080">my</span> <span m="2061179">computer,</span> <span m="2061590">and</span> <span m="2061880">I want to make</span> <span m="2062040">sure</span> <span m="2062190">it</span> <span m="2062260">doesn't</span> <span m="2062960">screw</span> <span m="2063240">up whatever</span> <span m="2063520">I have</span> <span m="2064139">laying</span> <span m="2064414">around.</span> </p>
<p><span m="2068040">Would</span> <span m="2068170">you</span> <span m="2068420">use</span> <span m="2068650">Capsicum?</span> <span m="2068760">Would</span> <span m="2069120">this</span> <span m="2069395">be</span> <span m="2069532">a</span> <span m="2069670">good</span> <span m="2069909">plan?</span> <span m="2071588">Yeah?</span> </p>
<p><span m="2073046">AUDIENCE: You could</span> <span m="2073532">write</span> <span m="2074018">a</span> <span m="2074504">sandboxing</span> <span m="2074990">program,</span> <span m="2075476">which</span> <span m="2076934">you'd use</span> <span m="2077420">Capsicum</span> <span m="2077906">to</span> <span m="2078149">sandbox</span> <span m="2078392">[INAUDIBLE].</span> </p>
<p><span m="2082780">PROFESSOR: Right.</span> <span m="2083360">You</span> <span m="2083610">could</span> <span m="2083860">try</span> <span m="2084120">to</span> <span m="2084409">use</span> <span m="2084850">Capsicum.</span> <span m="2084900">So how would</span> <span m="2085159">you use</span> <span m="2085409">Capsicum?</span> <span m="2085719">Well, you'd</span> <span m="2086030">just</span> <span m="2086400">enter into the</span> <span m="2086960">sandbox</span> <span m="2087560">mode</span> <span m="2087949">with</span> <span m="2088426">cap_enter.</span> <span m="2089380">And</span> <span m="2089670">then</span> <span m="2090710">you</span> <span m="2090860">run</span> <span m="2091050">the program.</span> <span m="2093330">Would you</span> <span m="2093440">expect</span> <span m="2093780">it</span> <span m="2094110">to</span> <span m="2094179">work?</span> <span m="2097040">I guess</span> <span m="2097480">the problem</span> <span m="2097780">is that if</span> <span m="2098000">the</span> <span m="2098410">program</span> <span m="2098750">wasn't</span> <span m="2099020">really</span> <span m="2099220">expecting</span> <span m="2099830">to</span> <span m="2099900">be</span> <span m="2100030">sandboxed</span> <span m="2100350">with</span> <span m="2100750">Capsicum,</span> <span m="2101155">then all of</span> <span m="2101560">a</span> <span m="2101960">sudden</span> <span m="2102360">the</span> <span m="2102520">program</span> <span m="2102830">will</span> <span m="2103010">try to</span> <span m="2103270">open</span> <span m="2104400">any</span> <span m="2104920">simplified--</span> <span m="2105440">it'll</span> <span m="2105540">open</span> <span m="2105855">a</span> <span m="2106170">shared</span> <span m="2106640">library,</span> <span m="2107460">and</span> <span m="2107880">it can't open the</span> <span m="2108200">shared</span> <span m="2108550">library,</span> <span m="2109430">because it can't</span> <span m="2109790">open/liv/</span> <span m="2110870">something</span> <span m="2111200">else.</span> <span m="2111570">That's not allowed</span> <span m="2112140">in</span> <span m="2112590">capability</span> <span m="2112920">mode.</span> </p>
<p><span m="2113810">So</span> <span m="2114300">it's</span> <span m="2114420">a</span> <span m="2114450">bit of a</span> <span m="2115610">problem.</span> <span m="2116790">So</span> <span m="2116970">typically,</span> <span m="2118090">these</span> <span m="2118450">sandboxing</span> <span m="2118730">techniques that we're</span> <span m="2118940">going to</span> <span m="2119640">look at</span> <span m="2120080">here--</span> <span m="2120880">capabilities,</span> <span m="2121500">style,</span> <span m="2121685">stuff,</span> <span m="2121870">and</span> <span m="2122140">so on--</span> <span m="2123020">really</span> <span m="2123410">are</span> <span m="2124240">best</span> <span m="2124850">used</span> <span m="2125105">when</span> <span m="2125360">the</span> <span m="2125460">developer</span> <span m="2126370">is</span> <span m="2126680">sort</span> <span m="2126930">of</span> <span m="2127050">building</span> <span m="2127400">the</span> <span m="2127480">application</span> <span m="2128660">aware</span> <span m="2129290">that</span> <span m="2129580">the</span> <span m="2129710">code</span> <span m="2129970">is</span> <span m="2130110">going</span> <span m="2130220">to</span> <span m="2130420">run</span> <span m="2130800">in this</span> <span m="2131000">mode.</span> <span m="2131882">There's</span> <span m="2132364">probably other</span> <span m="2132846">kinds of</span> <span m="2133330">sandboxing</span> <span m="2133840">techniques</span> <span m="2134260">that</span> <span m="2134690">could</span> <span m="2134840">be</span> <span m="2134940">used</span> <span m="2135200">for</span> <span m="2135520">unmodified</span> <span m="2136190">code,</span> <span m="2136550">but</span> <span m="2136700">then</span> <span m="2137250">the</span> <span m="2137760">focus,</span> <span m="2138420">or</span> <span m="2138870">the</span> <span m="2138950">requirements,</span> <span m="2139660">change</span> <span m="2139950">a</span> <span m="2140040">bit.</span> </p>
<p><span m="2140270">So</span> <span m="2140680">in</span> <span m="2141145">Capsicum,</span> <span m="2142050">they</span> <span m="2142150">don't</span> <span m="2142320">really</span> <span m="2142510">worry</span> <span m="2142820">about</span> <span m="2143050">backwards</span> <span m="2143400">compatibility.</span> <span m="2143910">Well,</span> <span m="2144090">we</span> <span m="2144170">have</span> <span m="2144320">to open</span> <span m="2144610">files</span> <span m="2144870">differently?</span> <span m="2145320">Sure, we'll open them</span> <span m="2145770">differently.</span> <span m="2146770">Whereas,</span> <span m="2147460">if</span> <span m="2147580">you</span> <span m="2147680">want</span> <span m="2147810">to</span> <span m="2147920">write</span> <span m="2148100">existing</span> <span m="2148500">code,</span> <span m="2148820">you</span> <span m="2148900">probably</span> <span m="2150020">want</span> <span m="2150320">something</span> <span m="2150730">more</span> <span m="2150980">like</span> <span m="2151170">maybe a</span> <span m="2151490">full</span> <span m="2151720">virtual</span> <span m="2152020">machine.</span> <span m="2152450">So</span> <span m="2152765">you</span> <span m="2153080">could</span> <span m="2153350">open</span> <span m="2153590">a</span> <span m="2153860">VM</span> <span m="2154010">and run it</span> <span m="2154290">there.</span> <span m="2155040">And</span> <span m="2155250">it's very</span> <span m="2155900">compatible,</span> <span m="2157250">and</span> <span m="2157830">there's</span> <span m="2158400">no</span> <span m="2158570">question</span> <span m="2158890">that it'll just</span> <span m="2159440">run,</span> <span m="2161480">and</span> <span m="2162180">probably</span> <span m="2162520">not--</span> </p>
<p><span m="2163440">Well,</span> <span m="2163840">it's actually</span> <span m="2164640">a</span> <span m="2165040">good</span> <span m="2165340">thought</span> <span m="2165820">exercise.</span> <span m="2167060">Should</span> <span m="2167290">we</span> <span m="2167470">use</span> <span m="2167510">virtual</span> <span m="2167820">machines</span> <span m="2168610">to</span> <span m="2168980">sandbox</span> <span m="2169470">instead of</span> <span m="2169970">Capsicum?</span> </p>
<p><span m="2172004">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="2172886">PROFESSOR:</span> <span m="2173330">Yeah.</span> <span m="2173690">The</span> <span m="2174500">overheads are</span> <span m="2174710">probably</span> <span m="2175480">quite</span> <span m="2175680">significant.</span> <span m="2176510">So the</span> <span m="2176560">memory</span> <span m="2176810">overhead</span> <span m="2178690">is</span> <span m="2178860">pretty</span> <span m="2179040">bad.</span> <span m="2180715">It</span> <span m="2181050">could be.</span> <span m="2181325">But</span> <span m="2181830">what</span> <span m="2182170">if we don't</span> <span m="2182310">care</span> <span m="2182590">about memory</span> <span m="2182740">overhead?</span> <span m="2182900">So maybe</span> <span m="2183510">virtual</span> <span m="2183730">machines</span> <span m="2184030">gets</span> <span m="2184150">really good,</span> <span m="2184360">and</span> <span m="2184780">they don't</span> <span m="2185670">actually</span> <span m="2185910">use that</span> <span m="2186310">much memory.</span> <span m="2188080">Is it still</span> <span m="2188300">a</span> <span m="2188800">bad</span> <span m="2189390">plan?</span> </p>
<p><span m="2190210">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="2192910">PROFESSOR: Yeah.</span> <span m="2193374">So it's kind of</span> <span m="2193840">hard</span> <span m="2194020">to</span> <span m="2194100">control</span> <span m="2194700">what</span> <span m="2195730">happens</span> <span m="2196180">on</span> <span m="2196290">the</span> <span m="2196360">network,</span> <span m="2197160">because</span> <span m="2197480">either</span> <span m="2197870">you</span> <span m="2198180">give</span> <span m="2198510">the</span> <span m="2198580">virtual</span> <span m="2199020">machine</span> <span m="2199650">no</span> <span m="2199880">access</span> <span m="2200150">to</span> <span m="2200320">the network at</span> <span m="2200610">all,</span> <span m="2201140">or you connect</span> <span m="2201415">to a</span> <span m="2201690">network</span> <span m="2202570">through</span> <span m="2203080">NAT</span> <span m="2203365">mode or</span> <span m="2203990">something</span> <span m="2204260">in</span> <span m="2204530">Preview</span> <span m="2204900">or</span> <span m="2205090">VMware.</span> <span m="2206070">And</span> <span m="2206230">then it</span> <span m="2206560">can access</span> <span m="2206890">the</span> <span m="2206960">whole</span> <span m="2207180">internet.</span> <span m="2207550">So you</span> <span m="2207740">have</span> <span m="2207960">to</span> <span m="2208630">much</span> <span m="2208880">more</span> <span m="2209040">explicitly</span> <span m="2211230">control</span> <span m="2212230">network</span> <span m="2212710">by maybe</span> <span m="2213030">setting</span> <span m="2213310">up</span> <span m="2213500">firewall</span> <span m="2213690">rules</span> <span m="2214005">for</span> <span m="2214470">the</span> <span m="2214530">virtual</span> <span m="2214790">machine,</span> <span m="2215110">et</span> <span m="2215370">cetera.</span> <span m="2215966">That's maybe</span> <span m="2216422">not so great.</span> </p>
<p><span m="2216880">What if you don't</span> <span m="2217570">care</span> <span m="2217950">about</span> <span m="2218220">network?</span> <span m="2218890">What</span> <span m="2219010">if</span> <span m="2219130">you're</span> <span m="2219830">some</span> <span m="2220900">simple</span> <span m="2222100">video</span> <span m="2222470">or</span> <span m="2223160">tcpdump</span> <span m="2223430">parser.</span> <span m="2224240">You just</span> <span m="2224590">spin up a</span> <span m="2224925">VM.</span> <span m="2225260">It's going to</span> <span m="2225720">parse</span> <span m="2226065">your</span> <span m="2226410">tcpdump</span> <span m="2226705">packets</span> <span m="2227000">and</span> <span m="2227710">spit</span> <span m="2228150">you</span> <span m="2228305">back</span> <span m="2228590">after</span> <span m="2228800">your</span> <span m="2228940">presentation</span> <span m="2229490">that</span> <span m="2229670">tcpdump wants</span> <span m="2230103">to</span> <span m="2230536">burn to the</span> <span m="2230970">user.</span> <span m="2231850">So</span> <span m="2232250">there's no</span> <span m="2232430">real</span> <span m="2232590">network</span> <span m="2233080">I/O.</span> <span m="2233590">Maybe</span> <span m="2233850">you're,</span> <span m="2234190">for</span> <span m="2234605">some</span> <span m="2234812">reason</span> <span m="2235020">[INAUDIBLE]</span> <span m="2238350">still?</span> </p>
<p><span m="2240820">AUDIENCE: Because</span> <span m="2241250">the</span> <span m="2241696">initialization</span> <span m="2242142">overhead</span> <span m="2243340">is</span> <span m="2243620">still</span> <span m="2243900">large.</span> </p>
<p><span m="2244656">PROFESSOR: Yeah.</span> <span m="2245490">So it's maybe like an</span> <span m="2245885">initial overhead of</span> <span m="2246550">starting</span> <span m="2246930">a VM.</span> <span m="2247290">So that's true.</span> <span m="2248620">There's</span> <span m="2248730">some</span> <span m="2249210">performance stuff.</span> <span m="2252030">Yeah.</span> </p>
<p><span m="2252820">AUDIENCE: Well, you might want to have</span> <span m="2253140">database</span> <span m="2253577">rights</span> <span m="2254014">and</span> <span m="2254451">things like that.</span> </p>
<p><span m="2255762">PROFESSOR: Yeah.</span> <span m="2256200">But even</span> <span m="2256660">more</span> <span m="2256900">generally,</span> <span m="2257205">what you're</span> <span m="2257510">getting</span> <span m="2257690">at</span> <span m="2258010">is</span> <span m="2258890">what if</span> <span m="2259340">there's</span> <span m="2259790">a</span> <span m="2260240">real data that you care about</span> <span m="2260690">here?</span> <span m="2261140">And</span> <span m="2261570">it's</span> <span m="2261710">really</span> <span m="2261900">hard</span> <span m="2262320">to</span> <span m="2262390">share.</span> <span m="2262840">So</span> <span m="2263050">VMs</span> <span m="2263250">are</span> <span m="2263610">really</span> <span m="2263980">a</span> <span m="2264250">much</span> <span m="2264480">more</span> <span m="2265870">sort</span> <span m="2265990">of</span> <span m="2266060">separation</span> <span m="2267460">mechanism,</span> <span m="2268080">where</span> <span m="2268700">you</span> <span m="2268800">can't</span> <span m="2269160">really</span> <span m="2269440">share</span> <span m="2269830">stuff</span> <span m="2270040">across</span> <span m="2270330">VMs</span> <span m="2270740">very</span> <span m="2270970">easily.</span> <span m="2271970">So</span> <span m="2272160">it's</span> <span m="2272420">good</span> <span m="2272700">for</span> <span m="2272840">situations</span> <span m="2273360">where</span> <span m="2273640">you have</span> <span m="2273740">a</span> <span m="2273995">very</span> <span m="2274250">isolated</span> <span m="2274990">program</span> <span m="2275400">you</span> <span m="2275510">want</span> <span m="2275630">to</span> <span m="2275760">run,</span> <span m="2276500">you</span> <span m="2276680">basically</span> <span m="2277090">don't</span> <span m="2277290">want</span> <span m="2277390">to</span> <span m="2277430">share</span> <span m="2277680">any files</span> <span m="2277900">with</span> <span m="2278540">any</span> <span m="2278810">directories,</span> <span m="2279470">any</span> <span m="2279670">processes,</span> <span m="2280670">any</span> <span m="2280960">pipes</span> <span m="2281560">even.</span> <span m="2281830">And</span> <span m="2282070">you</span> <span m="2282610">just</span> <span m="2282780">let it run</span> <span m="2283200">separately.</span> </p>
<p><span m="2283640">So</span> <span m="2283900">it's great.</span> <span m="2284290">It's</span> <span m="2284680">probably,</span> <span m="2285630">in</span> <span m="2285730">some</span> <span m="2285930">ways,</span> <span m="2286180">stronger</span> <span m="2286790">isolation</span> <span m="2287065">than what</span> <span m="2287340">Capsicum</span> <span m="2288020">provides,</span> <span m="2289080">because</span> <span m="2289420">there's</span> <span m="2289580">probably</span> <span m="2289980">fewer</span> <span m="2290340">ways</span> <span m="2290720">for</span> <span m="2290830">things</span> <span m="2291180">to go</span> <span m="2291300">wrong.</span> <span m="2293100">And, you know,</span> <span m="2293560">all</span> <span m="2293820">these</span> <span m="2294170">problems</span> <span m="2294240">we</span> <span m="2294490">talked</span> <span m="2294710">about</span> <span m="2294960">so</span> <span m="2295130">far.</span> <span m="2295640">But it's</span> <span m="2295820">also</span> <span m="2296120">not</span> <span m="2296500">applicable</span> <span m="2297100">in</span> <span m="2297310">many of the</span> <span m="2297660">situations</span> <span m="2298310">where</span> <span m="2298570">you</span> <span m="2298660">might</span> <span m="2298950">want to use</span> <span m="2299210">Capsicum,</span> <span m="2299730">because</span> <span m="2300140">in</span> <span m="2301275">Capsicum,</span> <span m="2301620">you can actually</span> <span m="2301880">share</span> <span m="2302360">files</span> <span m="2302920">that</span> <span m="2303020">have</span> <span m="2303050">very</span> <span m="2303730">fine</span> <span m="2304120">granularity</span> <span m="2304950">between</span> <span m="2306320">sandbox</span> <span m="2306645">[INAUDIBLE]</span> <span m="2307410">by</span> <span m="2307570">just</span> <span m="2307800">giving</span> <span m="2308070">it</span> <span m="2308570">capability</span> <span m="2309070">to</span> <span m="2309490">[INAUDIBLE]</span> <span m="2310550">file.</span> <span m="2310840">This is something</span> <span m="2311300">that's very easy to do</span> <span m="2311600">in Capsicum,</span> <span m="2312550">and would</span> <span m="2312640">require</span> <span m="2313100">quite</span> <span m="2313450">a</span> <span m="2313480">bit</span> <span m="2313880">of</span> <span m="2314480">machinery</span> <span m="2315220">in</span> <span m="2315360">a</span> <span m="2315420">virtual</span> <span m="2315730">machine</span> <span m="2316610">setting.</span> <span m="2317280">That</span> <span m="2318100">makes</span> <span m="2318270">sense?</span> <span m="2320720">Questions?</span> <span m="2323200">All</span> <span m="2323270">right.</span> </p>
<p><span m="2324330">So</span> <span m="2325640">does that</span> <span m="2326150">seem</span> <span m="2326240">like</span> <span m="2326450">a</span> <span m="2326780">useful</span> <span m="2327220">primitives</span> <span m="2327600">to have</span> <span m="2327810">to</span> <span m="2327970">maybe</span> <span m="2328060">sandbox</span> <span m="2328450">stuff.</span> <span m="2329340">So</span> <span m="2330530">I</span> <span m="2330600">guess</span> <span m="2330750">we're</span> <span m="2330860">going</span> <span m="2330970">to</span> <span m="2331090">talk</span> <span m="2331290">about</span> <span m="2332080">different</span> <span m="2332390">ways</span> <span m="2333040">to try to</span> <span m="2333600">sandbox</span> <span m="2333970">something.</span> <span m="2334900">And</span> <span m="2335270">Capsicum</span> <span m="2335720">in particular</span> <span m="2336650">is</span> <span m="2337580">the</span> <span m="2337730">new thing</span> <span m="2337990">here that</span> <span m="2338130">uses capabilities.</span> <span m="2339270">But</span> <span m="2340610">just</span> <span m="2342600">by</span> <span m="2342710">comparison,</span> <span m="2343300">I</span> <span m="2343400">guess,</span> <span m="2345670">you</span> <span m="2345810">can</span> <span m="2346100">do</span> <span m="2346300">some</span> <span m="2346540">sandboxing</span> <span m="2347120">in</span> <span m="2347260">Unix,</span> <span m="2347630">as</span> <span m="2347720">we</span> <span m="2347850">saw with</span> <span m="2348145">OKWS.</span> <span m="2348710">Right?</span> <span m="2348850">It's</span> <span m="2349120">just</span> <span m="2350900">not</span> <span m="2351250">great</span> <span m="2351680">from</span> <span m="2352260">several</span> <span m="2352560">standpoints.</span> </p>
<p><span m="2353170">So</span> <span m="2353510">let's</span> <span m="2353680">maybe</span> <span m="2353960">take</span> <span m="2354220">the</span> <span m="2354920">example</span> <span m="2355570">of</span> <span m="2357180">tcpdump</span> <span m="2357860">and</span> <span m="2358020">see</span> <span m="2359080">why</span> <span m="2360720">tcpdump</span> <span m="2361200">is</span> <span m="2361750">difficult</span> <span m="2362180">to sandbox</span> <span m="2363120">with</span> <span m="2363590">Unix</span> <span m="2364060">mechanism.</span> <span m="2364530">So</span> <span m="2364790">remember,</span> <span m="2365340">in the</span> <span m="2365790">Capsicum</span> <span m="2366150">paper,</span> <span m="2366510">these</span> <span m="2366690">guys</span> <span m="2367150">took</span> <span m="2367470">tcpdump.</span> <span m="2367880">And</span> <span m="2367980">the</span> <span m="2368200">way</span> <span m="2369970">tcpdump</span> <span m="2370150">works</span> <span m="2370650">is</span> <span m="2371100">that</span> <span m="2371930">it</span> <span m="2372570">opens</span> <span m="2372990">some</span> <span m="2373410">special</span> <span m="2373930">sockets</span> <span m="2374590">and</span> <span m="2374780">then</span> <span m="2375460">runs</span> <span m="2377470">basically</span> <span m="2378630">parsing</span> <span m="2379080">logic</span> <span m="2379930">on</span> <span m="2380300">network</span> <span m="2380630">packets.</span> <span m="2381010">And it</span> <span m="2381100">proceeds</span> <span m="2381990">and</span> <span m="2382220">prints them</span> <span m="2382570">out</span> <span m="2382860">to the</span> <span m="2383360">users'</span> <span m="2383860">terminal.</span> </p>
<p><span m="2384860">So what</span> <span m="2385110">would</span> <span m="2385220">it</span> <span m="2385280">take</span> <span m="2385510">to</span> <span m="2386250">sandbox</span> <span m="2386940">tcpdump</span> <span m="2388110">with</span> <span m="2388700">Unix</span> <span m="2389340">primitives?</span> <span m="2391180">Have</span> <span m="2391460">you</span> <span m="2391810">restricted</span> <span m="2392380">privileges?</span> <span m="2394066">So I</span> <span m="2394490">guess the</span> <span m="2394870">one</span> <span m="2395080">problem</span> <span m="2395440">with</span> <span m="2395590">Unix</span> <span m="2395870">is</span> <span m="2396070">that</span> <span m="2396890">you</span> <span m="2397100">basically</span> <span m="2397560">have</span> <span m="2397870">to--</span> <span m="2398630">well,</span> <span m="2398830">the only way</span> <span m="2399300">to</span> <span m="2399575">really</span> <span m="2399850">change</span> <span m="2400120">privileges</span> <span m="2400780">is</span> <span m="2401270">to</span> <span m="2401630">change</span> <span m="2401890">the</span> <span m="2401950">inputs</span> <span m="2402370">into</span> <span m="2402590">the</span> <span m="2403730">decision</span> <span m="2403980">function</span> <span m="2404580">that</span> <span m="2404660">decides</span> <span m="2405080">whether</span> <span m="2405340">you can</span> <span m="2405600">actually access</span> <span m="2406050">some object</span> <span m="2406120">or not.</span> <span m="2406610">And</span> <span m="2407530">the</span> <span m="2407690">only</span> <span m="2407950">things</span> <span m="2408210">you can</span> <span m="2408580">really</span> <span m="2408780">change</span> <span m="2409160">are,</span> <span m="2409360">well,</span> <span m="2409610">you can</span> <span m="2409720">change</span> <span m="2410050">the</span> <span m="2410780">privilges of the</span> <span m="2411450">process,</span> <span m="2411860">which means</span> <span m="2412080">it</span> <span m="2412385">sends</span> <span m="2412690">UID</span> <span m="2413050">to</span> <span m="2413120">something</span> <span m="2413440">else.</span> </p>
<p><span m="2414300">Or</span> <span m="2414760">you could</span> <span m="2414990">change</span> <span m="2415200">the</span> <span m="2415290">permissions</span> <span m="2415800">on</span> <span m="2415990">various</span> <span m="2416330">objects</span> <span m="2417180">that are</span> <span m="2417760">laying</span> <span m="2418000">around</span> <span m="2418800">in</span> <span m="2418890">your</span> <span m="2419060">system.</span> <span m="2421510">Or</span> <span m="2421815">probably</span> <span m="2422120">both,</span> <span m="2422455">in</span> <span m="2422790">fact,</span> <span m="2423060">right?</span> <span m="2423330">If</span> <span m="2423910">you wanted to</span> <span m="2424250">sandbox</span> <span m="2424500">tcpdump,</span> <span m="2425110">you'd</span> <span m="2425230">probably</span> <span m="2425550">have</span> <span m="2425810">to</span> <span m="2426230">pick</span> <span m="2426540">some</span> <span m="2426870">extra</span> <span m="2427220">user</span> <span m="2427640">ID and</span> <span m="2428060">switch</span> <span m="2428210">to</span> <span m="2428300">that</span> <span m="2429150">while</span> <span m="2429430">you're</span> <span m="2429640">running.</span> <span m="2431612">Probably</span> <span m="2432580">not</span> <span m="2432850">an</span> <span m="2434400">ideal</span> <span m="2434870">plan,</span> <span m="2435190">because</span> <span m="2435680">you</span> <span m="2435790">probably</span> <span m="2436660">don't</span> <span m="2437020">mean</span> <span m="2437420">for</span> <span m="2437590">multiple</span> <span m="2438090">instances</span> <span m="2438500">of</span> <span m="2438755">tcpdump</span> <span m="2439340">to run</span> <span m="2439580">as</span> <span m="2439616">the</span> <span m="2439653">same</span> <span m="2439690">user</span> <span m="2439790">ID.</span> </p>
<p><span m="2441060">So</span> <span m="2441220">if</span> <span m="2441390">I</span> <span m="2441490">compromise</span> <span m="2442040">one</span> <span m="2442330">instance of</span> <span m="2442620">tcpdump,</span> <span m="2442840">it doesn't</span> <span m="2443080">really mean</span> <span m="2443910">I</span> <span m="2444160">want</span> <span m="2444450">to</span> <span m="2444830">allow</span> <span m="2445190">that</span> <span m="2445280">factor</span> <span m="2445560">to now</span> <span m="2446000">control</span> <span m="2446360">the other</span> <span m="2446720">instances</span> <span m="2447020">of</span> <span m="2447200">tcpdump</span> <span m="2447450">running on</span> <span m="2447580">my</span> <span m="2447910">machine.</span> <span m="2449070">So</span> <span m="2449210">that's</span> <span m="2450450">potentially a</span> <span m="2451110">bad</span> <span m="2451780">part</span> <span m="2452020">of</span> <span m="2452180">using user</span> <span m="2452560">IDs</span> <span m="2452940">here.</span> </p>
<p><span m="2453870">Another</span> <span m="2454130">problem</span> <span m="2454470">is</span> <span m="2454590">that,</span> <span m="2454730">in</span> <span m="2455080">Unix,</span> <span m="2455220">you</span> <span m="2455290">actually</span> <span m="2455530">have</span> <span m="2455710">to be</span> <span m="2456450">root</span> <span m="2456760">in</span> <span m="2457420">order</span> <span m="2457920">to change the</span> <span m="2458790">user</span> <span m="2459210">ID of the</span> <span m="2459500">process</span> <span m="2459870">or</span> <span m="2459930">something</span> <span m="2460270">else,</span> <span m="2460460">or user</span> <span m="2460960">privileges</span> <span m="2461215">or</span> <span m="2461470">switch</span> <span m="2461870">them</span> <span m="2462070">to</span> <span m="2462270">something else.</span> <span m="2463200">That's</span> <span m="2463440">not</span> <span m="2463650">great</span> <span m="2463890">either.</span> <span m="2465060">And</span> <span m="2465400">another</span> <span m="2465810">problem</span> <span m="2466170">is</span> <span m="2466330">that,</span> <span m="2467490">regardless</span> <span m="2468080">of</span> <span m="2468180">what</span> <span m="2468350">your</span> <span m="2468580">user</span> <span m="2468820">ID</span> <span m="2469245">is,</span> <span m="2470540">there</span> <span m="2470720">could</span> <span m="2470940">be</span> <span m="2471460">files that</span> <span m="2472440">allow</span> <span m="2473060">access</span> <span m="2473480">to</span> <span m="2473580">them.</span> <span m="2473830">So</span> <span m="2473990">there</span> <span m="2474190">could</span> <span m="2474380">be</span> <span m="2474550">world</span> <span m="2474940">writable</span> <span m="2475275">or</span> <span m="2475610">world</span> <span m="2475900">readable</span> <span m="2476370">files</span> <span m="2476760">in</span> <span m="2476870">your</span> <span m="2476980">file system.</span> <span m="2477800">Like</span> <span m="2478230">your</span> <span m="2478500">etc</span> <span m="2478720">password</span> <span m="2479070">file.</span> <span m="2479730">Regardless</span> <span m="2480280">of</span> <span m="2480360">what</span> <span m="2480510">your</span> <span m="2480700">UID is,</span> <span m="2481950">the</span> <span m="2482060">process</span> <span m="2482370">will</span> <span m="2482500">still</span> <span m="2482730">be</span> <span m="2482890">able</span> <span m="2483130">to</span> <span m="2483280">read that</span> <span m="2483620">password.</span> <span m="2484420">So that's not</span> <span m="2484870">so nice.</span> </p>
<p><span m="2486070">So</span> <span m="2487410">the</span> <span m="2487540">result,</span> <span m="2488390">in order to</span> <span m="2488930">sandbox</span> <span m="2489090">a</span> <span m="2489355">unit,</span> <span m="2489850">you</span> <span m="2492360">probably</span> <span m="2492590">have</span> <span m="2492710">to</span> <span m="2493680">do</span> <span m="2493860">both--</span> <span m="2494380">some</span> <span m="2494807">UID</span> <span m="2495234">changing</span> <span m="2495661">and</span> <span m="2496090">maybe</span> <span m="2496680">careful</span> <span m="2497020">look at the</span> <span m="2497110">permissions</span> <span m="2497490">of</span> <span m="2497590">all</span> <span m="2497830">the objects</span> <span m="2498340">to</span> <span m="2498460">convince</span> <span m="2498780">yourself</span> <span m="2499040">that there's</span> <span m="2499560">no</span> <span m="2499810">world</span> <span m="2500190">writeable</span> <span m="2500630">file that's</span> <span m="2501030">really</span> <span m="2501330">sensitive.</span> <span m="2501530">Or there's</span> <span m="2501810">no</span> <span m="2502220">world</span> <span m="2502495">readable</span> <span m="2502950">file</span> <span m="2503130">that you don't</span> <span m="2503465">want</span> <span m="2504030">that</span> <span m="2504100">hacker</span> <span m="2504430">to</span> <span m="2504740">get</span> <span m="2504860">access</span> <span m="2505190">to.</span> </p>
<p><span m="2506190">And</span> <span m="2506570">I</span> <span m="2506600">guess</span> <span m="2506880">[INAUDIBLE]</span> <span m="2507070">true that you get</span> <span m="2507580">another</span> <span m="2507840">mechanism</span> <span m="2508200">unit that you can</span> <span m="2508580">use.</span> <span m="2509530">But it</span> <span m="2510320">all</span> <span m="2510640">starts</span> <span m="2510930">to add up.</span> <span m="2510970">If</span> <span m="2511160">you see</span> <span m="2511570">it</span> <span m="2511980">through,</span> <span m="2512240">then it might be</span> <span m="2512730">hard to share</span> <span m="2513490">files</span> <span m="2514150">or</span> <span m="2514390">share</span> <span m="2514670">directories</span> <span m="2515440">and</span> <span m="2516000">so</span> <span m="2516300">on.</span> <span m="2517360">So</span> <span m="2517520">does that make sense?</span> <span m="2517680">Just in terms of</span> <span m="2518970">contrast</span> <span m="2519410">for</span> <span m="2519720">what</span> <span m="2520466">Capsicum</span> <span m="2520902">is trying to solve?</span> <span m="2522393">Any</span> <span m="2522736">questions</span> <span m="2523200">about</span> <span m="2523560">Unix</span> <span m="2523993">stuff?</span> <span m="2526160">All right.</span> </p>
<p><span m="2526950">So let's</span> <span m="2527120">look</span> <span m="2527320">at</span> <span m="2527400">how</span> <span m="2528130">Capsicum</span> <span m="2528870">tries to solve</span> <span m="2529135">this</span> <span m="2529570">problem.</span> <span m="2530650">So</span> <span m="2531000">in</span> <span m="2531350">Capsicum,</span> <span m="2531560">as</span> <span m="2531760">we keep</span> <span m="2532320">alluding</span> <span m="2532770">to,</span> <span m="2533680">the</span> <span m="2534060">plan</span> <span m="2534550">is</span> <span m="2534790">very</span> <span m="2535010">much</span> <span m="2535380">that</span> <span m="2536150">once</span> <span m="2536350">you enter</span> <span m="2536650">the</span> <span m="2536950">sandboxing</span> <span m="2537620">mode,</span> <span m="2538330">everything</span> <span m="2538820">is</span> <span m="2538950">going</span> <span m="2539110">to</span> <span m="2539170">be</span> <span m="2539620">accessed</span> <span m="2540080">only</span> <span m="2540890">through</span> <span m="2541220">capability.</span> <span m="2541670">So if you</span> <span m="2542120">don't</span> <span m="2542350">have</span> <span m="2542450">a</span> <span m="2542520">capability,</span> <span m="2543490">you</span> <span m="2543890">simply</span> <span m="2544170">cannot</span> <span m="2544650">access</span> <span m="2545440">any</span> <span m="2545670">objects.</span> </p>
<p><span m="2547610">So</span> <span m="2550020">these</span> <span m="2550270">guys,</span> <span m="2550640">in</span> <span m="2550730">the</span> <span m="2550820">paper,</span> <span m="2551120">make</span> <span m="2551320">a</span> <span m="2551370">huge</span> <span m="2551840">deal</span> <span m="2552000">about</span> <span m="2552360">global</span> <span m="2552800">namespaces.</span> <span m="2554870">So</span> <span m="2555320">what's</span> <span m="2556200">this</span> <span m="2556320">thing</span> <span m="2556550">about a</span> <span m="2556830">global</span> <span m="2557130">namespace,</span> <span m="2557720">and</span> <span m="2557840">why</span> <span m="2558080">are they</span> <span m="2558270">so</span> <span m="2558480">worried</span> <span m="2558800">about</span> <span m="2559130">it?</span> <span m="2563510">What's an</span> <span m="2563580">example</span> <span m="2564020">of a</span> <span m="2564070">global</span> <span m="2564340">namespace</span> <span m="2564780">these</span> <span m="2564970">guys</span> <span m="2565180">worry about?</span> </p>
<p><span m="2567379">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="2568770">PROFESSOR: Yeah.</span> <span m="2569200">So a</span> <span m="2569300">file</span> <span m="2569610">system</span> <span m="2569980">from them</span> <span m="2570370">is</span> <span m="2570720">sort</span> <span m="2570960">of</span> <span m="2571060">the</span> <span m="2571130">prime</span> <span m="2571400">example</span> <span m="2571805">of a global namespace.</span> <span m="2572550">You</span> <span m="2572670">can</span> <span m="2572790">start</span> <span m="2573100">a</span> <span m="2573340">slash,</span> <span m="2573665">and you can</span> <span m="2574600">basically</span> <span m="2574910">enumerate</span> <span m="2575420">any</span> <span m="2575680">file you</span> <span m="2576050">could,</span> <span m="2576420">right?</span> <span m="2576690">Like</span> <span m="2577120">go</span> <span m="2577495">to</span> <span m="2577980">someone's</span> <span m="2578280">home</span> <span m="2578470">directory--</span> <span m="2579450">/home/nickolai/</span> <span m="2581756">something,</span> <span m="2582254">something.</span> <span m="2583748">Why is this</span> <span m="2584350">bad?</span> <span m="2584860">Why</span> <span m="2585080">are</span> <span m="2585190">they</span> <span m="2586330">against</span> <span m="2586670">global</span> <span m="2587640">namespaces in</span> <span m="2588260">Capsicum?</span> <span m="2594740">What do you think?</span> <span m="2595100">Yeah?</span> </p>
<p><span m="2595460">AUDIENCE:</span> <span m="2595936">Well, if you have the</span> <span m="2596412">wrong permissions,</span> <span m="2596888">then</span> <span m="2597364">use</span> <span m="2597840">authorities,</span> <span m="2598792">and then you can get in</span> <span m="2599268">trouble.</span> </p>
<p><span m="2600700">PROFESSOR: Yeah.</span> <span m="2601200">So the problem is</span> <span m="2601330">that this</span> <span m="2601740">is</span> <span m="2602070">Unix</span> <span m="2602560">after</span> <span m="2602620">all.</span> <span m="2602890">So</span> <span m="2603890">there</span> <span m="2604250">are</span> <span m="2605280">still</span> <span m="2605580">regular</span> <span m="2605985">permissions on</span> <span m="2606390">file.</span> <span m="2607370">So</span> <span m="2607930">maybe</span> <span m="2608210">you</span> <span m="2608360">really</span> <span m="2608550">want</span> <span m="2608680">to</span> <span m="2608740">sandbox</span> <span m="2609020">some</span> <span m="2609300">process</span> <span m="2609790">and</span> <span m="2610020">can't</span> <span m="2610510">read anything</span> <span m="2611000">at</span> <span m="2611340">all</span> <span m="2611630">in the system and can't</span> <span m="2611920">write to</span> <span m="2612185">anything.</span> <span m="2612450">But</span> <span m="2612780">if you can</span> <span m="2613620">name</span> <span m="2614030">a</span> <span m="2614100">file starting</span> <span m="2614980">from</span> <span m="2615130">scratch,</span> <span m="2615530">you'll</span> <span m="2615860">find</span> <span m="2616290">some</span> <span m="2617000">stupid</span> <span m="2617060">user</span> <span m="2617230">that has</span> <span m="2617740">a</span> <span m="2617880">world writable</span> <span m="2618060">file</span> <span m="2618300">in their</span> <span m="2618717">home</span> <span m="2619134">directory.</span> <span m="2619970">And that would</span> <span m="2620220">be</span> <span m="2620800">not so great</span> <span m="2621730">for the</span> <span m="2622060">sandboxing</span> <span m="2622550">client.</span> </p>
<p><span m="2624100">And</span> <span m="2624560">I guess</span> <span m="2625045">more generally,</span> <span m="2625690">the way they're</span> <span m="2625930">thinking of</span> <span m="2626120">it</span> <span m="2626290">is that,</span> <span m="2627000">with</span> <span m="2627210">capabilities,</span> <span m="2628630">you</span> <span m="2628850">could,</span> <span m="2629170">in</span> <span m="2629240">principle,</span> <span m="2629710">enumerate</span> <span m="2630430">exactly</span> <span m="2631220">all the</span> <span m="2631570">objects</span> <span m="2631890">that a process</span> <span m="2632210">has.</span> <span m="2633122">Because you could</span> <span m="2634340">just</span> <span m="2634595">enumerate</span> <span m="2634850">all</span> <span m="2635150">the</span> <span m="2635230">capabilities</span> <span m="2636030">in</span> <span m="2636250">the</span> <span m="2636640">file</span> <span m="2637110">descriptor</span> <span m="2637270">table,</span> <span m="2637600">or</span> <span m="2637760">whatever</span> <span m="2638060">it</span> <span m="2638110">is</span> <span m="2638240">that's</span> <span m="2638350">storing</span> <span m="2638770">capabilities</span> <span m="2639300">for</span> <span m="2639490">you.</span> <span m="2640250">And</span> <span m="2641340">those</span> <span m="2641560">are</span> <span m="2641840">the</span> <span m="2641990">only</span> <span m="2642530">things</span> <span m="2642700">that</span> <span m="2642810">the</span> <span m="2643020">process</span> <span m="2643275">could</span> <span m="2643530">ever</span> <span m="2643970">touch.</span> </p>
<p><span m="2645890">And</span> <span m="2646170">if</span> <span m="2646260">you</span> <span m="2646550">ever</span> <span m="2647020">have access to our</span> <span m="2647150">global</span> <span m="2647620">namespace,</span> <span m="2647900">and this was</span> <span m="2648230">potentially</span> <span m="2648580">unbounded.</span> <span m="2649090">Because</span> <span m="2649310">you could--</span> <span m="2649660">even</span> <span m="2650010">if</span> <span m="2650110">you</span> <span m="2650250">have</span> <span m="2650540">some</span> <span m="2650860">limited set of</span> <span m="2651060">capabilities,</span> <span m="2651920">maybe you'll</span> <span m="2652310">start</span> <span m="2652690">from</span> <span m="2652830">slash</span> <span m="2653250">again</span> <span m="2653750">and</span> <span m="2654040">find</span> <span m="2654225">some</span> <span m="2654410">new file,</span> <span m="2654850">and you'll</span> <span m="2655020">never</span> <span m="2655330">really</span> <span m="2655640">know</span> <span m="2655890">what</span> <span m="2656510">is</span> <span m="2656680">the</span> <span m="2656780">set</span> <span m="2657190">of</span> <span m="2658060">operations</span> <span m="2658740">or</span> <span m="2659450">objects</span> <span m="2659745">that</span> <span m="2660040">a</span> <span m="2660426">process could access.</span> </p>
<p><span m="2662120">So</span> <span m="2662200">this</span> <span m="2662300">is</span> <span m="2662420">the</span> <span m="2662530">reason</span> <span m="2663750">they're</span> <span m="2663950">so</span> <span m="2664190">worried</span> <span m="2664440">about</span> <span m="2664650">global</span> <span m="2664930">namespaces</span> <span m="2665370">because</span> <span m="2665600">it</span> <span m="2665730">goes</span> <span m="2665910">against</span> <span m="2666350">their</span> <span m="2666880">goal</span> <span m="2667320">of</span> <span m="2667760">precisely</span> <span m="2668520">controlling</span> <span m="2668775">all</span> <span m="2669030">the</span> <span m="2670000">things</span> <span m="2670170">that</span> <span m="2670450">a</span> <span m="2670540">sandbox</span> <span m="2671140">process</span> <span m="2671530">should have</span> <span m="2671920">access</span> <span m="2672330">to.</span> <span m="2673880">Make</span> <span m="2674020">sense?</span> <span m="2676440">All</span> <span m="2676510">right.</span> </p>
<p><span m="2677590">So</span> <span m="2678320">they tried</span> <span m="2678730">to eliminate</span> <span m="2679160">global</span> <span m="2679470">namespaces</span> <span m="2679850">with</span> <span m="2679990">a</span> <span m="2680190">bunch of</span> <span m="2680510">kernel</span> <span m="2680900">changes</span> <span m="2681470">to</span> <span m="2682930">the</span> <span m="2683470">FreeBSD,</span> <span m="2683980">in</span> <span m="2684132">their</span> <span m="2684285">case,</span> <span m="2684590">kernel</span> <span m="2685360">to</span> <span m="2685730">make</span> <span m="2685910">sure</span> <span m="2686180">that</span> <span m="2686450">all</span> <span m="2686910">the</span> <span m="2686980">operations</span> <span m="2687670">go</span> <span m="2687960">through</span> <span m="2689360">some</span> <span m="2689800">kind</span> <span m="2690010">of</span> <span m="2690110">capability,</span> <span m="2690680">which</span> <span m="2691070">is,</span> <span m="2691300">in</span> <span m="2691700">their</span> <span m="2691940">case,</span> <span m="2692220">a</span> <span m="2692535">file descriptor.</span> </p>
<p><span m="2694190">So</span> <span m="2694640">just to</span> <span m="2694800">double</span> <span m="2695020">check,</span> <span m="2695520">do we</span> <span m="2696390">really</span> <span m="2696760">need</span> <span m="2697130">kernel</span> <span m="2697465">changes?</span> <span m="2697800">What</span> <span m="2698110">if we</span> <span m="2698240">just</span> <span m="2698500">do this</span> <span m="2699450">in</span> <span m="2699630">a</span> <span m="2699720">library?</span> <span m="2700350">So we</span> <span m="2700720">implement</span> <span m="2701450">Capsicum,</span> <span m="2701725">which they</span> <span m="2702290">already have</span> <span m="2702740">a</span> <span m="2702780">library.</span> <span m="2703040">And</span> <span m="2703300">all we do</span> <span m="2703555">is</span> <span m="2703810">we</span> <span m="2704310">change</span> <span m="2704700">all</span> <span m="2704930">these</span> <span m="2705140">functions,</span> <span m="2705700">like</span> <span m="2705880">open,</span> <span m="2706210">read,</span> <span m="2706560">and write,</span> <span m="2706910">to</span> <span m="2707200">all</span> <span m="2707540">very</span> <span m="2707880">exclusive</span> <span m="2708290">use</span> <span m="2708590">capabilities.</span> <span m="2710010">So all</span> <span m="2710290">operations</span> <span m="2710940">will</span> <span m="2711070">go</span> <span m="2711310">through some</span> <span m="2711810">capability,</span> <span m="2712010">and</span> <span m="2713890">look it up</span> <span m="2714230">in</span> <span m="2714570">the</span> <span m="2715010">file</span> <span m="2715430">table,</span> <span m="2715720">et</span> <span m="2715850">cetera.</span> <span m="2716193">Does that</span> <span m="2716880">work?</span> <span m="2717290">Yeah?</span> </p>
<p><span m="2717640">AUDIENCE: You could</span> <span m="2718058">always make a</span> <span m="2718476">sys</span> <span m="2718894">call.</span> </p>
<p><span m="2719730">PROFESSOR: Yeah.</span> <span m="2720010">So the</span> <span m="2720500">problem</span> <span m="2720770">is that</span> <span m="2720880">there</span> <span m="2721190">was</span> <span m="2721440">this</span> <span m="2721690">existing</span> <span m="2721950">set of</span> <span m="2722210">systems</span> <span m="2722480">calls</span> <span m="2722960">the</span> <span m="2723050">kernel</span> <span m="2723480">will accept.</span> <span m="2723866">And</span> <span m="2724640">even</span> <span m="2724850">if</span> <span m="2724930">you implement</span> <span m="2725320">a</span> <span m="2725380">nice</span> <span m="2725690">library, it</span> <span m="2726100">doesn't</span> <span m="2726400">prevent</span> <span m="2726850">a bad</span> <span m="2727170">process</span> <span m="2727480">or a</span> <span m="2727610">compromised</span> <span m="2728060">process from</span> <span m="2728420">making the</span> <span m="2728775">sys call</span> <span m="2729130">directly.</span> <span m="2729430">And</span> <span m="2729730">then</span> <span m="2730780">you</span> <span m="2731130">have</span> <span m="2731340">to</span> <span m="2731430">have</span> <span m="2731600">the</span> <span m="2731660">kernel enforce</span> <span m="2732270">something</span> <span m="2732565">or</span> <span m="2732860">other.</span> <span m="2733790">Yeah?</span> </p>
<p><span m="2734286">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="2736940">PROFESSOR: Yeah.</span> <span m="2737390">So</span> <span m="2737460">I</span> <span m="2737860">think it's a</span> <span m="2738350">question</span> <span m="2738800">of--</span> <span m="2739160">I</span> <span m="2739230">guess</span> <span m="2739410">what is</span> <span m="2739640">your</span> <span m="2739800">threat</span> <span m="2740080">model?</span> <span m="2740330">Exactly.</span> <span m="2740800">So</span> <span m="2741060">for</span> <span m="2741130">the</span> <span m="2741220">compiler,</span> <span m="2741595">the threat</span> <span m="2742200">model</span> <span m="2742580">is</span> <span m="2742920">that the</span> <span m="2743020">programmer</span> <span m="2743930">is</span> <span m="2746170">maybe</span> <span m="2746410">not</span> <span m="2746680">paying</span> <span m="2746860">attention</span> <span m="2747230">a</span> <span m="2747250">whole</span> <span m="2747510">lot,</span> <span m="2747950">but</span> <span m="2748350">it's</span> <span m="2748460">not</span> <span m="2748880">really</span> <span m="2749010">a compromised</span> <span m="2749295">compiler</span> <span m="2749940">process,</span> <span m="2750240">not</span> <span m="2750540">an</span> <span m="2750930">arbitrary</span> <span m="2751410">code.</span> <span m="2751710">So</span> <span m="2752010">if we</span> <span m="2752470">just help</span> <span m="2752735">the</span> <span m="2753275">well-meaning</span> <span m="2753910">developer</span> <span m="2754690">do</span> <span m="2754750">the</span> <span m="2754900">right</span> <span m="2755160">thing,</span> <span m="2755550">then a</span> <span m="2755920">library</span> <span m="2756420">will</span> <span m="2756550">probably</span> <span m="2757000">suffice.</span> </p>
<p><span m="2758590">On</span> <span m="2758700">the</span> <span m="2758740">other</span> <span m="2758940">hand,</span> <span m="2759530">if</span> <span m="2759600">we're</span> <span m="2759760">talking</span> <span m="2760030">about</span> <span m="2760370">a process</span> <span m="2760840">that</span> <span m="2760990">could</span> <span m="2761120">be</span> <span m="2761370">our executing</span> <span m="2761870">arbitrary</span> <span m="2762430">code</span> <span m="2763110">and</span> <span m="2763750">could</span> <span m="2764100">be</span> <span m="2764200">trying</span> <span m="2764460">to</span> <span m="2764530">bypass</span> <span m="2765040">our</span> <span m="2765150">mechanisms</span> <span m="2765610">in any</span> <span m="2765820">possible</span> <span m="2766230">way,</span> <span m="2766690">then we</span> <span m="2766940">have</span> <span m="2767210">to</span> <span m="2767290">have</span> <span m="2767620">a</span> <span m="2767700">strong</span> <span m="2768220">enforcement</span> <span m="2768780">boundary.</span> <span m="2769370">And</span> <span m="2769700">a library doesn't</span> <span m="2770480">provide</span> <span m="2770800">any</span> <span m="2771080">kind</span> <span m="2771200">of</span> <span m="2771290">strong</span> <span m="2771670">enforcement</span> <span m="2772160">guarantees.</span> <span m="2772280">Whereas</span> <span m="2772740">a</span> <span m="2773140">kernel,</span> <span m="2773270">in our</span> <span m="2773390">case,</span> <span m="2774320">would</span> <span m="2774540">do</span> <span m="2774630">that.</span> </p>
<p><span m="2776410">OK.</span> <span m="2776810">So</span> <span m="2776920">what do they</span> <span m="2777210">actually</span> <span m="2777740">make</span> <span m="2778120">in terms of</span> <span m="2779040">changes</span> <span m="2780260">to</span> <span m="2780410">the</span> <span m="2780540">kernel?</span> <span m="2780805">So</span> <span m="2781070">I</span> <span m="2781470">guess the</span> <span m="2781800">first</span> <span m="2782130">thing</span> <span m="2782810">is</span> <span m="2783750">this</span> <span m="2784000">system</span> <span m="2784420">call</span> <span m="2785270">that</span> <span m="2786130">they</span> <span m="2786260">call</span> <span m="2786520">cap_enter.</span> <span m="2790750">And</span> <span m="2791640">what</span> <span m="2791770">happens</span> <span m="2792100">once</span> <span m="2792290">you run</span> <span m="2792710">cap_enter?</span> <span m="2793370">Once</span> <span m="2793760">you've</span> <span m="2793930">[INAUDIBLE]</span> <span m="2794140">cap_enter</span> <span m="2794480">from</span> <span m="2794660">your</span> <span m="2794870">process?</span> </p>
<p><span m="2799180">So as far as I can tell,</span> <span m="2799310">what</span> <span m="2799470">happens</span> <span m="2799850">is</span> <span m="2799940">that the</span> <span m="2800260">kernel</span> <span m="2800790">will</span> <span m="2801240">stop</span> <span m="2802080">accepting</span> <span m="2803260">any</span> <span m="2803940">system</span> <span m="2804260">calls</span> <span m="2804670">that</span> <span m="2804950">refer</span> <span m="2805910">to</span> <span m="2806030">global</span> <span m="2806440">namespaces.</span> <span m="2807800">And</span> <span m="2807990">the only thing</span> <span m="2808440">you'll</span> <span m="2808600">be</span> <span m="2808780">able</span> <span m="2808970">to</span> <span m="2809030">do</span> <span m="2809260">is</span> <span m="2810200">refer</span> <span m="2810570">to</span> <span m="2811160">existing</span> <span m="2811610">file</span> <span m="2812110">descriptors</span> <span m="2812650">that you have</span> <span m="2812950">open in</span> <span m="2813340">your</span> <span m="2813520">process.</span> <span m="2814810">So</span> <span m="2815150">cap_enter</span> <span m="2815840">will put</span> <span m="2816330">your</span> <span m="2816580">process</span> <span m="2817010">in a</span> <span m="2817380">special</span> <span m="2817680">mode</span> <span m="2817990">where</span> <span m="2818340">you</span> <span m="2818470">cannot</span> <span m="2818930">use</span> <span m="2819630">the</span> <span m="2819730">regular</span> <span m="2820130">system called</span> <span m="2820950">open,</span> <span m="2822265">and</span> <span m="2822730">instead</span> <span m="2823990">you</span> <span m="2824010">have</span> <span m="2824200">to</span> <span m="2824310">do</span> <span m="2824600">things</span> <span m="2824870">like</span> <span m="2825090">openat.</span> </p>
<p><span m="2826230">So</span> <span m="2826380">there's</span> <span m="2826660">this</span> <span m="2826820">new</span> <span m="2827110">sort</span> <span m="2827230">of</span> <span m="2827340">family of</span> <span m="2827610">systems</span> <span m="2827950">called,</span> <span m="2828520">in</span> <span m="2828890">Unix</span> <span m="2829260">like</span> <span m="2829460">operating</span> <span m="2829760">systems,</span> <span m="2830130">where</span> <span m="2830830">instead</span> <span m="2831150">of</span> <span m="2831370">having</span> <span m="2831750">open</span> <span m="2832150">take</span> <span m="2832310">a</span> <span m="2832370">single</span> <span m="2832760">path</span> <span m="2833080">name,</span> <span m="2833280">you can</span> <span m="2833610">actually</span> <span m="2834520">you</span> <span m="2834820">openat,</span> <span m="2835520">where</span> <span m="2835850">you</span> <span m="2836030">pass</span> <span m="2836400">it a</span> <span m="2836600">first</span> <span m="2837020">argument</span> <span m="2837490">which</span> <span m="2837560">is</span> <span m="2837700">a</span> <span m="2838480">file</span> <span m="2838800">descriptor</span> <span m="2839310">for a</span> <span m="2839520">directory</span> <span m="2840110">and</span> <span m="2840486">the</span> <span m="2841240">second</span> <span m="2841500">is</span> <span m="2841830">some</span> <span m="2842030">sort</span> <span m="2842210">of</span> <span m="2842290">a</span> <span m="2842340">name.</span> <span m="2843640">And</span> <span m="2844450">the</span> <span m="2844640">open</span> <span m="2844950">at</span> <span m="2845270">system</span> <span m="2845420">call</span> <span m="2845900">will open</span> <span m="2846590">this</span> <span m="2846970">name</span> <span m="2847610">relative</span> <span m="2848160">to</span> <span m="2848310">whatever</span> <span m="2848680">directory</span> <span m="2849180">the</span> <span m="2849340">file descriptor</span> <span m="2849600">points</span> <span m="2849770">to.</span> </p>
<p><span m="2851250">So</span> <span m="2851540">this is a much</span> <span m="2851770">more</span> <span m="2852010">capability-like</span> <span m="2853250">version of</span> <span m="2853610">open,</span> <span m="2854400">where</span> <span m="2854890">you</span> <span m="2854970">can</span> <span m="2855110">still</span> <span m="2855310">have</span> <span m="2855610">file</span> <span m="2855870">descriptors</span> <span m="2856710">pointing to</span> <span m="2857150">directories,</span> <span m="2858380">but</span> <span m="2860700">you</span> <span m="2860910">can--</span> <span m="2861480">well,</span> <span m="2861970">sorry.</span> <span m="2862580">You can</span> <span m="2862860">still</span> <span m="2863780">direct your</span> <span m="2864140">operation.</span> <span m="2864930">But</span> <span m="2865210">in</span> <span m="2865330">order</span> <span m="2865490">to do</span> <span m="2865630">this,</span> <span m="2865900">you</span> <span m="2865970">have</span> <span m="2866170">to</span> <span m="2866290">have</span> <span m="2866480">a</span> <span m="2866560">capability</span> <span m="2866830">to the</span> <span m="2867340">directory</span> <span m="2868110">in</span> <span m="2868210">the</span> <span m="2868300">form</span> <span m="2868600">of</span> <span m="2868750">an</span> <span m="2868860">open</span> <span m="2869060">file descriptor</span> <span m="2869690">for that</span> <span m="2869830">[INAUDIBLE].</span> <span m="2871200">Make</span> <span m="2871660">sense?</span> <span m="2873944">OK.</span> </p>
<p><span m="2875290">So</span> <span m="2876210">do they need any</span> <span m="2876730">other</span> <span m="2877060">kernel</span> <span m="2877390">changes?</span> <span m="2878480">Is there</span> <span m="2878936">anything else</span> <span m="2879850">they worry</span> <span m="2880180">about?</span> <span m="2884520">So I</span> <span m="2884630">guess there's</span> <span m="2884935">another--</span> <span m="2885240">yeah?</span> </p>
<p><span m="2886086">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="2887870">PROFESSOR: Yeah.</span> <span m="2888316">So what do they</span> <span m="2888762">do about</span> <span m="2889210">network access,</span> <span m="2889660">right?</span> <span m="2889860">So</span> <span m="2890390">what</span> <span m="2890520">happens</span> <span m="2890870">in capability</span> <span m="2891160">mode?</span> </p>
<p><span m="2892660">AUDIENCE: I guess they have</span> <span m="2893035">capabilities</span> <span m="2893410">for</span> <span m="2893800">security</span> <span m="2894281">packets</span> <span m="2894762">[INAUDIBLE].</span> </p>
<p><span m="2897650">PROFESSOR: Yes.</span> <span m="2897990">So I</span> <span m="2898090">think</span> <span m="2898380">the</span> <span m="2898840">way they</span> <span m="2898990">basically do</span> <span m="2899310">it is</span> <span m="2899440">that</span> <span m="2899840">they</span> <span m="2900030">treat</span> <span m="2900480">the</span> <span m="2900750">network</span> <span m="2901170">as</span> <span m="2901670">a</span> <span m="2902020">global</span> <span m="2902330">namespace,</span> <span m="2902760">very much</span> <span m="2903130">like a file</span> <span m="2903250">system.</span> <span m="2903890">So</span> <span m="2904670">I</span> <span m="2904990">think</span> <span m="2905310">once</span> <span m="2906820">you</span> <span m="2907195">enter</span> <span m="2907570">capability</span> <span m="2907870">mode, you</span> <span m="2908170">cannot</span> <span m="2909100">create</span> <span m="2909620">a</span> <span m="2909640">new</span> <span m="2909990">socket.</span> <span m="2910660">Or</span> <span m="2911130">you cannot</span> <span m="2911730">create</span> <span m="2912035">a</span> <span m="2912340">new</span> <span m="2912590">socket and</span> <span m="2913180">connect to some</span> <span m="2913320">arbitrary</span> <span m="2914110">machine,</span> <span m="2914445">or to some</span> <span m="2914780">arbitrary</span> <span m="2915500">address</span> <span m="2915980">or</span> <span m="2916240">fort number.</span> <span m="2916820">You have to</span> <span m="2917200">basically</span> <span m="2918340">create</span> <span m="2918730">all</span> <span m="2918960">the</span> <span m="2919250">connections</span> <span m="2919720">you</span> <span m="2919820">want</span> <span m="2920520">ahead</span> <span m="2920710">of</span> <span m="2920840">time</span> <span m="2921170">and</span> <span m="2921500">fill</span> <span m="2921670">them</span> <span m="2921765">in</span> <span m="2921860">as</span> <span m="2921990">capabilities.</span> <span m="2922660">Or maybe</span> <span m="2922850">you'd have</span> <span m="2923330">to</span> <span m="2923500">get</span> <span m="2923730">them</span> <span m="2923880">from</span> <span m="2924060">someone</span> <span m="2924460">that will</span> <span m="2924670">pass</span> <span m="2925010">you a file</span> <span m="2925150">descriptor.</span> </p>
<p><span m="2926185">But</span> <span m="2926810">basically,</span> <span m="2927220">once</span> <span m="2927650">you're in</span> <span m="2927770">capability</span> <span m="2928000">mode,</span> <span m="2928750">the</span> <span m="2928870">set</span> <span m="2929215">of file</span> <span m="2929560">descriptors</span> <span m="2929830">you have</span> <span m="2929960">open</span> <span m="2930430">completely</span> <span m="2930790">enumerates</span> <span m="2931280">all</span> <span m="2931610">the</span> <span m="2931960">machines</span> <span m="2932290">you'll ever</span> <span m="2932450">talk to.</span> <span m="2932670">So</span> <span m="2932890">you</span> <span m="2933110">can</span> <span m="2933550">find</span> <span m="2933990">open connections.</span> <span m="2934430">Maybe you're</span> <span m="2934870">listening</span> <span m="2935280">on a forge.</span> <span m="2935560">That's</span> <span m="2936200">OK.</span> <span m="2937050">But</span> <span m="2937380">you cannot</span> <span m="2937810">connect</span> <span m="2938260">to</span> <span m="2938410">an</span> <span m="2938710">address</span> <span m="2939160">specified</span> <span m="2939790">by</span> <span m="2939980">an absolute</span> <span m="2940480">name,</span> <span m="2941040">kind of like a global</span> <span m="2941511">namespace</span> <span m="2941982">would</span> <span m="2942453">allow you to do it.</span> <span m="2943866">That make sense?</span> </p>
<p><span m="2945150">So</span> <span m="2945420">it's</span> <span m="2945790">access</span> <span m="2946100">through the</span> <span m="2946180">networking</span> <span m="2946650">namespace,</span> <span m="2947030">as</span> <span m="2947300">well.</span> <span m="2949310">What do they</span> <span m="2949540">do</span> <span m="2949900">for</span> <span m="2951080">processes?</span> <span m="2951840">So</span> <span m="2952390">another</span> <span m="2952740">global</span> <span m="2953150">namespace,</span> <span m="2953650">I guess,</span> <span m="2954150">in Unix, is the</span> <span m="2955020">the</span> <span m="2955340">PIDs</span> <span m="2955400">themselves.</span> <span m="2956670">So</span> <span m="2957160">the</span> <span m="2957470">example</span> <span m="2957960">of</span> <span m="2958010">a</span> <span m="2958060">system</span> <span m="2958340">call that</span> <span m="2958620">operates</span> <span m="2958875">in this</span> <span m="2959130">name</span> <span m="2959360">space</span> <span m="2959830">is "kill."</span> <span m="2960090">So</span> <span m="2960350">I</span> <span m="2960640">could</span> <span m="2960970">kill</span> <span m="2961240">PID</span> <span m="2962000">25.</span> <span m="2962565">And</span> <span m="2962860">I</span> <span m="2963360">could--</span> <span m="2963860">well,</span> <span m="2964200">presumably</span> <span m="2964350">I'll put a single</span> <span m="2964720">number</span> <span m="2964840">in there,</span> <span m="2965580">too.</span> </p>
<p><span m="2966110">But</span> <span m="2967020">I could</span> <span m="2967330">actually</span> <span m="2967560">kill</span> <span m="2967830">a</span> <span m="2968100">process</span> <span m="2968560">by its</span> <span m="2969270">PID</span> <span m="2970200">number.</span> <span m="2971040">How do they</span> <span m="2971410">fix</span> <span m="2971750">this</span> <span m="2972750">in</span> <span m="2973095">Capsicum?</span> <span m="2975320">What's</span> <span m="2975725">their plan?</span> <span m="2981553">Yeah?</span> </p>
<p><span m="2982539">AUDIENCE: File</span> <span m="2983032">descriptors with processes.</span> </p>
<p><span m="2984018">PROFESSOR: Yeah.</span> <span m="2984520">It's actually kind of</span> <span m="2984825">cool.</span> <span m="2985130">It's</span> <span m="2985390">like,</span> <span m="2985600">I</span> <span m="2985690">wish</span> <span m="2985970">Unix</span> <span m="2986150">had</span> <span m="2986440">this</span> <span m="2986690">all along.</span> <span m="2987300">Which</span> <span m="2987480">is</span> <span m="2987680">that,</span> <span m="2988760">instead</span> <span m="2989140">of</span> <span m="2989250">having</span> <span m="2989720">these</span> <span m="2989990">different</span> <span m="2990350">kinds</span> <span m="2990640">of</span> <span m="2990780">numbers</span> <span m="2991060">or</span> <span m="2991560">PIDs,</span> <span m="2991840">instead,</span> <span m="2992520">when</span> <span m="2993020">you</span> <span m="2993520">fork off</span> <span m="2993980">a</span> <span m="2994110">process,</span> <span m="2994630">actually</span> <span m="2994790">having</span> <span m="2994910">new</span> <span m="2995210">variant</span> <span m="2995420">of</span> <span m="2995720">fork</span> <span m="2996620">called</span> <span m="2997250">pdfork,</span> <span m="2997760">or</span> <span m="2999770">Process</span> <span m="3000190">Descriptor</span> <span m="3000650">Fork.</span> <span m="3001300">And</span> <span m="3001900">what</span> <span m="3002210">it does</span> <span m="3002530">is</span> <span m="3002640">when it</span> <span m="3002780">creates</span> <span m="3003060">a</span> <span m="3003250">child</span> <span m="3003710">process,</span> <span m="3004560">it</span> <span m="3004670">actually</span> <span m="3005330">sticks</span> <span m="3005760">a</span> <span m="3005900">reference</span> <span m="3006400">to</span> <span m="3006500">that</span> <span m="3006680">child</span> <span m="3007000">process</span> <span m="3007700">into</span> <span m="3007990">your</span> <span m="3008140">file</span> <span m="3008490">descriptor</span> <span m="3008770">table</span> <span m="3009130">somewhere.</span> </p>
<p><span m="3010320">And</span> <span m="3010580">this</span> <span m="3010690">is</span> <span m="3010910">your</span> <span m="3011000">new</span> <span m="3011230">process.</span> <span m="3011730">And you can</span> <span m="3012080">operate</span> <span m="3012620">on</span> <span m="3012800">a</span> <span m="3012900">child</span> <span m="3013250">process</span> <span m="3013700">by</span> <span m="3013970">specifying</span> <span m="3014580">the</span> <span m="3014640">file</span> <span m="3014870">descriptor</span> <span m="3015240">number.</span> <span m="3015972">Well,</span> <span m="3016072">it</span> <span m="3016173">would</span> <span m="3016273">be</span> <span m="3016374">pretty cool,</span> <span m="3016776">because you can now</span> <span m="3017178">pass</span> <span m="3017580">your</span> <span m="3018230">child</span> <span m="3018590">process</span> <span m="3018920">to</span> <span m="3019020">someone</span> <span m="3019340">else</span> <span m="3019550">and</span> <span m="3019640">say,</span> <span m="3019840">well,</span> <span m="3020040">if you</span> <span m="3020050">can</span> <span m="3020450">go and</span> <span m="3020740">kill</span> <span m="3020900">them</span> <span m="3021240">now,</span> <span m="3021580">or</span> <span m="3021740">you</span> <span m="3021830">can</span> <span m="3021930">manage this</span> <span m="3022370">process however you</span> <span m="3023110">want,</span> <span m="3024230">you'll</span> <span m="3024480">get</span> <span m="3024690">notifications</span> <span m="3025310">when</span> <span m="3025400">the</span> <span m="3025500">process</span> <span m="3025910">dies.</span> <span m="3026560">It'll</span> <span m="3027901">look</span> <span m="3028350">like</span> <span m="3028760">a</span> <span m="3028790">readable</span> <span m="3029045">file</span> <span m="3029300">descriptor,</span> <span m="3030160">et</span> <span m="3030360">cetera.</span> </p>
<p><span m="3031000">So</span> <span m="3031450">they</span> <span m="3031900">really</span> <span m="3032150">try to</span> <span m="3033350">homogenize</span> <span m="3033920">everything</span> <span m="3034530">into</span> <span m="3034710">looking</span> <span m="3035170">like</span> <span m="3035460">a</span> <span m="3035910">file</span> <span m="3036290">descriptor</span> <span m="3036680">of some sort</span> <span m="3037010">here.</span> <span m="3038930">And</span> <span m="3039050">with</span> <span m="3039410">these</span> <span m="3039770">kernel</span> <span m="3040180">changes,</span> <span m="3040680">you can</span> <span m="3040710">finally</span> <span m="3041330">have</span> <span m="3041560">all</span> <span m="3042272">the</span> <span m="3043000">functionalities</span> <span m="3043300">you</span> <span m="3043600">might</span> <span m="3043920">care</span> <span m="3044070">about.</span> <span m="3044330">You have the</span> <span m="3044590">support</span> <span m="3044990">for</span> <span m="3045110">sockets</span> <span m="3045450">already,</span> <span m="3046110">process</span> <span m="3046330">descriptors,</span> <span m="3046950">et</span> <span m="3047340">cetera.</span> <span m="3048160">And</span> <span m="3048560">you</span> <span m="3048740">have</span> <span m="3049010">a</span> <span m="3049080">way</span> <span m="3049340">of</span> <span m="3049820">constraining</span> <span m="3052350">what</span> <span m="3052990">the</span> <span m="3053090">process</span> <span m="3053440">can</span> <span m="3053610">do.</span> <span m="3053840">Because</span> <span m="3054270">it</span> <span m="3054410">cannot</span> <span m="3054925">refer</span> <span m="3055210">to</span> <span m="3055350">any of the</span> <span m="3055440">global</span> <span m="3055760">names</span> <span m="3056010">anymore</span> <span m="3056470">after</span> <span m="3056930">[INAUDIBLE].</span> </p>
<p><span m="3059690">All right.</span> <span m="3060610">Any questions?</span> <span m="3063050">So</span> <span m="3064310">here's</span> <span m="3064510">an</span> <span m="3064740">interesting</span> <span m="3065130">puzzle.</span> <span m="3065700">I was</span> <span m="3066300">trying</span> <span m="3066480">to</span> <span m="3066620">understand</span> <span m="3067070">from</span> <span m="3067200">the</span> <span m="3067310">paper.</span> <span m="3067820">They make</span> <span m="3068180">a</span> <span m="3068520">big</span> <span m="3068860">deal</span> <span m="3069100">about</span> <span m="3069770">dot dot</span> <span m="3070410">in</span> <span m="3071640">looking</span> <span m="3072050">up</span> <span m="3072190">directory</span> <span m="3072505">names.</span> <span m="3072820">So</span> <span m="3072920">they</span> <span m="3073020">basically</span> <span m="3073390">say,</span> <span m="3073670">well,</span> <span m="3074070">once you're</span> <span m="3074260">in</span> <span m="3074430">capability</span> <span m="3074960">mode,</span> <span m="3076210">when you pass</span> <span m="3076380">a</span> <span m="3076460">particular</span> <span m="3077930">name</span> <span m="3078480">to</span> <span m="3078680">openat,</span> <span m="3079430">you</span> <span m="3079540">cannot</span> <span m="3079970">use</span> <span m="3080380">dot dot</span> <span m="3080680">in those</span> <span m="3080890">names.</span> <span m="3081500">And</span> <span m="3081780">presumably,</span> <span m="3082100">if you have</span> <span m="3082220">a</span> <span m="3082610">Simulink,</span> <span m="3083040">if</span> <span m="3083305">a</span> <span m="3083570">Simulink's</span> <span m="3083760">target</span> <span m="3084410">contains</span> <span m="3084670">dot dot,</span> <span m="3085205">they</span> <span m="3085480">will</span> <span m="3085840">reject it</span> <span m="3086205">if</span> <span m="3086570">you're in</span> <span m="3086760">capability</span> <span m="3087030">mode.</span> </p>
<p><span m="3088780">So is</span> <span m="3089030">this</span> <span m="3089355">strictly</span> <span m="3089680">required?</span> <span m="3091830">Could</span> <span m="3092020">you</span> <span m="3092120">imagine</span> <span m="3092550">a</span> <span m="3092580">safe</span> <span m="3093010">design in</span> <span m="3093490">principle</span> <span m="3093980">that</span> <span m="3094140">allows</span> <span m="3094620">the</span> <span m="3094960">use</span> <span m="3095300">of</span> <span m="3095510">dot dot?</span> <span m="3100330">Yeah.</span> </p>
<p><span m="3101040">AUDIENCE: Well,</span> <span m="3101390">you'd need to</span> <span m="3101740">be</span> <span m="3102180">able to</span> <span m="3102430">find</span> <span m="3102785">whether they have</span> <span m="3103140">a</span> <span m="3103609">file</span> <span m="3103765">or</span> <span m="3103921">a</span> <span m="3104078">capability</span> <span m="3104547">that</span> <span m="3105016">allows</span> <span m="3105485">the</span> <span m="3105954">masses</span> <span m="3106423">to</span> <span m="3106579">the</span> <span m="3106735">parent</span> <span m="3106892">directory.</span> </p>
<p><span m="3107880">PROFESSOR: Right.</span> </p>
<p><span m="3108640">AUDIENCE: So it's</span> <span m="3108970">trivial to go</span> <span m="3109300">down,</span> <span m="3109670">because</span> <span m="3109940">any</span> <span m="3110630">subdirectory--</span> <span m="3111310">you already have</span> <span m="3112182">access</span> <span m="3112618">to it by</span> <span m="3113054">having</span> <span m="3113199">the</span> <span m="3113344">capability.</span> </p>
<p><span m="3113490">PROFESSOR: That's</span> <span m="3113930">right.</span> <span m="3114190">Yeah.</span> </p>
<p><span m="3114740">AUDIENCE: But going</span> <span m="3115150">up,</span> <span m="3115490">you need</span> <span m="3115700">to</span> <span m="3115760">see</span> <span m="3116050">whether</span> <span m="3116380">you</span> <span m="3116645">have any</span> <span m="3116910">capabilities for the</span> <span m="3117396">parent directory.</span> </p>
<p><span m="3119340">PROFESSOR: That's</span> <span m="3119590">right.</span> <span m="3119810">Yeah.</span> </p>
<p><span m="3120300">AUDIENCE: Search</span> <span m="3120680">for</span> <span m="3120806">it</span> <span m="3120933">somehow.</span> </p>
<p><span m="3121060">PROFESSOR: Yeah.</span> <span m="3121220">So that's</span> <span m="3121420">a</span> <span m="3121570">little bit</span> <span m="3121700">tricky.</span> <span m="3121955">And</span> <span m="3122210">also, it</span> <span m="3122860">goes</span> <span m="3123050">against</span> <span m="3123330">the</span> <span m="3123400">grain of this</span> <span m="3123710">whole</span> <span m="3123930">explicit</span> <span m="3124800">authority</span> <span m="3125500">thing.</span> <span m="3126490">What about if</span> <span m="3127080">you're</span> <span m="3127810">using</span> <span m="3128150">dot dot</span> <span m="3128920">inside</span> <span m="3129690">sort of</span> <span m="3130170">a</span> <span m="3130220">single</span> <span m="3130750">open</span> <span m="3131160">call?</span> <span m="3131415">So</span> <span m="3131670">for</span> <span m="3131790">example,</span> <span m="3132440">what</span> <span m="3132600">if</span> <span m="3132730">you</span> <span m="3133220">call</span> <span m="3133590">something</span> <span m="3133910">like</span> <span m="3134580">openat</span> <span m="3135650">some</span> <span m="3135800">particular</span> <span m="3136290">directory or</span> <span m="3136620">file descriptor</span> <span m="3137030">number,</span> <span m="3138050">and</span> <span m="3138260">you open</span> <span m="3138840">something</span> <span m="3139290">like,</span> <span m="3139500">I don't know,</span> <span m="3139850">b/c/../..?</span> </p>
<p><span m="3146690">In</span> <span m="3146860">principle,</span> <span m="3147280">this</span> <span m="3147450">might</span> <span m="3147705">be</span> <span m="3147960">safe,</span> <span m="3148530">right?</span> <span m="3148910">Because</span> <span m="3149390">you</span> <span m="3149890">go down</span> <span m="3150080">some directory,</span> <span m="3150410">and then</span> <span m="3150890">you just</span> <span m="3151290">climb</span> <span m="3151630">back</span> <span m="3151990">up out of</span> <span m="3152435">it.</span> <span m="3153770">Yeah?</span> </p>
<p><span m="3154660">AUDIENCE: What</span> <span m="3154850">if</span> <span m="3154960">c</span> <span m="3155320">is</span> <span m="3155630">[INAUDIBLE]?</span> </p>
<p><span m="3157170">PROFESSOR: Yeah.</span> <span m="3157490">So</span> <span m="3157810">it's a little bit</span> <span m="3157980">tricky,</span> <span m="3158220">of</span> <span m="3158320">course,</span> <span m="3158560">to define</span> <span m="3159030">exactly</span> <span m="3159350">what</span> <span m="3159550">it</span> <span m="3159670">means</span> <span m="3159960">to</span> <span m="3160080">be</span> <span m="3160380">safe.</span> <span m="3160890">Right?</span> <span m="3161070">You</span> <span m="3161180">probably</span> <span m="3161860">have</span> <span m="3162050">to</span> <span m="3162240">make</span> <span m="3162480">sure</span> <span m="3162710">that</span> <span m="3162930">c</span> <span m="3163370">isn't</span> <span m="3163860">a</span> <span m="3163980">Simulink</span> <span m="3164260">that goes</span> <span m="3164610">somewhere</span> <span m="3165080">else</span> <span m="3165440">and</span> <span m="3165800">so on.</span> <span m="3166230">Yeah.</span> <span m="3166660">That's a fairly</span> <span m="3167090">tricky proposition,</span> <span m="3167520">to get this right.</span> <span m="3168190">And</span> <span m="3168420">I</span> <span m="3168560">think,</span> <span m="3169060">in</span> <span m="3169200">the</span> <span m="3169320">paper,</span> <span m="3169730">what they basically</span> <span m="3170090">argue</span> <span m="3170380">about</span> <span m="3170610">is</span> <span m="3170690">that it's</span> <span m="3171700">actually</span> <span m="3172000">quite</span> <span m="3172300">difficult</span> <span m="3172630">in</span> <span m="3172760">practice</span> <span m="3173400">to</span> <span m="3173460">implement</span> <span m="3173840">a</span> <span m="3173910">set</span> <span m="3174270">of checks</span> <span m="3174630">that's</span> <span m="3174870">sufficient</span> <span m="3175330">and</span> <span m="3176340">bypasses</span> <span m="3177110">all the</span> <span m="3177300">possible</span> <span m="3177730">rate</span> <span m="3177990">conditions</span> <span m="3178450">here.</span> <span m="3179640">So</span> <span m="3179920">they</span> <span m="3180387">basically</span> <span m="3180854">just do the</span> <span m="3181790">conservative thing and</span> <span m="3182480">disallow</span> <span m="3182660">any</span> <span m="3182710">dot dot</span> <span m="3182930">at</span> <span m="3183040">any time</span> <span m="3184190">once</span> <span m="3184725">you're in</span> <span m="3185100">capability mode.</span> </p>
<p><span m="3187520">There's</span> <span m="3187950">some</span> <span m="3188380">interesting</span> <span m="3188720">rate</span> <span m="3188900">conditions</span> <span m="3189330">you could come up with</span> <span m="3189550">here.</span> <span m="3190250">The</span> <span m="3191290">lecture notes</span> <span m="3191820">have</span> <span m="3193330">more</span> <span m="3193500">details.</span> <span m="3194000">But</span> <span m="3194860">basically</span> <span m="3194980">I</span> <span m="3195430">think these</span> <span m="3195600">guys</span> <span m="3195730">are</span> <span m="3196010">being</span> <span m="3196310">extra</span> <span m="3196610">cautious</span> <span m="3197140">in</span> <span m="3197820">defining</span> <span m="3198300">what's</span> <span m="3198480">allowed</span> <span m="3198560">and</span> <span m="3198760">what's not</span> <span m="3198910">allowed</span> <span m="3199210">in</span> <span m="3199510">capability</span> <span m="3199965">mode.</span> <span m="3202700">OK.</span> </p>
<p><span m="3203567">So</span> <span m="3203664">here,</span> <span m="3203761">to</span> <span m="3203859">answer</span> <span m="3203956">your</span> <span m="3204054">question,</span> <span m="3206002">once you</span> <span m="3206490">enter</span> <span m="3206690">capability</span> <span m="3206790">mode,</span> <span m="3206970">it seems to</span> <span m="3207170">be</span> <span m="3207400">all</span> <span m="3207750">controlled</span> <span m="3208490">by</span> <span m="3208750">your</span> <span m="3209310">file</span> <span m="3209690">table.</span> <span m="3210505">Does</span> <span m="3210900">your</span> <span m="3211690">UID</span> <span m="3212380">still</span> <span m="3212600">matter,</span> <span m="3212875">once you enter</span> <span m="3213150">capability mode?</span> <span m="3221020">[INAUDIBLE].</span> <span m="3223340">Yeah?</span> </p>
<p><span m="3224080">AUDIENCE: Well,</span> <span m="3224345">you could</span> <span m="3224610">still</span> <span m="3225040">launch a</span> <span m="3225320">process</span> <span m="3225600">that</span> <span m="3226456">doesn't use</span> <span m="3226884">capabilities.</span> </p>
<p><span m="3228170">PROFESSOR: No.</span> <span m="3228660">Actually,</span> <span m="3228920">no,</span> <span m="3229240">you can't.</span> <span m="3230400">You</span> <span m="3230480">have</span> <span m="3230690">to</span> <span m="3230790">make</span> <span m="3230990">sure</span> <span m="3231280">that--</span> <span m="3231970">otherwise you could</span> <span m="3232260">escape,</span> <span m="3232520">like</span> <span m="3232780">well,</span> <span m="3232900">I can't</span> <span m="3233150">access--</span> <span m="3233425">why don't you run</span> <span m="3233740">this</span> <span m="3234230">guy?</span> <span m="3234800">[INAUDIBLE].</span> <span m="3236258">So yeah,</span> <span m="3237720">cap_enter</span> <span m="3238050">is</span> <span m="3238230">inherited</span> <span m="3238680">by</span> <span m="3238800">all</span> <span m="3239090">the</span> <span m="3239190">children,</span> <span m="3239500">which is</span> <span m="3239570">actually</span> <span m="3239910">hugely</span> <span m="3240320">important.</span> <span m="3241610">Yeah?</span> </p>
<p></p>
<p><span m="3246000">Anyone</span> <span m="3246320">else?</span> <span m="3249190">So</span> <span m="3249200">what</span> <span m="3249570">if</span> <span m="3249750">we</span> <span m="3249970">kill</span> <span m="3250020">the</span> <span m="3250070">UID?</span> <span m="3250990">So it's</span> <span m="3251580">supposed</span> <span m="3251940">to be</span> <span m="3252260">like</span> <span m="3252610">going</span> <span m="3252870">to</span> <span m="3253000">cap_enter,</span> <span m="3253720">and</span> <span m="3253980">we</span> <span m="3254160">just</span> <span m="3254400">kill</span> <span m="3254730">the</span> <span m="3254900">UID</span> <span m="3254980">of the</span> <span m="3255390">current process.</span> <span m="3255590">We</span> <span m="3255960">don't actually</span> <span m="3256330">care</span> <span m="3256590">what</span> <span m="3256820">it is</span> <span m="3256950">anymore.</span> <span m="3257510">And</span> <span m="3257850">then the process</span> <span m="3258010">tries</span> <span m="3258540">to</span> <span m="3258700">open</span> <span m="3258900">a</span> <span m="3258950">file.</span> <span m="3259225">What</span> <span m="3259500">checks</span> <span m="3259870">should</span> <span m="3260213">apply?</span> <span m="3262361">Yeah?</span> </p>
<p><span m="3262850">AUDIENCE: Oh, I</span> <span m="3263140">was</span> <span m="3263430">thinking</span> <span m="3263770">that</span> <span m="3264260">the</span> <span m="3264690">UID</span> <span m="3265070">is</span> <span m="3265485">useful for</span> <span m="3265900">logging</span> <span m="3266295">purposes as well,</span> <span m="3266690">like</span> <span m="3266945">being</span> <span m="3267200">able</span> <span m="3267680">to tell</span> <span m="3268000">if you did something.</span> </p>
<p><span m="3268580">PROFESSOR: So yeah,</span> <span m="3268855">you're right.</span> <span m="3269130">Actually, yeah.</span> <span m="3269460">So</span> <span m="3269770">that would</span> <span m="3270080">be actually</span> <span m="3270180">kind of damaging,</span> <span m="3270450">right?</span> <span m="3270930">Like I</span> <span m="3271090">spawned</span> <span m="3271450">some</span> <span m="3271990">sandbox</span> <span m="3272630">process</span> <span m="3273010">on</span> <span m="3273090">my</span> <span m="3273200">machine</span> <span m="3273500">and it</span> <span m="3273720">loses</span> <span m="3274130">the</span> <span m="3274210">UID.</span> <span m="3274940">I'm like</span> <span m="3275170">I have a hundred</span> <span m="3276050">processes</span> <span m="3276340">running</span> <span m="3276460">on</span> <span m="3276580">my</span> <span m="3276700">machine,</span> <span m="3276890">and</span> <span m="3277190">I</span> <span m="3277380">have</span> <span m="3277770">no idea</span> <span m="3277853">what</span> <span m="3278060">they are.</span> </p>
<p><span m="3278730">So that's</span> <span m="3278830">probably not</span> <span m="3279070">a</span> <span m="3279380">good plan</span> <span m="3279600">for a management</span> <span m="3279935">purpose.</span> <span m="3280400">You're</span> <span m="3280490">absolutely</span> <span m="3280870">right.</span> <span m="3281555">But I'm just</span> <span m="3282020">sort of</span> <span m="3282320">hypothetically</span> <span m="3282970">saying,</span> <span m="3283200">well,</span> <span m="3284220">do</span> <span m="3284400">we</span> <span m="3284660">need it for</span> <span m="3284920">access control,</span> <span m="3285370">I guess.</span> <span m="3285920">Yeah?</span> </p>
<p><span m="3286750">AUDIENCE: Maybe</span> <span m="3287130">if this</span> <span m="3287340">UID</span> <span m="3287990">is only</span> <span m="3288280">supposed</span> <span m="3288680">to</span> <span m="3288770">be</span> <span m="3288920">able</span> <span m="3289180">to</span> <span m="3289320">access</span> <span m="3289800">this</span> <span m="3290010">file</span> <span m="3290310">by</span> <span m="3290480">reading</span> <span m="3290790">or</span> <span m="3291090">whatever,</span> <span m="3291876">but</span> <span m="3292362">you have the</span> <span m="3292848">file descriptor</span> <span m="3293334">for it,</span> <span m="3294220">but then if</span> <span m="3294620">you</span> <span m="3294780">lose</span> <span m="3294900">the</span> <span m="3295040">UID,</span> <span m="3295110">you</span> <span m="3295450">might</span> <span m="3295830">get</span> <span m="3296040">permissions to</span> <span m="3296460">write</span> <span m="3296823">[INAUDIBLE]</span> <span m="3297186">or something?</span> </p>
<p><span m="3297960">PROFESSOR: Yeah.</span> <span m="3298780">I</span> <span m="3299310">think</span> <span m="3299540">actually</span> <span m="3299850">what</span> <span m="3300160">it shows</span> <span m="3300270">up in</span> <span m="3301090">is</span> <span m="3301980">in</span> <span m="3302420">directories.</span> <span m="3303410">Because</span> <span m="3303760">once you</span> <span m="3304080">add</span> <span m="3304240">a</span> <span m="3304400">capability</span> <span m="3304490">to</span> <span m="3304830">a</span> <span m="3304960">file,</span> <span m="3305340">that's basically it.</span> <span m="3306120">You</span> <span m="3306510">have it open</span> <span m="3306750">with</span> <span m="3306870">particular</span> <span m="3307280">privileges,</span> <span m="3308060">et cetera.</span> <span m="3308600">But</span> <span m="3308820">the</span> <span m="3308920">problem</span> <span m="3309220">is</span> <span m="3309370">that</span> <span m="3309910">they</span> <span m="3310020">have</span> <span m="3310160">this</span> <span m="3310320">hybrid</span> <span m="3310770">design</span> <span m="3311230">where</span> <span m="3311520">they</span> <span m="3311720">say,</span> <span m="3311860">well,</span> <span m="3312590">you</span> <span m="3312830">can actually</span> <span m="3313040">add</span> <span m="3313280">capabilities</span> <span m="3313560">to</span> <span m="3313840">directories,</span> <span m="3314300">and you can open</span> <span m="3314480">a</span> <span m="3314770">new</span> <span m="3315050">file</span> <span m="3315510">as</span> <span m="3315730">you're</span> <span m="3315930">running</span> <span m="3316160">along.</span> <span m="3317030">And</span> <span m="3317460">it</span> <span m="3317590">might</span> <span m="3317820">be</span> <span m="3317940">the</span> <span m="3318060">case</span> <span m="3318480">that</span> <span m="3318640">you</span> <span m="3318750">add</span> <span m="3318890">a</span> <span m="3319030">capability</span> <span m="3319375">to</span> <span m="3319720">a</span> <span m="3319920">directory,</span> <span m="3320840">like</span> <span m="3321180">/etc.</span> <span m="3322220">And</span> <span m="3322530">you</span> <span m="3322600">don't</span> <span m="3322770">have</span> <span m="3322890">access</span> <span m="3323180">to</span> <span m="3323450">necessarily</span> <span m="3323550">all</span> <span m="3323860">the</span> <span m="3324155">files</span> <span m="3324450">in</span> <span m="3324780">/etc.</span> <span m="3325520">But</span> <span m="3326060">once</span> <span m="3326240">you</span> <span m="3326500">enter</span> <span m="3326680">capability</span> <span m="3326940">mode,</span> <span m="3327440">you</span> <span m="3327630">can</span> <span m="3327920">now</span> <span m="3328190">try to</span> <span m="3328460">open</span> <span m="3328760">those</span> <span m="3328970">files</span> <span m="3329330">by</span> <span m="3329490">saying,</span> <span m="3329620">well,</span> <span m="3329860">I</span> <span m="3329920">have</span> <span m="3330110">access</span> <span m="3330400">to</span> <span m="3330480">the</span> <span m="3330620">/etc</span> <span m="3331270">directory.</span> <span m="3331840">It's open</span> <span m="3332130">already.</span> <span m="3332850">Why</span> <span m="3333080">don't</span> <span m="3333210">you</span> <span m="3333290">give</span> <span m="3333530">me</span> <span m="3333800">the</span> <span m="3333910">file</span> <span m="3334265">named</span> <span m="3334620">password</span> <span m="3335030">in</span> <span m="3335110">that</span> <span m="3335270">directory?</span> </p>
<p><span m="3336060">And</span> <span m="3336480">the</span> <span m="3336600">kernel</span> <span m="3336920">still</span> <span m="3337350">needs</span> <span m="3337540">to</span> <span m="3337630">make</span> <span m="3337870">an</span> <span m="3338370">access control</span> <span m="3338390">decision</span> <span m="3338780">on whether</span> <span m="3339070">to</span> <span m="3339140">allow</span> <span m="3339620">you</span> <span m="3339790">to</span> <span m="3339950">open</span> <span m="3340550">a</span> <span m="3340640">file</span> <span m="3341050">in</span> <span m="3341230">that</span> <span m="3341380">directory</span> <span m="3342090">with</span> <span m="3342440">either</span> <span m="3342540">read</span> <span m="3342835">mode or</span> <span m="3343130">write</span> <span m="3343410">mode</span> <span m="3343685">or</span> <span m="3343960">what</span> <span m="3344100">have</span> <span m="3344410">you.</span> <span m="3345010">So</span> <span m="3345160">I</span> <span m="3345500">think</span> <span m="3345750">this is the</span> <span m="3346140">one</span> <span m="3346320">place</span> <span m="3346620">where</span> <span m="3346800">you</span> <span m="3346930">still</span> <span m="3347210">need</span> <span m="3347490">this</span> <span m="3347680">ambient</span> <span m="3348140">privilege,</span> <span m="3348620">to</span> <span m="3348710">some</span> <span m="3348890">extent,</span> <span m="3349680">because</span> <span m="3350290">they're</span> <span m="3350620">trying</span> <span m="3350950">to</span> <span m="3351030">build</span> <span m="3351430">this</span> <span m="3352030">compatible</span> <span m="3352580">design</span> <span m="3353080">where you can</span> <span m="3353590">have</span> <span m="3354190">semi-natural</span> <span m="3355430">semantics</span> <span m="3355960">for</span> <span m="3356310">how directories</span> <span m="3356780">work.</span> <span m="3357670">Does</span> <span m="3358070">that</span> <span m="3358470">make</span> <span m="3358530">sense?</span> <span m="3359410">it's like</span> <span m="3359960">one</span> <span m="3360410">leftover</span> <span m="3361100">place,</span> <span m="3361620">kind of</span> <span m="3361900">for</span> <span m="3362350">compatibility</span> <span m="3362920">reasons,</span> <span m="3363960">or</span> <span m="3364220">at</span> <span m="3364570">least</span> <span m="3364790">the way that</span> <span m="3365240">Unix</span> <span m="3365724">file systems are typically set up.</span> </p>
<p><span m="3367660">AUDIENCE: Are there</span> <span m="3368144">any other places?</span> </p>
<p><span m="3370080">PROFESSOR: Good</span> <span m="3370290">question.</span> <span m="3370690">I</span> <span m="3370800">couldn't</span> <span m="3371190">think</span> <span m="3371380">of</span> <span m="3371650">one</span> <span m="3371880">off hand,</span> <span m="3372240">but</span> <span m="3372555">I guess I</span> <span m="3372870">would have to</span> <span m="3373332">get</span> <span m="3373794">their</span> <span m="3373948">previous</span> <span m="3374102">desource</span> <span m="3374256">code</span> <span m="3374720">to really</span> <span m="3375150">figure</span> <span m="3375390">out</span> <span m="3375880">what's</span> <span m="3376590">going</span> <span m="3376860">on.</span> <span m="3377980">I</span> <span m="3378010">think</span> <span m="3378260">most</span> <span m="3378500">of</span> <span m="3378550">the</span> <span m="3378610">other</span> <span m="3378960">situations</span> <span m="3380150">don't</span> <span m="3380540">really</span> <span m="3380920">require</span> <span m="3381255">a</span> <span m="3381590">UID</span> <span m="3382100">check.</span> <span m="3382380">Because</span> <span m="3382890">for</span> <span m="3383130">networking,</span> <span m="3383500">it doesn't show up.</span> <span m="3383860">I</span> <span m="3384230">think</span> <span m="3384600">for</span> <span m="3384930">process</span> <span m="3385260">descriptors</span> <span m="3385590">it doesn't</span> <span m="3386044">show up,</span> <span m="3386498">either.</span> <span m="3387406">If</span> <span m="3387860">you have</span> <span m="3388270">it, then you just</span> <span m="3388680">have it.</span> <span m="3389660">So</span> <span m="3390150">I</span> <span m="3390230">think</span> <span m="3390370">it probably</span> <span m="3390500">is</span> <span m="3390950">just</span> <span m="3391760">file</span> <span m="3392020">system</span> <span m="3392560">operations.</span> </p>
<p><span m="3393630">For</span> <span m="3393730">shared</span> <span m="3393950">memory,</span> <span m="3394350">it's</span> <span m="3394490">also--</span> <span m="3394750">once you have</span> <span m="3395010">a</span> <span m="3395140">shared</span> <span m="3395690">memory</span> <span m="3395920">segment,</span> <span m="3396560">you have</span> <span m="3396875">it</span> <span m="3397440">open.</span> <span m="3401232">Yeah?</span> </p>
<p><span m="3402720">AUDIENCE: Could you explain again</span> <span m="3403216">how</span> <span m="3403712">exactly</span> <span m="3404208">the</span> <span m="3404704">user</span> <span m="3405200">ID</span> <span m="3405696">matters</span> <span m="3406192">if you have a</span> <span m="3406688">capability?</span> </p>
<p><span m="3407680">PROFESSOR: Yeah.</span> <span m="3408070">So</span> <span m="3408430">I</span> <span m="3408540">think</span> <span m="3408790">where</span> <span m="3409562">it</span> <span m="3410610">matters</span> <span m="3410920">is,</span> <span m="3411430">you</span> <span m="3411500">have</span> <span m="3411810">a</span> <span m="3411960">capability</span> <span m="3412370">to a</span> <span m="3412680">directory.</span> <span m="3414910">The</span> <span m="3415080">question</span> <span m="3415400">is,</span> <span m="3415540">what</span> <span m="3415750">does</span> <span m="3415790">the</span> <span m="3415950">capability</span> <span m="3416520">represent?</span> <span m="3417770">So</span> <span m="3418550">one</span> <span m="3418840">interpretation</span> <span m="3419560">that--</span> <span m="3420030">for</span> <span m="3420130">example,</span> <span m="3420450">some</span> <span m="3420670">capability</span> <span m="3421260">system</span> <span m="3421700">state,</span> <span m="3421850">not</span> <span m="3422210">Capsicum.</span> <span m="3423140">Pure</span> <span m="3423410">capability</span> <span m="3423770">systems.</span> <span m="3424130">They</span> <span m="3424310">say,</span> <span m="3424480">well,</span> <span m="3424790">if you</span> <span m="3425020">have</span> <span m="3425180">a</span> <span m="3425270">capability</span> <span m="3425860">to</span> <span m="3426130">a</span> <span m="3426590">directory,</span> <span m="3426870">then of course</span> <span m="3427030">you have access to all the</span> <span m="3427370">files</span> <span m="3427710">in that</span> <span m="3429140">directory,</span> <span m="3429485">no</span> <span m="3429830">questions</span> <span m="3430160">about it.</span> </p>
<p><span m="3431490">And</span> <span m="3431880">in</span> <span m="3432050">Unix,</span> <span m="3432310">this is</span> <span m="3432635">typically not the</span> <span m="3432960">case.</span> <span m="3433225">You can</span> <span m="3433700">open</span> <span m="3434120">a</span> <span m="3434190">directory</span> <span m="3434830">like</span> <span m="3435180">/etc,</span> <span m="3436110">but</span> <span m="3436280">there's</span> <span m="3436490">lots</span> <span m="3437070">of</span> <span m="3437230">system files</span> <span m="3437690">in</span> <span m="3437850">there</span> <span m="3438170">that are</span> <span m="3438380">maybe</span> <span m="3438670">private,</span> <span m="3439160">like</span> <span m="3439310">the</span> <span m="3439410">private</span> <span m="3439860">key</span> <span m="3440010">of your</span> <span m="3440410">server</span> <span m="3440780">is stored in</span> <span m="3441530">there.</span> <span m="3442210">And</span> <span m="3442320">just because</span> <span m="3442560">you can</span> <span m="3442890">look</span> <span m="3443300">at</span> <span m="3443360">a</span> <span m="3443420">directory</span> <span m="3443910">and open it</span> <span m="3444250">and</span> <span m="3444430">list it</span> <span m="3445020">doesn't mean that</span> <span m="3445270">you cannot</span> <span m="3446090">open</span> <span m="3446320">the</span> <span m="3446410">files</span> <span m="3446820">in that</span> <span m="3447070">directory.</span> </p>
<p><span m="3448310">So</span> <span m="3448760">in</span> <span m="3449140">Capsicum,</span> <span m="3449200">if</span> <span m="3449810">you open</span> <span m="3450270">a</span> <span m="3450610">directory</span> <span m="3450830">like</span> <span m="3451180">/etc,</span> <span m="3452490">and</span> <span m="3452930">then you enter</span> <span m="3453300">capability</span> <span m="3453680">mode.</span> <span m="3453850">And then you</span> <span m="3454020">say,</span> <span m="3454130">well,</span> <span m="3454500">hey,</span> <span m="3454990">I</span> <span m="3455100">don't</span> <span m="3455190">know</span> <span m="3455360">what this</span> <span m="3455500">directory</span> <span m="3455850">is.</span> <span m="3456200">I</span> <span m="3456292">just</span> <span m="3456385">add</span> <span m="3456477">a</span> <span m="3456570">file</span> <span m="3456940">descriptor to it.</span> <span m="3457290">There's</span> <span m="3457630">a</span> <span m="3458090">file in there</span> <span m="3458280">called</span> <span m="3458630">"key."</span> <span m="3459342">Why don't</span> <span m="3459700">you open</span> <span m="3459910">that</span> <span m="3460120">file</span> <span m="3460510">"key"?</span> <span m="3461390">And</span> <span m="3461940">at</span> <span m="3462030">this</span> <span m="3462200">point,</span> <span m="3463340">you</span> <span m="3463500">probably</span> <span m="3463770">don't</span> <span m="3464070">want</span> <span m="3464230">to allow</span> <span m="3464620">this</span> <span m="3464810">capability-based</span> <span m="3465950">processor</span> <span m="3466270">to just</span> <span m="3466590">open</span> <span m="3467020">it,</span> <span m="3467506">because that wasn't the</span> <span m="3467992">intent.</span> </p>
<p><span m="3468480">They'll</span> <span m="3469140">allow</span> <span m="3469300">you to</span> <span m="3469670">bypass</span> <span m="3470340">the</span> <span m="3470430">Unix</span> <span m="3470790">permissions</span> <span m="3471170">on</span> <span m="3471270">a</span> <span m="3471330">file.</span> <span m="3472060">So</span> <span m="3472230">I</span> <span m="3472300">think</span> <span m="3472510">the</span> <span m="3473020">authors</span> <span m="3473420">of</span> <span m="3473540">this</span> <span m="3473820">paper</span> <span m="3474250">are</span> <span m="3474710">careful</span> <span m="3475200">to</span> <span m="3475350">design</span> <span m="3475750">a</span> <span m="3475800">system</span> <span m="3476130">which</span> <span m="3476480">would</span> <span m="3477170">not</span> <span m="3479440">violate</span> <span m="3479850">existing</span> <span m="3480600">security</span> <span m="3480960">mechanisms.</span> </p>
<p><span m="3481600">AUDIENCE:</span> <span m="3482077">So you're saying</span> <span m="3482554">that you can,</span> <span m="3483031">in some</span> <span m="3483508">cases,</span> <span m="3484462">use</span> <span m="3484939">a</span> <span m="3485416">combination of the two?</span> <span m="3486370">So</span> <span m="3486847">even</span> <span m="3486942">though</span> <span m="3487037">it'll</span> <span m="3487133">be</span> <span m="3487228">able</span> <span m="3487324">to</span> <span m="3487483">change</span> <span m="3487642">it</span> <span m="3487801">to</span> <span m="3488278">directory,</span> <span m="3488760">inside the directory,</span> <span m="3489095">which</span> <span m="3489430">files you can</span> <span m="3489650">access</span> <span m="3490000">depends on</span> <span m="3490812">your</span> <span m="3491274">user ID?</span> </p>
<p><span m="3492200">PROFESSOR: Yeah,</span> <span m="3492460">exactly.</span> <span m="3492880">So</span> <span m="3493310">in</span> <span m="3493660">Capsicum,</span> <span m="3494600">the</span> <span m="3494870">way</span> <span m="3495010">they</span> <span m="3495470">get</span> <span m="3495900">it</span> <span m="3496030">to work in</span> <span m="3496370">practice</span> <span m="3496645">is</span> <span m="3496920">that,</span> <span m="3497340">actually,</span> <span m="3497540">before</span> <span m="3498270">you</span> <span m="3498480">enter</span> <span m="3498870">capability</span> <span m="3499195">mode,</span> <span m="3499890">you</span> <span m="3500220">have to</span> <span m="3500550">guess.</span> <span m="3500770">Well,</span> <span m="3501045">what files</span> <span m="3501320">am I</span> <span m="3501580">going</span> <span m="3501680">to</span> <span m="3501810">need</span> <span m="3502090">later?</span> <span m="3502415">I'm going to need</span> <span m="3502740">some</span> <span m="3503420">shared</span> <span m="3503700">libraries.</span> <span m="3503970">I'll need</span> <span m="3504240">some</span> <span m="3504540">text</span> <span m="3504800">files.</span> <span m="3505060">I'll need</span> <span m="3506320">some</span> <span m="3506740">templates.</span> <span m="3507020">I'll need some</span> <span m="3507260">network</span> <span m="3507570">connections,</span> <span m="3507975">et</span> <span m="3508380">cetera.</span> <span m="3508560">So you open</span> <span m="3509280">all</span> <span m="3509450">these</span> <span m="3509600">things</span> <span m="3509740">ahead of time.</span> </p>
<p><span m="3510960">And</span> <span m="3511450">you</span> <span m="3511550">don't</span> <span m="3511820">always</span> <span m="3512120">necessarily</span> <span m="3512510">know</span> <span m="3512720">which</span> <span m="3512900">exact</span> <span m="3513280">file</span> <span m="3513560">you</span> <span m="3513710">need.</span> <span m="3513970">So</span> <span m="3514170">what</span> <span m="3514320">these</span> <span m="3514400">guys</span> <span m="3514720">support as</span> <span m="3515140">well,</span> <span m="3515765">you can</span> <span m="3516040">actually</span> <span m="3516370">just</span> <span m="3516510">open</span> <span m="3516770">a</span> <span m="3516870">directory</span> <span m="3517540">file</span> <span m="3517790">descriptor,</span> <span m="3518045">as</span> <span m="3518300">well.</span> <span m="3518780">And then</span> <span m="3518980">I</span> <span m="3519470">can look</span> <span m="3519740">up</span> <span m="3519850">the</span> <span m="3519950">particular</span> <span m="3520340">files</span> <span m="3520730">later.</span> <span m="3521760">But</span> <span m="3521970">it</span> <span m="3522060">might</span> <span m="3522167">be</span> <span m="3522275">that</span> <span m="3522382">the</span> <span m="3522490">files</span> <span m="3522710">don't</span> <span m="3522960">have</span> <span m="3523130">all</span> <span m="3523300">the same</span> <span m="3523400">permissions.</span> <span m="3524050">So</span> <span m="3524790">that's</span> <span m="3524950">exactly</span> <span m="3525280">the reason,</span> <span m="3525773">yeah.</span> <span m="3526760">Make sense?</span> <span m="3529610">All right.</span> </p>
<p><span m="3530940">So</span> <span m="3531410">this is</span> <span m="3531790">the</span> <span m="3532090">kernel</span> <span m="3532410">mechanism</span> <span m="3533080">part</span> <span m="3533350">of</span> <span m="3533450">it.</span> <span m="3535560">Why</span> <span m="3535800">do</span> <span m="3536250">they</span> <span m="3536350">also need</span> <span m="3536930">this</span> <span m="3537470">library</span> <span m="3538440">for</span> <span m="3539330">libcapsicum?</span> <span m="3541830">I</span> <span m="3541880">guess</span> <span m="3542020">there's</span> <span m="3542300">two</span> <span m="3542470">things</span> <span m="3542790">that</span> <span m="3542840">they</span> <span m="3543850">support</span> <span m="3544130">in that library,</span> <span m="3544410">as</span> <span m="3544820">far</span> <span m="3544920">as</span> <span m="3545220">I can tell,</span> <span m="3545760">or</span> <span m="3546310">two</span> <span m="3546690">main things.</span> <span m="3547330">One</span> <span m="3547650">is</span> <span m="3547780">that they</span> <span m="3548150">implement</span> <span m="3548900">this</span> <span m="3549250">function</span> <span m="3550180">they</span> <span m="3550330">call</span> <span m="3550810">lch_start</span> <span m="3555342">that</span> <span m="3556250">you</span> <span m="3556540">should</span> <span m="3557030">use</span> <span m="3557520">instead</span> <span m="3558500">of</span> <span m="3559480">cap_enter.</span> <span m="3561930">And</span> <span m="3563180">the</span> <span m="3563280">other</span> <span m="3563850">sort</span> <span m="3564000">of</span> <span m="3564150">feature</span> <span m="3564730">the</span> <span m="3564800">library</span> <span m="3565180">provides</span> <span m="3565600">in</span> <span m="3565740">libcapsicum</span> <span m="3566672">is</span> <span m="3567060">this</span> <span m="3567870">notion</span> <span m="3568270">called</span> <span m="3568570">fd lists</span> <span m="3571120">instead</span> <span m="3571440">of</span> <span m="3571580">passing</span> <span m="3571910">file</span> <span m="3572070">descriptors</span> <span m="3572455">by</span> <span m="3572740">number.</span> </p>
<p><span m="3573600">So</span> <span m="3573740">this</span> <span m="3574010">fd list</span> <span m="3574280">thing</span> <span m="3574520">is</span> <span m="3574750">probably</span> <span m="3575030">the</span> <span m="3575210">easiest</span> <span m="3575530">thing</span> <span m="3575710">to</span> <span m="3575790">explain.</span> <span m="3576460">It's</span> <span m="3577550">basically</span> <span m="3577850">a</span> <span m="3578040">generalization,</span> <span m="3578950">or</span> <span m="3579060">maybe</span> <span m="3579500">a</span> <span m="3580340">clean</span> <span m="3580640">up,</span> <span m="3580940">of how</span> <span m="3581480">Unix</span> <span m="3582310">manages</span> <span m="3582610">and</span> <span m="3583010">passes</span> <span m="3583350">file descriptors</span> <span m="3584365">between</span> <span m="3584630">process.</span> <span m="3586220">So</span> <span m="3586450">in</span> <span m="3587890">traditional</span> <span m="3588380">Unix</span> <span m="3588655">and</span> <span m="3588930">Linux,</span> <span m="3589580">how</span> <span m="3589740">you</span> <span m="3590020">use it</span> <span m="3590210">today,</span> <span m="3590850">typically</span> <span m="3591260">when</span> <span m="3591400">you</span> <span m="3591510">launch</span> <span m="3591900">a</span> <span m="3591970">process,</span> <span m="3592910">you</span> <span m="3593020">can</span> <span m="3593390">pass</span> <span m="3593750">it</span> <span m="3593800">some</span> <span m="3593850">file</span> <span m="3594140">descriptors.</span> <span m="3594550">You just</span> <span m="3594880">open</span> <span m="3595290">some</span> <span m="3595430">file</span> <span m="3595640">descriptors</span> <span m="3596020">at</span> <span m="3596200">particular</span> <span m="3596810">integer</span> <span m="3597240">numbers</span> <span m="3597730">in</span> <span m="3597840">this</span> <span m="3597910">table</span> <span m="3598880">and</span> <span m="3599020">you</span> <span m="3599180">run</span> <span m="3599410">the</span> <span m="3599580">child</span> <span m="3599910">process</span> <span m="3600290">that you want</span> <span m="3600430">to run.</span> <span m="3600610">Or you run</span> <span m="3600905">a</span> <span m="3601200">particular</span> <span m="3601720">binary,</span> <span m="3601990">and</span> <span m="3602260">it</span> <span m="3603180">inherits</span> <span m="3603760">all</span> <span m="3604050">these</span> <span m="3604800">open</span> <span m="3605890">slots</span> <span m="3606760">in the</span> <span m="3606900">fd</span> <span m="3607020">table.</span> <span m="3608000">But</span> <span m="3608110">there's</span> <span m="3608330">no</span> <span m="3608690">real</span> <span m="3609010">good way</span> <span m="3609200">to</span> <span m="3609350">name these</span> <span m="3609880">things</span> <span m="3610370">other</span> <span m="3610580">than</span> <span m="3611020">by number.</span> </p>
<p><span m="3611730">So</span> <span m="3612370">the</span> <span m="3613190">somewhat</span> <span m="3614660">surprising</span> <span m="3615160">convention,</span> <span m="3615520">if</span> <span m="3615580">you</span> <span m="3615640">haven't</span> <span m="3615880">[INAUDIBLE]</span> <span m="3616260">before,</span> <span m="3616660">is that,</span> <span m="3616880">well,</span> <span m="3617580">slot</span> <span m="3617720">0</span> <span m="3618005">is your</span> <span m="3618540">input.</span> <span m="3618750">Slot</span> <span m="3619140">1</span> <span m="3620130">is</span> <span m="3620350">your output.</span> <span m="3620940">Slot</span> <span m="3621320">2</span> <span m="3621605">is</span> <span m="3621890">where you should</span> <span m="3622140">print</span> <span m="3622470">error messages to.</span> <span m="3624010">And</span> <span m="3624520">that's</span> <span m="3624720">how</span> <span m="3624830">Unix</span> <span m="3625050">sort of</span> <span m="3625350">works.</span> <span m="3627370">And</span> <span m="3627655">it sort of</span> <span m="3628280">works</span> <span m="3628580">OK</span> <span m="3629410">if</span> <span m="3629870">you</span> <span m="3630330">are</span> <span m="3630570">just</span> <span m="3630910">passing</span> <span m="3631300">these</span> <span m="3631630">three</span> <span m="3632240">files</span> <span m="3632540">or</span> <span m="3632840">streams</span> <span m="3633620">to a</span> <span m="3634430">process.</span> <span m="3635430">But</span> <span m="3636345">in</span> <span m="3636680">Capsicum,</span> <span m="3637080">what's</span> <span m="3637250">happening</span> <span m="3637570">is</span> <span m="3637700">that</span> <span m="3637850">you're</span> <span m="3637960">passing</span> <span m="3638120">down</span> <span m="3638530">many</span> <span m="3638850">more</span> <span m="3639590">file</span> <span m="3639880">descriptors</span> <span m="3640360">around.</span> <span m="3641140">So you're passing</span> <span m="3641310">a</span> <span m="3641730">file</span> <span m="3642150">descriptor</span> <span m="3642500">for</span> <span m="3643810">some files.</span> <span m="3644390">You're passing</span> <span m="3644810">a file descriptor</span> <span m="3645100">for</span> <span m="3645500">a network</span> <span m="3645750">connection,</span> <span m="3646310">for</span> <span m="3646770">a</span> <span m="3647055">shared</span> <span m="3647340">library,</span> <span m="3647650">what</span> <span m="3647980">have</span> <span m="3648300">you.</span> <span m="3649320">And</span> <span m="3649470">it</span> <span m="3649580">becomes</span> <span m="3649900">much</span> <span m="3650110">more</span> <span m="3650330">tedious</span> <span m="3650720">to</span> <span m="3650840">manage</span> <span m="3651220">all</span> <span m="3651330">these</span> <span m="3651530">numbers.</span> <span m="3652060">So</span> <span m="3652550">basically,</span> <span m="3653000">libcapsicum</span> <span m="3653540">provides</span> <span m="3654440">an</span> <span m="3654550">abstraction</span> <span m="3655370">for</span> <span m="3656000">naming these</span> <span m="3656970">past</span> <span m="3657600">file</span> <span m="3657850">descriptors</span> <span m="3658270">between</span> <span m="3658670">processes</span> <span m="3659460">by</span> <span m="3659690">some</span> <span m="3659880">sort</span> <span m="3660030">of</span> <span m="3660120">a</span> <span m="3660220">hierarchical</span> <span m="3660970">name,</span> <span m="3661810">instead of</span> <span m="3662500">just</span> <span m="3663530">these</span> <span m="3664720">opaque</span> <span m="3665150">integers,</span> <span m="3665620">if you will.</span> </p>
<p><span m="3666980">So</span> <span m="3667140">that's one</span> <span m="3667540">sort</span> <span m="3667670">of</span> <span m="3667740">simple</span> <span m="3668290">thing that they</span> <span m="3668650">provide</span> <span m="3669350">in</span> <span m="3669500">their</span> <span m="3669670">library.</span> <span m="3670240">So</span> <span m="3670910">I</span> <span m="3671010">can</span> <span m="3671670">pass a file</span> <span m="3672160">descriptor to</span> <span m="3672340">a</span> <span m="3672720">process</span> <span m="3673260">and</span> <span m="3673360">give it a</span> <span m="3673880">name.</span> <span m="3674100">And it doesn't really matter</span> <span m="3674250">what</span> <span m="3674640">number</span> <span m="3675010">it has,</span> <span m="3675503">a</span> <span m="3675667">little</span> <span m="3675831">easier.</span> <span m="3676982">That make sense?</span> <span m="3677968">OK.</span> </p>
<p><span m="3679450">So</span> <span m="3679630">then they</span> <span m="3679790">have</span> <span m="3679990">this</span> <span m="3680280">other</span> <span m="3680610">mechanism,</span> <span m="3681120">this</span> <span m="3682620">much</span> <span m="3682840">more</span> <span m="3683300">elaborate</span> <span m="3684260">way to</span> <span m="3684860">start a</span> <span m="3685180">sandbox.</span> <span m="3685906">This</span> <span m="3686270">lch,</span> <span m="3686690">libcapsicum</span> <span m="3687510">Host,</span> <span m="3688150">API</span> <span m="3688560">for</span> <span m="3688920">starting</span> <span m="3689230">a</span> <span m="3689310">sandbox,</span> <span m="3689740">instead</span> <span m="3690000">of</span> <span m="3690250">just</span> <span m="3690700">entering</span> <span m="3691290">the</span> <span m="3691410">capability</span> <span m="3691695">mode.</span> <span m="3693350">So</span> <span m="3693450">what</span> <span m="3693590">happened?</span> <span m="3694050">Why</span> <span m="3694470">do they</span> <span m="3694670">need</span> <span m="3694930">something</span> <span m="3695898">more than just entering</span> <span m="3696396">capability mode?</span> <span m="3697392">What are</span> <span m="3697890">you worried</span> <span m="3698390">about on</span> <span m="3698490">creating a sandbox?</span> <span m="3699950">Yeah?</span> </p>
<p><span m="3700810">AUDIENCE: It</span> <span m="3701790">erases</span> <span m="3702230">all the</span> <span m="3702654">inherited</span> <span m="3703078">stuff</span> <span m="3703502">to</span> <span m="3703926">give</span> <span m="3704350">you a</span> <span m="3704880">clean start.</span> </p>
<p><span m="3705820">PROFESSOR: Yeah.</span> <span m="3706190">So I think they</span> <span m="3706300">worry</span> <span m="3706800">about</span> <span m="3708180">trying</span> <span m="3708430">to</span> <span m="3708470">enumerate</span> <span m="3709070">what are</span> <span m="3709240">all</span> <span m="3709530">the</span> <span m="3709670">things</span> <span m="3710040">the</span> <span m="3710150">sandbox</span> <span m="3710680">has</span> <span m="3710790">access</span> <span m="3711230">to.</span> <span m="3711870">And</span> <span m="3712210">the</span> <span m="3712740">problem</span> <span m="3713120">is that</span> <span m="3713270">if</span> <span m="3713360">you</span> <span m="3713460">just</span> <span m="3713710">call</span> <span m="3714010">cap_enter,</span> <span m="3716160">technically,</span> <span m="3716570">at</span> <span m="3716980">the</span> <span m="3717140">kernel</span> <span m="3717540">mechanism</span> <span m="3717940">level,</span> <span m="3718210">as</span> <span m="3718270">we</span> <span m="3718370">talked</span> <span m="3718560">about</span> <span m="3718760">just now,</span> <span m="3718840">it</span> <span m="3718960">worked.</span> <span m="3719285">Right?</span> <span m="3719610">It just</span> <span m="3719760">prevents</span> <span m="3720200">you</span> <span m="3720360">from</span> <span m="3720790">opening</span> <span m="3721160">any new</span> <span m="3721530">capabilities.</span> <span m="3722270">But</span> <span m="3722540">the</span> <span m="3722670">problem</span> <span m="3723190">is</span> <span m="3723300">that</span> <span m="3723460">there</span> <span m="3723600">might</span> <span m="3723800">be</span> <span m="3723880">lots</span> <span m="3724230">of</span> <span m="3724300">existing</span> <span m="3724870">stuff</span> <span m="3725230">that</span> <span m="3725780">the</span> <span m="3725880">process</span> <span m="3726260">already</span> <span m="3726620">has</span> <span m="3726830">access</span> <span m="3727310">to.</span> </p>
<p><span m="3728780">So</span> <span m="3729210">I</span> <span m="3729310">guess</span> <span m="3729480">the</span> <span m="3730030">simplest</span> <span m="3730330">example</span> <span m="3730690">is</span> <span m="3731230">maybe there are</span> <span m="3731720">some</span> <span m="3732120">file</span> <span m="3732390">descriptors</span> <span m="3732660">that you</span> <span m="3732860">forgot</span> <span m="3733020">you had</span> <span m="3733580">opened,</span> <span m="3733930">and it'll just</span> <span m="3734397">get</span> <span m="3734864">inherited by</span> <span m="3736050">this</span> <span m="3736300">process.</span> <span m="3737310">So one</span> <span m="3737750">example</span> <span m="3738015">is</span> <span m="3738280">they</span> <span m="3738710">were</span> <span m="3738910">looking</span> <span m="3739180">at</span> <span m="3739500">tcpdump.</span> <span m="3740470">And</span> <span m="3741050">they</span> <span m="3741200">realized</span> <span m="3741760">that--</span> <span m="3742340">well,</span> <span m="3742520">first,</span> <span m="3742840">they</span> <span m="3743160">changed</span> <span m="3743550">tcpdump</span> <span m="3743950">just</span> <span m="3744630">by</span> <span m="3744720">calling</span> <span m="3745220">cap_enter</span> <span m="3746270">at</span> <span m="3746660">the</span> <span m="3746780">point</span> <span m="3747500">just</span> <span m="3747770">before</span> <span m="3748110">they were</span> <span m="3748240">about to</span> <span m="3748760">parse</span> <span m="3749140">all the network input.</span> </p>
<p><span m="3750610">So</span> <span m="3750720">this</span> <span m="3750790">works</span> <span m="3751030">well,</span> <span m="3751470">in</span> <span m="3751550">some</span> <span m="3751730">sense,</span> <span m="3752070">because</span> <span m="3752300">you</span> <span m="3752400">can't</span> <span m="3752760">get</span> <span m="3752900">any</span> <span m="3753070">more</span> <span m="3753340">capabilities.</span> <span m="3754290">But</span> <span m="3754390">then</span> <span m="3754490">they</span> <span m="3754610">looked</span> <span m="3754890">at</span> <span m="3754960">the</span> <span m="3755030">open file</span> <span m="3755350">descriptor,</span> <span m="3755650">and</span> <span m="3755970">they</span> <span m="3756070">realized</span> <span m="3756355">that</span> <span m="3756640">you</span> <span m="3756720">have</span> <span m="3757400">complete</span> <span m="3757740">access</span> <span m="3758480">to</span> <span m="3758590">the</span> <span m="3758790">user's</span> <span m="3759285">terminal,</span> <span m="3759780">because</span> <span m="3760260">you</span> <span m="3760340">have</span> <span m="3760820">an open</span> <span m="3761220">file descriptor</span> <span m="3761380">to it.</span> <span m="3761720">So you can</span> <span m="3762130">actually</span> <span m="3762370">sniff</span> <span m="3762590">all</span> <span m="3762760">the</span> <span m="3762830">keystrokes</span> <span m="3763145">that the</span> <span m="3763460">user is</span> <span m="3763750">typing</span> <span m="3764350">and</span> <span m="3764640">all that stuff.</span> <span m="3765225">So it's</span> <span m="3765910">probably not a great</span> <span m="3766520">plan for</span> <span m="3766890">tcpdump.</span> <span m="3768664">This</span> <span m="3769076">compromise</span> <span m="3769490">you</span> <span m="3769625">probably</span> <span m="3769760">don't</span> <span m="3769830">want</span> <span m="3770170">sniffing</span> <span m="3770445">everything</span> <span m="3771060">you're</span> <span m="3771350">typing.</span> </p>
<p><span m="3772950">So</span> <span m="3773530">instead</span> <span m="3773810">they--</span> <span m="3775170">well,</span> <span m="3775640">in</span> <span m="3775850">tcpdump's</span> <span m="3776190">case,</span> <span m="3776520">they</span> <span m="3777170">manually</span> <span m="3778470">changed</span> <span m="3779050">these</span> <span m="3779700">file</span> <span m="3779920">descriptors</span> <span m="3780900">to</span> <span m="3781490">add</span> <span m="3781790">some</span> <span m="3782000">capability</span> <span m="3782640">bits to</span> <span m="3782900">them,</span> <span m="3783010">to</span> <span m="3783280">restrict</span> <span m="3783600">what kinds of</span> <span m="3784190">operations</span> <span m="3784625">you can</span> <span m="3785060">do.</span> <span m="3785360">So</span> <span m="3785960">remember,</span> <span m="3786320">the</span> <span m="3786420">capability,</span> <span m="3786810">at</span> <span m="3787200">least</span> <span m="3787510">in</span> <span m="3787580">Capsicum,</span> <span m="3787990">has</span> <span m="3788460">these</span> <span m="3788660">extra</span> <span m="3788970">bits</span> <span m="3789290">that</span> <span m="3789470">say,</span> <span m="3789670">here's</span> <span m="3789960">the</span> <span m="3790120">class</span> <span m="3790385">of</span> <span m="3790650">operations</span> <span m="3791030">you can</span> <span m="3791410">perform</span> <span m="3791910">on a file</span> <span m="3792190">descriptor.</span> <span m="3793310">So</span> <span m="3793510">they</span> <span m="3793620">basically</span> <span m="3794300">take</span> <span m="3795500">what</span> <span m="3795790">used to be</span> <span m="3796090">file</span> <span m="3796510">descriptor</span> <span m="3796890">0.</span> <span m="3797650">It</span> <span m="3797860">pointed to the</span> <span m="3798340">user's</span> <span m="3798950">terminal,</span> <span m="3799490">tty.</span> </p>
<p><span m="3800700">And</span> <span m="3801200">originally,</span> <span m="3802130">this</span> <span m="3802280">was</span> <span m="3802450">just</span> <span m="3802710">a</span> <span m="3803070">direct</span> <span m="3803370">pointer</span> <span m="3803670">to the</span> <span m="3803970">tty</span> <span m="3804270">structure</span> <span m="3804560">in the</span> <span m="3804930">kernel.</span> <span m="3805880">What</span> <span m="3806050">they</span> <span m="3806190">do</span> <span m="3806350">is they</span> <span m="3806480">actually--</span> <span m="3807380">in</span> <span m="3807450">order</span> <span m="3807610">to</span> <span m="3807730">limit</span> <span m="3808220">the</span> <span m="3808300">kind</span> <span m="3808540">of</span> <span m="3808610">operations</span> <span m="3809010">you can perform</span> <span m="3809410">on</span> <span m="3809620">this</span> <span m="3809710">file</span> <span m="3810070">descriptor,</span> <span m="3810830">they</span> <span m="3811050">basically</span> <span m="3811220">introduced</span> <span m="3811310">some extra</span> <span m="3811580">beta</span> <span m="3811930">structure in the</span> <span m="3812050">middle.</span> <span m="3812690">This</span> <span m="3812950">guy will</span> <span m="3813510">point</span> <span m="3813760">to</span> <span m="3813820">the</span> <span m="3813930">terminal.</span> <span m="3814810">And</span> <span m="3815020">the</span> <span m="3815110">file descriptor</span> <span m="3815840">itself</span> <span m="3816450">will</span> <span m="3816730">point</span> <span m="3817070">to</span> <span m="3817810">some sort of</span> <span m="3818238">a</span> <span m="3818666">capability structure.</span> <span m="3819950">And</span> <span m="3820300">inside</span> <span m="3820720">of</span> <span m="3820800">it</span> <span m="3821020">is</span> <span m="3821220">the</span> <span m="3821350">pointer</span> <span m="3821840">to the</span> <span m="3821970">real</span> <span m="3822270">file</span> <span m="3823040">that</span> <span m="3823240">you're</span> <span m="3823720">trying</span> <span m="3823950">to</span> <span m="3824010">access,</span> <span m="3824720">as</span> <span m="3824860">well</span> <span m="3825120">as</span> <span m="3825200">some</span> <span m="3825860">restricted</span> <span m="3826145">bits</span> <span m="3826685">or</span> <span m="3827620">permissions</span> <span m="3829306">on</span> <span m="3829730">that</span> <span m="3830430">file</span> <span m="3831410">descriptor</span> <span m="3831590">object</span> <span m="3832000">that you can do.</span> </p>
<p><span m="3833280">In their</span> <span m="3833660">case,</span> <span m="3833800">they</span> <span m="3833880">basically</span> <span m="3833960">can</span> <span m="3834122">say</span> <span m="3834285">for</span> <span m="3834610">tcpdumps</span> <span m="3835390">standard</span> <span m="3835740">input,</span> <span m="3835930">you cannot</span> <span m="3836140">do</span> <span m="3836810">anything on it.</span> <span m="3837585">You can just</span> <span m="3837940">see</span> <span m="3838150">that it</span> <span m="3838270">exists,</span> <span m="3838750">and</span> <span m="3838830">that's it.</span> <span m="3839602">For the output</span> <span m="3840260">file</span> <span m="3840530">descriptor,</span> <span m="3841110">they say,</span> <span m="3841570">well,</span> <span m="3841760">you can</span> <span m="3841970">write to it,</span> <span m="3842640">but you</span> <span m="3843160">maybe can't</span> <span m="3843640">reposition.</span> <span m="3843980">You can't</span> <span m="3844320">[INAUDIBLE]</span> <span m="3844804">back and forth,</span> <span m="3845772">et</span> <span m="3846256">cetera.</span> <span m="3847710">Make sense?</span> </p>
<p><span m="3850280">So what else</span> <span m="3850690">would you</span> <span m="3851010">worry</span> <span m="3851470">about,</span> <span m="3851900">in terms</span> <span m="3852160">of starting a</span> <span m="3852420">sandbox?</span> <span m="3852570">So there is,</span> <span m="3853520">I</span> <span m="3853580">guess,</span> <span m="3853740">the</span> <span m="3854040">file descriptor state.</span> <span m="3854810">Anything</span> <span m="3855050">else</span> <span m="3855310">that</span> <span m="3855760">matters?</span> <span m="3861448">Well,</span> <span m="3861922">I guess in</span> <span m="3862396">Unix</span> <span m="3862880">it's</span> <span m="3863100">file</span> <span m="3863420">descriptors</span> <span m="3863870">and memory.</span> <span m="3864320">That's pretty much it.</span> </p>
<p><span m="3865670">So</span> <span m="3866100">the</span> <span m="3866440">other thing</span> <span m="3866620">that</span> <span m="3866800">these</span> <span m="3867630">guys</span> <span m="3868960">worry</span> <span m="3869180">about</span> <span m="3869400">is</span> <span m="3869660">that it</span> <span m="3869920">might</span> <span m="3869960">be</span> <span m="3870170">that</span> <span m="3870830">in</span> <span m="3871080">your</span> <span m="3871410">address</span> <span m="3871860">space,</span> <span m="3872250">you</span> <span m="3872390">previously</span> <span m="3872830">allocated</span> <span m="3873400">some</span> <span m="3873540">sensitive</span> <span m="3873880">data.</span> <span m="3874600">And</span> <span m="3875450">the</span> <span m="3875570">process</span> <span m="3876030">that</span> <span m="3876195">your</span> <span m="3876360">sandbox</span> <span m="3876920">is</span> <span m="3877020">going</span> <span m="3877130">to</span> <span m="3877180">be</span> <span m="3877410">able</span> <span m="3877580">to</span> <span m="3877640">read</span> <span m="3877970">all its</span> <span m="3878300">memory.</span> <span m="3878940">So</span> <span m="3879040">if</span> <span m="3879180">there's</span> <span m="3879450">maybe</span> <span m="3879670">some</span> <span m="3879830">password</span> <span m="3880205">that you</span> <span m="3880580">checked</span> <span m="3880850">before</span> <span m="3881390">when</span> <span m="3881510">the user</span> <span m="3881660">was</span> <span m="3882000">logging in,</span> <span m="3882420">and</span> <span m="3882830">you haven't</span> <span m="3883140">cleared</span> <span m="3883450">that</span> <span m="3883800">yet,</span> <span m="3884150">well,</span> <span m="3884840">the</span> <span m="3885130">sandbox</span> <span m="3885550">process will be</span> <span m="3885960">able to</span> <span m="3886200">read</span> <span m="3886545">that and do</span> <span m="3886890">something</span> <span m="3887165">maybe interesting</span> <span m="3887440">to that.</span> </p>
<p><span m="3889050">So</span> <span m="3889390">the</span> <span m="3889910">way</span> <span m="3890060">they</span> <span m="3890270">solved</span> <span m="3890510">this</span> <span m="3890620">problem</span> <span m="3890920">is,</span> <span m="3891190">in</span> <span m="3891450">lch_start,</span> <span m="3891670">you basically</span> <span m="3892480">have to</span> <span m="3893590">start a</span> <span m="3893980">program</span> <span m="3894600">fresh.</span> <span m="3895100">You</span> <span m="3895470">basically</span> <span m="3896040">take</span> <span m="3896470">a</span> <span m="3896840">program.</span> <span m="3897270">You</span> <span m="3897590">explicitly</span> <span m="3898040">package</span> <span m="3898410">up all the</span> <span m="3898790">arguments</span> <span m="3899220">you want</span> <span m="3899360">to</span> <span m="3899400">give</span> <span m="3899590">it.</span> <span m="3900030">You explicitly</span> <span m="3900240">package</span> <span m="3900550">up</span> <span m="3900830">all the file</span> <span m="3901160">descriptors</span> <span m="3901590">you want to</span> <span m="3902100">give</span> <span m="3902310">it.</span> <span m="3902870">And then you</span> <span m="3902950">start</span> <span m="3903260">a</span> <span m="3903320">new</span> <span m="3903920">process,</span> <span m="3904235">or</span> <span m="3904550">you would</span> <span m="3904900">call</span> <span m="3905120">executives</span> <span m="3905790">to</span> <span m="3906220">reinitialize</span> <span m="3906410">your</span> <span m="3907020">whole</span> <span m="3907300">virtual</span> <span m="3907840">memory</span> <span m="3908190">space.</span> </p>
<p><span m="3909200">And</span> <span m="3909460">then</span> <span m="3909720">there's</span> <span m="3910040">no</span> <span m="3910190">question</span> <span m="3910540">about</span> <span m="3910890">what</span> <span m="3911080">is</span> <span m="3911220">the</span> <span m="3911330">set</span> <span m="3911580">of</span> <span m="3912230">sensitive</span> <span m="3912700">data</span> <span m="3913340">of</span> <span m="3913540">extra</span> <span m="3913810">privileges</span> <span m="3914370">that</span> <span m="3914470">this</span> <span m="3914610">process</span> <span m="3915100">has.</span> <span m="3915510">It's exactly</span> <span m="3916220">what</span> <span m="3916410">you</span> <span m="3916670">passed</span> <span m="3917020">to</span> <span m="3917240">lch_start,</span> <span m="3918160">in terms of</span> <span m="3918990">a</span> <span m="3919410">program</span> <span m="3919860">name,</span> <span m="3920420">arguments,</span> <span m="3920950">and</span> <span m="3921300">capabilities.</span> <span m="3922040">Does that make sense?</span> </p>
<p><span m="3924540">AUDIENCE: What would</span> <span m="3925040">happen if</span> <span m="3925540">the</span> <span m="3926040">process</span> <span m="3926365">that you're</span> <span m="3927160">starting</span> <span m="3927550">is a</span> <span m="3928014">setuid</span> <span m="3928478">0</span> <span m="3928942">binary?</span> </p>
<p><span m="3929870">PROFESSOR: Yeah.</span> <span m="3930160">I</span> <span m="3930240">think</span> <span m="3930910">these</span> <span m="3931280">guys</span> <span m="3932740">say</span> <span m="3933060">that</span> <span m="3934620">they</span> <span m="3934760">don't</span> <span m="3934950">actually</span> <span m="3935380">allow</span> <span m="3935890">setuid</span> <span m="3936390">binaries</span> <span m="3936640">in</span> <span m="3936960">capability</span> <span m="3937400">mode,</span> <span m="3938020">just</span> <span m="3938200">to</span> <span m="3938260">avoid</span> <span m="3938760">some</span> <span m="3938950">weird</span> <span m="3939200">interactions that</span> <span m="3939860">would</span> <span m="3939940">show</span> <span m="3940140">up.</span> <span m="3940905">I</span> <span m="3941300">think the</span> <span m="3941950">rules</span> <span m="3942120">that</span> <span m="3942450">they</span> <span m="3942550">implement</span> <span m="3942940">is</span> <span m="3943100">that</span> <span m="3943550">you</span> <span m="3943640">could</span> <span m="3943820">have</span> <span m="3943990">a</span> <span m="3944040">setuid</span> <span m="3944710">program</span> <span m="3945170">that gets its</span> <span m="3945840">privileges</span> <span m="3946310">from</span> <span m="3946480">a</span> <span m="3946650">setuid</span> <span m="3946900">binary,</span> <span m="3947770">and</span> <span m="3948070">then</span> <span m="3948420">it can call</span> <span m="3949130">capenter</span> <span m="3949900">or</span> <span m="3950220">lch_start.</span> <span m="3950950">But</span> <span m="3951480">once</span> <span m="3951720">you're in</span> <span m="3951970">capability</span> <span m="3952460">mode,</span> <span m="3952890">you</span> <span m="3953040">cannot</span> <span m="3953510">regain</span> <span m="3953960">extra</span> <span m="3954270">privileges.</span> </p>
<p><span m="3954640">In</span> <span m="3955680">principle,</span> <span m="3956080">this</span> <span m="3956480">could work,</span> <span m="3957110">but</span> <span m="3957340">it</span> <span m="3957373">would</span> <span m="3957406">be</span> <span m="3957440">very</span> <span m="3957790">weird.</span> <span m="3958110">Because</span> <span m="3958720">remember,</span> <span m="3959030">the</span> <span m="3959110">only</span> <span m="3959410">place</span> <span m="3959660">where</span> <span m="3959750">the</span> <span m="3959900">UID</span> <span m="3960290">matters,</span> <span m="3960680">once you're in</span> <span m="3961155">capability mode,</span> <span m="3962080">is</span> <span m="3962400">in</span> <span m="3962500">opening these</span> <span m="3963200">files</span> <span m="3963570">inside of a</span> <span m="3963760">directory.</span> <span m="3964150">So</span> <span m="3964540">it's not clear</span> <span m="3965260">this</span> <span m="3965470">is</span> <span m="3965630">really</span> <span m="3965940">a</span> <span m="3966080">great</span> <span m="3966780">plan</span> <span m="3967080">for</span> <span m="3967990">getting</span> <span m="3968470">more privileges</span> <span m="3968950">or</span> <span m="3969430">[INAUDIBLE]</span> <span m="3969910">there.</span> <span m="3970870">Make sense?</span> <span m="3971350">Yeah?</span> </p>
<p><span m="3972790">AUDIENCE: We</span> <span m="3972950">talked</span> <span m="3973220">about</span> <span m="3973450">earlier</span> <span m="3974270">why</span> <span m="3974390">the</span> <span m="3974480">library</span> <span m="3974740">doesn't really</span> <span m="3976110">support</span> <span m="3977000">strict</span> <span m="3977490">separation between those two.</span> <span m="3979165">And then we</span> <span m="3979610">just mentioned</span> <span m="3980055">all these</span> <span m="3980950">problems</span> <span m="3981390">that you could</span> <span m="3981830">use</span> <span m="3982260">[INAUDIBLE],</span> <span m="3982880">so</span> <span m="3983400">we're</span> <span m="3983530">still</span> <span m="3983800">not</span> <span m="3984030">under</span> <span m="3984330">a</span> <span m="3984670">restriction</span> <span m="3984955">to</span> <span m="3985240">use</span> <span m="3985530">lch_start</span> <span m="3985820">necessarily,</span> <span m="3986263">right?</span> </p>
<p><span m="3987150">PROFESSOR: That's</span> <span m="3987410">right.</span> <span m="3987680">Yeah.</span> <span m="3988020">So</span> <span m="3988150">lch_start,</span> <span m="3988715">here's</span> <span m="3989090">sort</span> <span m="3989380">of</span> <span m="3989470">the</span> <span m="3989560">way</span> <span m="3989680">to</span> <span m="3989810">think</span> <span m="3990060">of it.</span> <span m="3990510">So</span> <span m="3990630">you</span> <span m="3990700">have</span> <span m="3990900">an</span> <span m="3990970">application,</span> <span m="3991670">like</span> <span m="3991960">maybe</span> <span m="3992560">tcpdump.</span> <span m="3992960">Or</span> <span m="3993430">gzip</span> <span m="3993910">is the other</span> <span m="3994640">thing</span> <span m="3994980">they</span> <span m="3995650">work</span> <span m="3995930">with.</span> <span m="3996550">And</span> <span m="3997300">what you're</span> <span m="3997450">basically</span> <span m="3997570">assuming is</span> <span m="3998190">the</span> <span m="3998290">application</span> <span m="3998800">is</span> <span m="3998890">probably</span> <span m="3999290">not</span> <span m="3999540">compromised,</span> <span m="4000390">and</span> <span m="4000590">there</span> <span m="4000690">are</span> <span m="4000760">some</span> <span m="4001440">core</span> <span m="4001810">part</span> <span m="4002120">of the</span> <span m="4002240">application</span> <span m="4002535">that you</span> <span m="4002960">worry</span> <span m="4003320">about</span> <span m="4003650">sandboxing.</span> <span m="4004730">In</span> <span m="4004990">tcpdump's</span> <span m="4005460">case,</span> <span m="4006000">it's</span> <span m="4006120">actually</span> <span m="4006590">parsing</span> <span m="4007150">packets</span> <span m="4007570">coming</span> <span m="4007830">from</span> <span m="4008010">the</span> <span m="4008060">network.</span> </p>
<p><span m="4008730">In</span> <span m="4008960">gzip's</span> <span m="4009360">case,</span> <span m="4009720">it's actually</span> <span m="4010010">taking</span> <span m="4010290">the</span> <span m="4010380">file</span> <span m="4010660">and</span> <span m="4010850">decompressing</span> <span m="4011240">it.</span> <span m="4011915">And</span> <span m="4012200">you're</span> <span m="4012400">basically assuming,</span> <span m="4012760">well,</span> <span m="4013120">up</span> <span m="4013240">until</span> <span m="4013560">a</span> <span m="4013780">point,</span> <span m="4014250">the</span> <span m="4014370">process is</span> <span m="4014790">probably</span> <span m="4015120">doing</span> <span m="4015430">all</span> <span m="4015610">the</span> <span m="4015680">right</span> <span m="4015870">things.</span> <span m="4016250">It's not</span> <span m="4016580">exploited.</span> <span m="4016930">There's</span> <span m="4016990">probably</span> <span m="4017230">not</span> <span m="4017510">a</span> <span m="4017720">bug yet</span> <span m="4018040">for the</span> <span m="4018360">[INAUDIBLE]</span> <span m="4019100">even.</span> <span m="4019520">So</span> <span m="4019870">at</span> <span m="4019960">that</span> <span m="4020160">point,</span> <span m="4020360">you're</span> <span m="4020540">trusting</span> <span m="4020795">that it will</span> <span m="4021050">run</span> <span m="4021420">lch_start</span> <span m="4022440">correctly</span> <span m="4023290">and</span> <span m="4023450">correctly</span> <span m="4023800">set</span> <span m="4024050">up</span> <span m="4024210">the</span> <span m="4024450">image,</span> <span m="4025060">correctly</span> <span m="4025190">set</span> <span m="4025330">up</span> <span m="4025430">all</span> <span m="4025580">the</span> <span m="4025650">capabilities,</span> <span m="4026580">and</span> <span m="4026720">then</span> <span m="4027060">restrict</span> <span m="4027550">itself</span> <span m="4028190">from</span> <span m="4028390">making</span> <span m="4028700">any</span> <span m="4028860">further</span> <span m="4029220">system</span> <span m="4029545">calls</span> <span m="4029870">outside</span> <span m="4030460">its</span> <span m="4030630">capability</span> <span m="4031010">mode.</span> </p>
<p><span m="4031840">And</span> <span m="4031880">then</span> <span m="4032030">you</span> <span m="4032150">run</span> <span m="4032320">the</span> <span m="4032410">dangerous</span> <span m="4032890">stuff.</span> <span m="4033490">And</span> <span m="4034370">by</span> <span m="4034510">then,</span> <span m="4034840">this</span> <span m="4035190">setup has happened</span> <span m="4035890">correctly,</span> <span m="4036590">and</span> <span m="4036710">there's</span> <span m="4036950">no</span> <span m="4037430">way</span> <span m="4037560">to</span> <span m="4037640">escape</span> <span m="4038120">out</span> <span m="4038400">of</span> <span m="4038863">that</span> <span m="4039326">sandbox.</span> <span m="4040252">Make sense?</span> <span m="4042570">All right.</span> <span m="4043690">So</span> <span m="4045100">I guess let's</span> <span m="4046180">look at</span> <span m="4046370">how you</span> <span m="4046590">actually</span> <span m="4046800">use</span> <span m="4047560">capability</span> <span m="4048020">mode</span> <span m="4048230">to</span> <span m="4049050">sandbox</span> <span m="4049790">applications.</span> </p>
<p><span m="4050910">So</span> <span m="4051080">we</span> <span m="4051365">talked a little bit</span> <span m="4051650">about</span> <span m="4051950">tcpdump.</span> <span m="4052250">How do you</span> <span m="4054170">isolate</span> <span m="4054640">this</span> <span m="4054810">process?</span> <span m="4056005">Another</span> <span m="4056700">interesting</span> <span m="4056970">example</span> <span m="4057540">they</span> <span m="4057680">had</span> <span m="4058410">was</span> <span m="4058880">this</span> <span m="4059700">gzip</span> <span m="4060610">program</span> <span m="4061180">that</span> <span m="4061970">compresses,</span> <span m="4062270">decompresses</span> <span m="4063460">files.</span> <span m="4064660">So</span> <span m="4065570">why</span> <span m="4065770">do</span> <span m="4065870">they</span> <span m="4065980">worry</span> <span m="4066260">about</span> <span m="4066480">sandboxing</span> <span m="4066745">it?</span> <span m="4067010">I</span> <span m="4067060">guess</span> <span m="4067390">they</span> <span m="4067500">worry</span> <span m="4067860">that</span> <span m="4068110">the</span> <span m="4068800">decompression</span> <span m="4069560">code</span> <span m="4069990">is</span> <span m="4070300">going</span> <span m="4070420">to</span> <span m="4070510">be</span> <span m="4071290">potentially</span> <span m="4071690">buggy,</span> <span m="4072230">or maybe</span> <span m="4072485">there's</span> <span m="4072740">some</span> <span m="4073330">memory</span> <span m="4073680">management</span> <span m="4074120">errors</span> <span m="4074470">in</span> <span m="4074670">how</span> <span m="4074880">they</span> <span m="4075030">manage</span> <span m="4075370">the</span> <span m="4075450">buffers</span> <span m="4075850">during</span> <span m="4076080">decompression,</span> <span m="4076700">et</span> <span m="4077180">cetera.</span> </p>
<p><span m="4078100">So</span> <span m="4079940">could</span> <span m="4080940">they--</span> <span m="4082280">well,</span> <span m="4084430">one interesting</span> <span m="4084810">question,</span> <span m="4085170">I</span> <span m="4085270">guess,</span> <span m="4085450">is</span> <span m="4086180">why are</span> <span m="4086630">the</span> <span m="4087830">changes</span> <span m="4088160">to</span> <span m="4088280">gzip</span> <span m="4089120">seemingly</span> <span m="4090050">much</span> <span m="4090230">more</span> <span m="4090390">complicated</span> <span m="4090990">than for</span> <span m="4096040">tcpdump?</span> <span m="4103685">Any guesses?</span> <span m="4107100">Well as</span> <span m="4107229">far</span> <span m="4107609">as you can tell,</span> <span m="4107850">it's</span> <span m="4108029">mostly</span> <span m="4108450">just</span> <span m="4108609">a</span> <span m="4108689">question</span> <span m="4108960">of</span> <span m="4109080">how</span> <span m="4109359">the</span> <span m="4109560">application</span> <span m="4110479">is</span> <span m="4111220">structured</span> <span m="4111640">internally,</span> <span m="4112229">right?</span> </p>
<p><span m="4112439">So</span> <span m="4114830">if</span> <span m="4114960">you</span> <span m="4115990">had</span> <span m="4116330">a</span> <span m="4117029">application</span> <span m="4117620">that</span> <span m="4117790">simply</span> <span m="4118620">compressed</span> <span m="4119170">a</span> <span m="4119359">single file,</span> <span m="4119649">or</span> <span m="4120170">decompressed</span> <span m="4120810">a</span> <span m="4120880">single</span> <span m="4121229">file,</span> <span m="4122029">then</span> <span m="4122740">it</span> <span m="4122880">might</span> <span m="4123080">be</span> <span m="4123300">OK</span> <span m="4123670">for</span> <span m="4124399">us</span> <span m="4124620">to</span> <span m="4125609">just</span> <span m="4125830">run</span> <span m="4126240">it</span> <span m="4127430">in</span> <span m="4127649">capability</span> <span m="4128140">mode</span> <span m="4128330">without</span> <span m="4128630">really</span> <span m="4128840">changing</span> <span m="4129220">it.</span> <span m="4129249">You</span> <span m="4129359">just</span> <span m="4129590">give</span> <span m="4129770">it</span> <span m="4129880">a</span> <span m="4129939">new</span> <span m="4130300">standard</span> <span m="4130689">in</span> <span m="4130854">for</span> <span m="4131020">something</span> <span m="4131380">to</span> <span m="4131420">decompress,</span> <span m="4132540">and</span> <span m="4132960">the</span> <span m="4133050">standard</span> <span m="4133399">out</span> <span m="4133640">goes</span> <span m="4133899">to</span> <span m="4133990">the</span> <span m="4134149">decompressed</span> <span m="4134990">output,</span> <span m="4135830">and</span> <span m="4136120">that would</span> <span m="4136390">work</span> <span m="4136609">fine.</span> </p>
<p><span m="4137300">The</span> <span m="4137410">problem,</span> <span m="4137930">as</span> <span m="4138313">is</span> <span m="4139080">almost</span> <span m="4139310">always</span> <span m="4139520">the</span> <span m="4139590">case</span> <span m="4139830">here</span> <span m="4140060">with</span> <span m="4140240">these</span> <span m="4140460">kind</span> <span m="4140640">of</span> <span m="4140710">sandboxing</span> <span m="4141250">techniques,</span> <span m="4141899">is that</span> <span m="4142120">the</span> <span m="4142200">application</span> <span m="4142689">actually</span> <span m="4142950">has</span> <span m="4143569">much</span> <span m="4143779">more</span> <span m="4144020">complicated</span> <span m="4144479">logic</span> <span m="4144859">around</span> <span m="4145180">it.</span> <span m="4145330">So</span> <span m="4145750">gzip,</span> <span m="4145899">for</span> <span m="4146000">example,</span> <span m="4146410">can</span> <span m="4146930">compress</span> <span m="4147359">multiple</span> <span m="4147770">files,</span> <span m="4148750">et</span> <span m="4148850">cetera.</span> <span m="4149490">And</span> <span m="4150000">in</span> <span m="4150080">that</span> <span m="4150270">case,</span> <span m="4150600">you</span> <span m="4151470">have</span> <span m="4151779">some</span> <span m="4151930">sort</span> <span m="4152069">of</span> <span m="4152140">a</span> <span m="4152240">driver</span> <span m="4152609">process</span> <span m="4153050">on</span> <span m="4153229">top</span> <span m="4153580">which</span> <span m="4153760">actually</span> <span m="4154319">has</span> <span m="4154550">these</span> <span m="4154689">extra</span> <span m="4154950">privileges</span> <span m="4155450">to</span> <span m="4155560">open</span> <span m="4155830">multiple</span> <span m="4156210">files,</span> <span m="4156830">to</span> <span m="4157380">create</span> <span m="4157649">things,</span> <span m="4157950">et</span> <span m="4158250">cetera.</span> </p>
<p><span m="4158899">And</span> <span m="4159300">the</span> <span m="4159410">core</span> <span m="4159620">logic</span> <span m="4159990">needs to</span> <span m="4160109">be</span> <span m="4160300">often</span> <span m="4160670">another</span> <span m="4160970">helper</span> <span m="4161420">process.</span> <span m="4162300">And</span> <span m="4162479">it was</span> <span m="4162979">just</span> <span m="4163279">so</span> <span m="4163550">the</span> <span m="4163649">case</span> <span m="4164010">in</span> <span m="4164180">gzip</span> <span m="4164600">that</span> <span m="4165330">the</span> <span m="4165439">application</span> <span m="4165899">wasn't</span> <span m="4166220">structured</span> <span m="4167359">in</span> <span m="4167640">a</span> <span m="4167720">way</span> <span m="4167970">where</span> <span m="4168180">this</span> <span m="4168359">was</span> <span m="4168490">already</span> <span m="4168819">a</span> <span m="4168890">separate</span> <span m="4169210">process</span> <span m="4169649">doing</span> <span m="4169890">all</span> <span m="4170130">the</span> <span m="4170260">decompression</span> <span m="4170550">or</span> <span m="4170840">compression.</span> <span m="4171689">So</span> <span m="4171790">they</span> <span m="4171890">had</span> <span m="4172120">to</span> <span m="4172880">change</span> <span m="4173380">gzip's</span> <span m="4175109">core</span> <span m="4175439">implementation,</span> <span m="4176020">and,</span> <span m="4176479">well,</span> <span m="4177850">some</span> <span m="4178170">structure</span> <span m="4178740">of</span> <span m="4178830">the</span> <span m="4178979">gzip</span> <span m="4179290">application,</span> <span m="4181609">instead</span> <span m="4182050">of</span> <span m="4182229">just</span> <span m="4182590">passing</span> <span m="4183010">the</span> <span m="4183120">data</span> <span m="4183470">to</span> <span m="4183770">the</span> <span m="4184020">decompression</span> <span m="4184560">function</span> <span m="4184979">to</span> <span m="4185140">actually</span> <span m="4185680">send</span> <span m="4185990">it</span> <span m="4186069">over</span> <span m="4186279">an</span> <span m="4186350">RPC</span> <span m="4186790">call</span> <span m="4187060">or</span> <span m="4187130">really</span> <span m="4187359">just</span> <span m="4187550">write</span> <span m="4187840">it to</span> <span m="4187920">some</span> <span m="4188319">almost</span> <span m="4188649">file</span> <span m="4188830">descriptor</span> <span m="4189859">to</span> <span m="4190540">help</span> <span m="4190979">process</span> <span m="4191390">the</span> <span m="4191490">problems</span> <span m="4191770">on</span> <span m="4191840">the</span> <span m="4191920">side</span> <span m="4192660">and</span> <span m="4192850">performs</span> <span m="4193270">all</span> <span m="4193430">the decompression</span> <span m="4194200">with</span> <span m="4194780">almost</span> <span m="4195180">no</span> <span m="4195470">privileges.</span> <span m="4195940">The</span> <span m="4196050">only thing</span> <span m="4196305">it can</span> <span m="4196560">do</span> <span m="4196740">is</span> <span m="4196920">return</span> <span m="4197760">the</span> <span m="4197840">decompressed</span> <span m="4198470">data,</span> <span m="4198730">or</span> <span m="4198810">the</span> <span m="4198920">compressed</span> <span m="4199340">data,</span> <span m="4200090">back</span> <span m="4200480">to</span> <span m="4200560">the</span> <span m="4200670">caller</span> <span m="4200960">process.</span> </p>
<p><span m="4202700">That</span> <span m="4202830">roughly</span> <span m="4203080">make</span> <span m="4203230">sense?</span> <span m="4203670">What's going on in</span> <span m="4204110">gzip?</span> <span m="4206230">All</span> <span m="4206310">right.</span> <span m="4207820">So</span> <span m="4209280">I</span> <span m="4209350">guess</span> <span m="4209490">one</span> <span m="4209670">thing</span> <span m="4209820">we</span> <span m="4210620">asked</span> <span m="4210890">for</span> <span m="4211190">the</span> <span m="4211240">homework</span> <span m="4211670">is</span> <span m="4211910">how do you</span> <span m="4212180">actually</span> <span m="4212440">use</span> <span m="4212750">Capsicum</span> <span m="4212930">in</span> <span m="4213030">OKWS?</span> <span m="4213690">So what</span> <span m="4214120">do</span> <span m="4214170">you</span> <span m="4214230">guys</span> <span m="4214440">think?</span> <span m="4214750">Would</span> <span m="4215180">it</span> <span m="4216120">be</span> <span m="4216220">useful?</span> <span m="4217025">Would</span> <span m="4217290">the</span> <span m="4217520">OKWS</span> <span m="4218320">guys have</span> <span m="4218560">been</span> <span m="4219070">excited</span> <span m="4219385">and</span> <span m="4220180">switched to</span> <span m="4220570">FreeBSD</span> <span m="4221210">because</span> <span m="4221490">this</span> <span m="4221600">was</span> <span m="4223010">much</span> <span m="4223280">easier</span> <span m="4223540">to</span> <span m="4223620">use?</span> <span m="4223980">Or</span> <span m="4224380">is this</span> <span m="4224930">a</span> <span m="4225010">wash?</span> <span m="4225590">So</span> <span m="4225996">what do you think?</span> <span m="4226810">How</span> <span m="4226970">would you</span> <span m="4227130">use</span> <span m="4227470">Capsicum</span> <span m="4228030">in</span> <span m="4228060">FreeBSD?</span> <span m="4228360">Would this</span> <span m="4229150">be</span> <span m="4229290">much</span> <span m="4229480">different?</span> <span m="4230954">Yeah.</span> </p>
<p><span m="4231890">AUDIENCE: So it means you</span> <span m="4232080">can</span> <span m="4232544">get</span> <span m="4233008">rid of some of the</span> <span m="4234400">jailing</span> <span m="4234810">[INAUDIBLE].</span> </p>
<p><span m="4237250">PROFESSOR: Yeah.</span> <span m="4237610">That's true.</span> <span m="4237770">So</span> <span m="4238085">truth seems</span> <span m="4238670">to</span> <span m="4238720">be</span> <span m="4238820">completely</span> <span m="4239270">superseded</span> <span m="4239940">by</span> <span m="4240080">this</span> <span m="4240300">plan</span> <span m="4240600">of</span> <span m="4240710">having</span> <span m="4240990">directory</span> <span m="4241430">file</span> <span m="4241650">descriptors</span> <span m="4242250">and</span> <span m="4242430">capabilities.</span> <span m="4242980">So that's great.</span> <span m="4243140">So</span> <span m="4243530">you</span> <span m="4243650">don't</span> <span m="4243790">need</span> <span m="4244410">the</span> <span m="4244510">chroots</span> <span m="4245250">setting</span> <span m="4245640">it up.</span> <span m="4245980">That seems</span> <span m="4246370">messy.</span> <span m="4246780">And</span> <span m="4246910">this</span> <span m="4247020">is</span> <span m="4247150">much</span> <span m="4247320">more</span> <span m="4247450">precise,</span> <span m="4248010">also.</span> <span m="4248270">Because</span> <span m="4248810">you</span> <span m="4248940">can--</span> <span m="4249350">instead</span> <span m="4249600">of</span> <span m="4249780">having</span> <span m="4250010">a</span> <span m="4250060">chroot</span> <span m="4250330">with</span> <span m="4250600">lots</span> <span m="4250735">of</span> <span m="4250870">little</span> <span m="4251340">things</span> <span m="4251600">in</span> <span m="4251690">there,</span> <span m="4251870">you</span> <span m="4251940">have</span> <span m="4252100">to</span> <span m="4252310">maybe</span> <span m="4252640">set</span> <span m="4252820">the</span> <span m="4252900">permissions</span> <span m="4253320">on there</span> <span m="4253610">carefully.</span> <span m="4254400">You</span> <span m="4254520">can just</span> <span m="4254880">open</span> <span m="4255130">exactly</span> <span m="4255770">the</span> <span m="4255890">files</span> <span m="4256320">that you need.</span> <span m="4256480">So that seems like</span> <span m="4257170">a</span> <span m="4257240">plus.</span> <span m="4258800">Any</span> <span m="4259710">other</span> <span m="4260340">benefits?</span> <span m="4260814">Yeah.</span> </p>
<p><span m="4261288">AUDIENCE:</span> <span m="4261762">[INAUDIBLE].</span> </p>
<p></p>
<p><span m="4266502">PROFESSOR: In</span> <span m="4266976">OKWS,</span> <span m="4267450">you mean?</span> </p>
<p><span m="4268232">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="4269036">PROFESSOR: Yeah.</span> <span m="4269438">So in</span> <span m="4269840">OKWS,</span> <span m="4269980">right, you have</span> <span m="4270160">this</span> <span m="4270450">OK</span> <span m="4270900">launcher</span> <span m="4271165">daemon</span> <span m="4271730">that had</span> <span m="4272340">to</span> <span m="4272840">launch</span> <span m="4273320">all</span> <span m="4273450">these</span> <span m="4273680">guys.</span> <span m="4274150">And</span> <span m="4274600">it</span> <span m="4274750">was</span> <span m="4274920">the</span> <span m="4275010">parent</span> <span m="4275440">process.</span> <span m="4275870">Only</span> <span m="4276320">when</span> <span m="4276720">they die,</span> <span m="4277010">the</span> <span m="4277140">signal</span> <span m="4277580">goes</span> <span m="4277790">back</span> <span m="4278030">to</span> <span m="4278170">this</span> <span m="4278390">okld</span> <span m="4279050">to</span> <span m="4279140">restart</span> <span m="4279750">the</span> <span m="4281180">crash</span> <span m="4281680">process.</span> <span m="4282600">And</span> <span m="4282810">that</span> <span m="4283010">thing</span> <span m="4283210">had to run this</span> <span m="4283590">root,</span> <span m="4283810">because</span> <span m="4284130">it had</span> <span m="4284400">to</span> <span m="4284490">sandbox</span> <span m="4284970">things.</span> <span m="4285700">There's</span> <span m="4286270">actually</span> <span m="4286510">a</span> <span m="4286620">number</span> <span m="4286850">of</span> <span m="4287010">things</span> <span m="4287310">you</span> <span m="4287390">could</span> <span m="4287520">do</span> <span m="4287600">better</span> <span m="4288140">with</span> <span m="4288330">Capsicum</span> <span m="4289528">in</span> <span m="4289956">OKWS.</span> </p>
<p><span m="4291240">So</span> <span m="4291500">one</span> <span m="4291710">example</span> <span m="4292260">is</span> <span m="4292620">you could</span> <span m="4292890">probably</span> <span m="4293200">have</span> <span m="4293640">okld</span> <span m="4294160">have</span> <span m="4294430">many</span> <span m="4294670">fewer</span> <span m="4294910">privileges.</span> <span m="4295410">Because</span> <span m="4296420">it</span> <span m="4296590">might</span> <span m="4296870">need</span> <span m="4297270">to</span> <span m="4297360">be</span> <span m="4297500">root</span> <span m="4297840">initially</span> <span m="4298280">to</span> <span m="4298350">get</span> <span m="4298630">fort</span> <span m="4299020">80.</span> <span m="4299410">But</span> <span m="4299910">after</span> <span m="4300240">that,</span> <span m="4300750">it</span> <span m="4300930">could set up</span> <span m="4301460">sandboxes</span> <span m="4301920">for</span> <span m="4302040">everyone</span> <span m="4302310">else</span> <span m="4302560">without</span> <span m="4302910">being</span> <span m="4303130">root</span> <span m="4303380">anymore.</span> <span m="4303640">So that's kind of</span> <span m="4303900">cool.</span> <span m="4304670">And</span> <span m="4305170">maybe you can</span> <span m="4305500">even</span> <span m="4305710">delegate</span> <span m="4306230">the</span> <span m="4306310">job</span> <span m="4306620">of</span> <span m="4306800">responding</span> <span m="4307460">a</span> <span m="4307530">process</span> <span m="4308010">to</span> <span m="4308200">someone</span> <span m="4308600">else,</span> <span m="4308870">maybe</span> <span m="4309240">a per</span> <span m="4309460">service</span> <span m="4309980">monitor</span> <span m="4310450">Damion</span> <span m="4310930">that just</span> <span m="4312250">has</span> <span m="4312560">this</span> <span m="4312750">process</span> <span m="4313005">descriptor</span> <span m="4313430">handle,</span> <span m="4314430">or</span> <span m="4314830">process</span> <span m="4315225">descriptor</span> <span m="4315620">for</span> <span m="4316070">child</span> <span m="4316590">process,</span> <span m="4316950">and</span> <span m="4317041">whenever</span> <span m="4317133">it</span> <span m="4317225">crashes,</span> <span m="4317500">starts</span> <span m="4317650">a</span> <span m="4317800">new</span> <span m="4318070">one.</span> </p>
<p><span m="4318870">So</span> <span m="4319170">I</span> <span m="4319300">think</span> <span m="4319880">this</span> <span m="4320070">process</span> <span m="4320400">[INAUDIBLE]</span> <span m="4321530">helps</span> <span m="4321670">things</span> <span m="4321810">a</span> <span m="4321940">lot.</span> <span m="4322745">And</span> <span m="4323000">the fact</span> <span m="4323130">that you can</span> <span m="4323630">create</span> <span m="4323940">a</span> <span m="4323990">sandbox</span> <span m="4324880">without</span> <span m="4325050">being</span> <span m="4325450">root</span> <span m="4326160">is</span> <span m="4326280">also</span> <span m="4327140">quite</span> <span m="4327330">helpful,</span> <span m="4327660">as</span> <span m="4327730">well.</span> <span m="4330020">Any other</span> <span m="4330390">stuff,</span> <span m="4330695">what you could do?</span> <span m="4331000">Yeah?</span> </p>
<p><span m="4331440">AUDIENCE: You could</span> <span m="4331880">give each one</span> <span m="4332320">a</span> <span m="4332730">file descriptor</span> <span m="4333020">with</span> <span m="4333220">append only mode</span> <span m="4333570">to</span> <span m="4333745">the</span> <span m="4333920">log.</span> </p>
<p><span m="4334387">PROFESSOR: Yeah.</span> <span m="4334854">So that's</span> <span m="4335790">pretty</span> <span m="4336480">cool.</span> <span m="4336750">So as we</span> <span m="4337160">were talking</span> <span m="4337440">last</span> <span m="4337650">time,</span> <span m="4337930">in</span> <span m="4338120">OKWS,</span> <span m="4339560">well,</span> <span m="4340615">the</span> <span m="4340870">oklogd</span> <span m="4341860">maybe</span> <span m="4342090">could</span> <span m="4342350">hamper</span> <span m="4342610">with the</span> <span m="4343120">log</span> <span m="4343420">file.</span> <span m="4343675">And</span> <span m="4343930">who knows what</span> <span m="4344570">the</span> <span m="4344940">kernel</span> <span m="4345220">will allow it</span> <span m="4345680">to</span> <span m="4345770">do</span> <span m="4345950">once it has</span> <span m="4346170">a</span> <span m="4346390">file</span> <span m="4346700">descriptor</span> <span m="4347230">on</span> <span m="4347430">the</span> <span m="4347510">log</span> <span m="4347710">file</span> <span m="4347970">itself.</span> <span m="4348670">But</span> <span m="4348770">here,</span> <span m="4349110">the</span> <span m="4349210">fact that</span> <span m="4349420">we</span> <span m="4349480">can</span> <span m="4349690">do</span> <span m="4350090">much more of a</span> <span m="4350370">precise</span> <span m="4351800">capability</span> <span m="4352440">map</span> <span m="4353010">on a file</span> <span m="4353340">descriptor,</span> <span m="4354020">well,</span> <span m="4354280">we</span> <span m="4354370">could</span> <span m="4354550">give it</span> <span m="4354710">a</span> <span m="4354770">log</span> <span m="4355100">file</span> <span m="4355630">and</span> <span m="4355780">say,</span> <span m="4355970">well,</span> <span m="4356090">you</span> <span m="4356160">could</span> <span m="4356280">just</span> <span m="4356490">write</span> <span m="4356830">to it,</span> <span m="4356960">but</span> <span m="4357150">not</span> <span m="4357390">seek.</span> <span m="4357895">So that</span> <span m="4358360">basically</span> <span m="4358790">means</span> <span m="4358910">append only,</span> <span m="4360150">if</span> <span m="4360500">you're</span> <span m="4360770">the only</span> <span m="4361270">writer</span> <span m="4361460">to that</span> <span m="4361810">file.</span> <span m="4362435">So that seems</span> <span m="4362740">kind of nice.</span> </p>
<p><span m="4363060">And</span> <span m="4363550">you</span> <span m="4363650">could</span> <span m="4363900">prevent</span> <span m="4364200">it</span> <span m="4364320">from</span> <span m="4364470">reading</span> <span m="4364790">a</span> <span m="4365180">file.</span> <span m="4365270">You could say,</span> <span m="4365470">well,</span> <span m="4365550">you</span> <span m="4365710">can only</span> <span m="4365920">write,</span> <span m="4366230">but not read,</span> <span m="4367140">which</span> <span m="4367190">is</span> <span m="4367270">something</span> <span m="4367500">that's</span> <span m="4368070">probably</span> <span m="4368270">difficult</span> <span m="4368560">to</span> <span m="4368610">do</span> <span m="4368740">with</span> <span m="4368930">Unix</span> <span m="4369190">permissions</span> <span m="4369600">alone</span> <span m="4370040">right now.</span> <span m="4373253">Make sense?</span> <span m="4374630">Any</span> <span m="4374790">other</span> <span m="4375180">ideas</span> <span m="4375630">for</span> <span m="4375930">how</span> <span m="4376390">Capsicum might</span> <span m="4376850">help?</span> <span m="4379680">Would you</span> <span m="4379880">wish</span> <span m="4380140">there</span> <span m="4380390">was</span> <span m="4380820">more stuff</span> <span m="4380990">in</span> <span m="4381400">Capsicum?</span> <span m="4381815">I guess we always</span> <span m="4382230">wish there was more stuff.</span> </p>
<p><span m="4383670">AUDIENCE: So</span> <span m="4383990">one thing</span> <span m="4384100">that</span> <span m="4384440">perhaps</span> <span m="4384803">may</span> <span m="4384984">be</span> <span m="4385166">tricky is</span> <span m="4385920">the</span> <span m="4386310">service</span> <span m="4386710">team</span> <span m="4387080">daemons</span> <span m="4387203">need</span> <span m="4387326">to</span> <span m="4387450">connected</span> <span m="4387913">to their</span> <span m="4388839">backend</span> <span m="4389765">databases</span> <span m="4390228">somehow.</span> <span m="4391617">Which</span> <span m="4392080">might be</span> <span m="4392543">remotely.</span> <span m="4393470">But</span> <span m="4393700">you</span> <span m="4393860">don't</span> <span m="4394060">want</span> <span m="4394360">the</span> <span m="4394590">launch</span> <span m="4394960">daemon</span> <span m="4395235">to</span> <span m="4395510">know</span> <span m="4395920">about which</span> <span m="4396200">services</span> <span m="4396800">each</span> <span m="4396960">service</span> <span m="4397235">is going to</span> <span m="4397510">connect to.</span> </p>
<p><span m="4399040">PROFESSOR: Maybe,</span> <span m="4399360">yeah.</span> <span m="4399680">That's</span> <span m="4400120">a good</span> <span m="4400250">question,</span> <span m="4400600">right?</span> <span m="4400890">So</span> <span m="4401520">in</span> <span m="4401770">Capsicum,</span> <span m="4403210">as</span> <span m="4403400">we</span> <span m="4403470">were</span> <span m="4403560">talking</span> <span m="4403830">about,</span> <span m="4403990">the</span> <span m="4404070">network</span> <span m="4404470">is</span> <span m="4404910">in</span> <span m="4405050">global</span> <span m="4405360">namespace.</span> <span m="4405780">You</span> <span m="4405890">have</span> <span m="4406040">to</span> <span m="4406130">have</span> <span m="4406320">existing</span> <span m="4407050">file</span> <span m="4407460">descriptors</span> <span m="4407570">for all the</span> <span m="4408320">outstanding</span> <span m="4408750">connections</span> <span m="4409136">ahead of time.</span> </p>
<p><span m="4409910">AUDIENCE: Right.</span> <span m="4410280">But</span> <span m="4410750">you don't necessarily</span> <span m="4411000">want</span> <span m="4411470">okld</span> <span m="4412410">to</span> <span m="4412880">open</span> <span m="4413060">up</span> <span m="4413196">all</span> <span m="4413333">the</span> <span m="4413470">sockets</span> <span m="4413675">for</span> <span m="4413880">all the services.</span> <span m="4414700">Because</span> <span m="4415295">it</span> <span m="4415590">might</span> <span m="4415800">not</span> <span m="4416060">know</span> <span m="4416360">where</span> <span m="4416806">the services</span> <span m="4417252">are</span> <span m="4417700">connected.</span> </p>
<p><span m="4417940">PROFESSOR: That's right.</span> <span m="4418140">Yeah.</span> <span m="4418510">So that's a</span> <span m="4418750">little</span> <span m="4418890">bit</span> <span m="4419010">of</span> <span m="4419180">an</span> <span m="4419410">awkward</span> <span m="4419730">thing.</span> <span m="4419960">I</span> <span m="4420410">absolutely</span> <span m="4420580">agree.</span> <span m="4420850">And this is</span> <span m="4421750">part</span> <span m="4421950">of</span> <span m="4422050">the</span> <span m="4422200">reason</span> <span m="4422440">why</span> <span m="4422700">I think</span> <span m="4422890">capabilities</span> <span m="4423620">haven't</span> <span m="4424620">completely</span> <span m="4424950">subsumed</span> <span m="4425470">everything</span> <span m="4425940">in the</span> <span m="4426040">security</span> <span m="4426410">world,</span> <span m="4426830">is because</span> <span m="4427070">they</span> <span m="4427150">are</span> <span m="4427300">kind</span> <span m="4427480">of</span> <span m="4427620">awkward</span> <span m="4428120">to use.</span> <span m="4428350">Because the</span> <span m="4428460">guy</span> <span m="4428750">that</span> <span m="4429200">gives</span> <span m="4429510">you</span> <span m="4429870">all the</span> <span m="4430330">privileges has</span> <span m="4430530">to</span> <span m="4430650">know</span> <span m="4430880">exactly</span> <span m="4431240">what</span> <span m="4431490">things</span> <span m="4431790">you're going</span> <span m="4432010">to</span> <span m="4432060">need,</span> <span m="4432420">like</span> <span m="4432640">these</span> <span m="4433140">connections</span> <span m="4433510">to</span> <span m="4433700">backend</span> <span m="4434080">servers.</span> </p>
<p><span m="4435100">So</span> <span m="4435200">at</span> <span m="4435410">some</span> <span m="4435610">level,</span> <span m="4435880">maybe</span> <span m="4436100">this</span> <span m="4436280">is</span> <span m="4436460">not</span> <span m="4436950">such</span> <span m="4437480">a</span> <span m="4437520">huge</span> <span m="4437820">problem</span> <span m="4438150">in</span> <span m="4438250">OKWS.</span> <span m="4438650">Because</span> <span m="4439270">the</span> <span m="4439590">launcher</span> <span m="4439820">daemon</span> <span m="4440660">has to read</span> <span m="4440910">a</span> <span m="4440990">Config</span> <span m="4441330">file</span> <span m="4441750">and is</span> <span m="4441980">going to pass</span> <span m="4442300">the</span> <span m="4442500">token</span> <span m="4442960">to</span> <span m="4443060">the</span> <span m="4443210">service</span> <span m="4443610">in</span> <span m="4443670">the</span> <span m="4443730">first</span> <span m="4443990">place.</span> <span m="4444190">So</span> <span m="4444290">maybe</span> <span m="4444830">the</span> <span m="4444940">token</span> <span m="4445270">is</span> <span m="4445360">going</span> <span m="4445460">to</span> <span m="4445510">contain</span> <span m="4445990">the</span> <span m="4446290">host</span> <span m="4446730">and</span> <span m="4446870">port</span> <span m="4447070">number</span> <span m="4447320">to which you're connected</span> <span m="4447740">to.</span> <span m="4448580">But I agree.</span> <span m="4448820">It's not</span> <span m="4448890">great.</span> </p>
<p><span m="4450360">Because</span> <span m="4450590">especially,</span> <span m="4450980">suppose</span> <span m="4451200">the</span> <span m="4451310">database</span> <span m="4451730">server</span> <span m="4452590">disconnects</span> <span m="4453260">you.</span> <span m="4453780">Well,</span> <span m="4454070">you're kind</span> <span m="4454380">of stuck now.</span> <span m="4455150">The</span> <span m="4455560">file</span> <span m="4455780">server</span> <span m="4456170">is</span> <span m="4456250">not</span> <span m="4456500">connected</span> <span m="4456760">anymore,</span> <span m="4457135">and you can't connect to</span> <span m="4457510">a</span> <span m="4457785">new one.</span> <span m="4458060">So basically, if the</span> <span m="4458450">database</span> <span m="4458780">server</span> <span m="4459060">crashes,</span> <span m="4459750">or</span> <span m="4459940">restarts,</span> <span m="4460430">or the network</span> <span m="4461280">breaks,</span> <span m="4461780">you basically</span> <span m="4462130">have to</span> <span m="4462690">terminate</span> <span m="4463100">it,</span> <span m="4463370">get</span> <span m="4463540">yourself</span> <span m="4463880">response,</span> <span m="4464500">so you can</span> <span m="4464640">get</span> <span m="4464810">a</span> <span m="4465020">new</span> <span m="4465160">one</span> <span m="4465360">of</span> <span m="4465470">these</span> <span m="4465680">connections</span> <span m="4466280">past</span> <span m="4466440">you.</span> <span m="4467230">So it's maybe</span> <span m="4467350">not a</span> <span m="4467540">great</span> <span m="4467630">plan in that</span> <span m="4467800">sense.</span> </p>
<p><span m="4468582">AUDIENCE: Could we</span> <span m="4469074">wrap</span> <span m="4469566">the</span> <span m="4470550">system</span> <span m="4471534">call,</span> <span m="4472026">the</span> <span m="4472272">function</span> <span m="4472518">[INAUDIBLE]</span> <span m="4473010">to</span> <span m="4473256">open</span> <span m="4473502">a</span> <span m="4473994">socket</span> <span m="4474486">so that it</span> <span m="4474978">faults the</span> <span m="4475470">middleman</span> <span m="4475962">instead of the</span> <span m="4476454">socket</span> <span m="4476946">that</span> <span m="4477069">the</span> <span m="4477192">users</span> <span m="4477315">send</span> <span m="4477438">out</span> <span m="4477602">to</span> <span m="4477766">[INAUDIBLE]?</span> </p>
<p><span m="4479420">PROFESSOR: Yeah.</span> <span m="4479920">This</span> <span m="4479970">is</span> <span m="4480020">what</span> <span m="4480115">I</span> <span m="4480210">think</span> <span m="4480500">the</span> <span m="4480900">FreeBSD</span> <span m="4481300">guys</span> <span m="4481700">have</span> <span m="4481950">done</span> <span m="4482320">since.</span> <span m="4483130">Well,</span> <span m="4484370">there's</span> <span m="4485050">a</span> <span m="4485530">bunch</span> <span m="4485780">of</span> <span m="4485850">situations</span> <span m="4486330">like</span> <span m="4486570">this,</span> <span m="4486820">where</span> <span m="4486940">you</span> <span m="4487040">want</span> <span m="4487170">to</span> <span m="4487340">open</span> <span m="4487640">some</span> <span m="4487780">file</span> <span m="4488130">after</span> <span m="4488450">the</span> <span m="4488550">fact,</span> <span m="4488770">or you</span> <span m="4488850">want</span> <span m="4488980">to</span> <span m="4489040">connect</span> <span m="4489630">to</span> <span m="4489780">something</span> <span m="4490070">after</span> <span m="4490410">going into</span> <span m="4490750">capability</span> <span m="4491200">mode.</span> <span m="4491880">So</span> <span m="4492370">the</span> <span m="4492580">FreeBSD</span> <span m="4493560">developers have</span> <span m="4493770">added</span> <span m="4494060">this</span> <span m="4494470">daemon</span> <span m="4494940">called</span> <span m="4495210">Casper,</span> <span m="4496020">that</span> <span m="4496600">every</span> <span m="4497050">capability</span> <span m="4497560">based</span> <span m="4497870">process</span> <span m="4498250">has</span> <span m="4498410">a</span> <span m="4498450">handle</span> <span m="4498900">on.</span> <span m="4499470">And</span> <span m="4500270">this</span> <span m="4500530">Casper</span> <span m="4500890">daemon</span> <span m="4501350">runs</span> <span m="4501620">outside</span> <span m="4501990">of</span> <span m="4502060">capability</span> <span m="4502530">mode,</span> <span m="4503010">and</span> <span m="4503200">basically</span> <span m="4503440">listens</span> <span m="4503860">to</span> <span m="4503940">requests</span> <span m="4504470">from</span> <span m="4504690">sandbox</span> <span m="4505240">processes.</span> </p>
<p><span m="4506380">And</span> <span m="4508090">if</span> <span m="4508450">you</span> <span m="4508570">want</span> <span m="4508720">to</span> <span m="4508770">open</span> <span m="4509090">some</span> <span m="4509240">file,</span> <span m="4509790">or</span> <span m="4510460">if</span> <span m="4510540">you</span> <span m="4510620">want</span> <span m="4510740">to</span> <span m="4510800">send</span> <span m="4511000">a</span> <span m="4511060">network</span> <span m="4511360">connection,</span> <span m="4511810">or</span> <span m="4511930">a</span> <span m="4512000">packet,</span> <span m="4512400">or</span> <span m="4512520">something,</span> <span m="4513520">but</span> <span m="4513720">you</span> <span m="4513810">didn't</span> <span m="4514000">have</span> <span m="4514290">the</span> <span m="4514360">right</span> <span m="4514560">capability</span> <span m="4514980">beforehand,</span> <span m="4515680">then this</span> <span m="4515900">Casper</span> <span m="4516200">daemon</span> <span m="4516600">will</span> <span m="4516990">do</span> <span m="4517120">it</span> <span m="4517250">for</span> <span m="4517540">you.</span> <span m="4518250">But</span> <span m="4518600">it</span> <span m="4518900">carefully</span> <span m="4519300">maintains</span> <span m="4519900">a</span> <span m="4519970">list</span> <span m="4520310">of</span> <span m="4520480">things</span> <span m="4521030">that</span> <span m="4521220">every</span> <span m="4521550">sandbox</span> <span m="4522020">process</span> <span m="4522360">should</span> <span m="4522600">or</span> <span m="4522680">should</span> <span m="4522830">not</span> <span m="4522980">be</span> <span m="4523080">able</span> <span m="4523250">to</span> <span m="4523350">do.</span> <span m="4524010">So it's</span> <span m="4524440">like</span> <span m="4524570">a</span> <span m="4524650">systems</span> <span m="4525000">service.</span> <span m="4525870">So</span> <span m="4526330">when</span> <span m="4526470">you</span> <span m="4526580">start</span> <span m="4526845">a</span> <span m="4527110">capability</span> <span m="4527690">process,</span> <span m="4528400">or</span> <span m="4528630">enter</span> <span m="4529040">capability</span> <span m="4529350">mode,</span> <span m="4529900">by</span> <span m="4530040">default,</span> <span m="4530900">this</span> <span m="4531060">Casper</span> <span m="4531430">thing</span> <span m="4531630">will not</span> <span m="4532020">allow you to do</span> <span m="4532440">anything</span> <span m="4532780">extra</span> <span m="4533080">funny.</span> </p>
<p><span m="4533620">But</span> <span m="4533770">you</span> <span m="4533840">could</span> <span m="4534010">say,</span> <span m="4534260">well,</span> <span m="4534680">hey,</span> <span m="4535140">I'm</span> <span m="4535250">going</span> <span m="4535360">to</span> <span m="4535410">start</span> <span m="4535620">the</span> <span m="4535710">sandbox</span> <span m="4536170">process.</span> <span m="4537050">And</span> <span m="4537530">you</span> <span m="4537640">can</span> <span m="4537790">ask</span> <span m="4538120">Casper,</span> <span m="4538490">well,</span> <span m="4538740">please</span> <span m="4539030">allow</span> <span m="4539930">my</span> <span m="4540110">process</span> <span m="4540750">to</span> <span m="4540860">do</span> <span m="4540940">the</span> <span m="4541170">following</span> <span m="4541540">things</span> <span m="4541820">later.</span> <span m="4543000">So</span> <span m="4543310">you</span> <span m="4543400">could,</span> <span m="4543600">right?</span> <span m="4543810">And</span> <span m="4544030">the</span> <span m="4544110">cool</span> <span m="4544270">thing</span> <span m="4544420">is</span> <span m="4544530">that you can</span> <span m="4544950">pass</span> <span m="4545530">file</span> <span m="4545780">descriptors</span> <span m="4546240">or</span> <span m="4546360">capabilities</span> <span m="4547000">through</span> <span m="4547200">fd</span> <span m="4547470">passing</span> <span m="4547870">in Unix.</span> <span m="4548700">So</span> <span m="4548980">once</span> <span m="4549450">you</span> <span m="4549580">have</span> <span m="4549790">a</span> <span m="4549850">handle</span> <span m="4550340">on this</span> <span m="4550480">Casper</span> <span m="4550840">guy,</span> <span m="4551520">you</span> <span m="4551690">can</span> <span m="4552330">get</span> <span m="4552560">more</span> <span m="4552790">capabilities</span> <span m="4553340">later</span> <span m="4553610">on.</span> <span m="4555120">So it's,</span> <span m="4555360">again,</span> <span m="4556550">trade</span> <span m="4556850">off</span> <span m="4557010">between</span> <span m="4557290">being</span> <span m="4557560">pure</span> <span m="4557990">capability</span> <span m="4558680">world</span> <span m="4559140">versus</span> <span m="4559490">actually</span> <span m="4560300">being</span> <span m="4560665">programmable</span> <span m="4561030">or</span> <span m="4561260">easy</span> <span m="4561440">to</span> <span m="4561490">use.</span> </p>
<p><span m="4564330">So</span> <span m="4564420">it</span> <span m="4564490">seems</span> <span m="4564660">to</span> <span m="4565180">be</span> <span m="4565270">working</span> <span m="4565590">out.</span> <span m="4566110">I</span> <span m="4566220">think</span> <span m="4566400">the</span> <span m="4566510">particular</span> <span m="4566890">thing</span> <span m="4567110">they</span> <span m="4568140">use</span> <span m="4568440">it</span> <span m="4568580">for</span> <span m="4568930">in</span> <span m="4569310">FreeBSD,</span> <span m="4570230">or the thing</span> <span m="4570330">that</span> <span m="4570490">shows up</span> <span m="4571000">often,</span> <span m="4571310">is</span> <span m="4571640">making</span> <span m="4572100">DNS</span> <span m="4572510">queries.</span> <span m="4573510">So</span> <span m="4573610">you</span> <span m="4573740">want</span> <span m="4573920">to</span> <span m="4573990">be</span> <span m="4574160">able</span> <span m="4574330">to</span> <span m="4574400">make</span> <span m="4574560">DNS</span> <span m="4574870">queries</span> <span m="4575290">once</span> <span m="4575500">you're</span> <span m="4575600">in</span> <span m="4575670">a</span> <span m="4575730">sandbox.</span> <span m="4576150">And</span> <span m="4576440">actually,</span> <span m="4576670">this is</span> <span m="4576850">a</span> <span m="4576930">problem</span> <span m="4577170">they</span> <span m="4577290">ran</span> <span m="4577500">into</span> <span m="4577750">with</span> <span m="4577930">tcpdump.</span> <span m="4578520">Because</span> <span m="4579150">when</span> <span m="4579490">tcpdump</span> <span m="4579750">is</span> <span m="4580050">printing</span> <span m="4580200">your</span> <span m="4580460">packets,</span> <span m="4580850">it wants to</span> <span m="4581010">print the</span> <span m="4581360">host name</span> <span m="4581610">for an</span> <span m="4581920">IP</span> <span m="4582170">address.</span> </p>
<p><span m="4582580">In order</span> <span m="4582790">to do this,</span> <span m="4583010">it has to talk to</span> <span m="4583320">a</span> <span m="4583490">DNS</span> <span m="4584110">server.</span> <span m="4584680">But</span> <span m="4585120">you</span> <span m="4585210">probably</span> <span m="4585430">don't</span> <span m="4585570">want</span> <span m="4585700">to</span> <span m="4585780">connect to a</span> <span m="4586240">DNS</span> <span m="4586600">server</span> <span m="4586940">ahead</span> <span m="4587180">of</span> <span m="4587300">time,</span> <span m="4587910">or</span> <span m="4588080">to</span> <span m="4588190">every</span> <span m="4588460">DNS</span> <span m="4588740">server</span> <span m="4588940">you</span> <span m="4589010">might</span> <span m="4589180">ever</span> <span m="4589340">need.</span> <span m="4590320">So</span> <span m="4590690">instead,</span> <span m="4591110">they</span> <span m="4591220">use</span> <span m="4591460">this</span> <span m="4591620">helper</span> <span m="4591930">daemon</span> <span m="4592230">that's</span> <span m="4592480">going</span> <span m="4592570">to</span> <span m="4592660">make</span> <span m="4592750">DNS</span> <span m="4592800">queries</span> <span m="4593650">for</span> <span m="4593880">you.</span> <span m="4595440">Make sense?</span> <span m="4597388">All right.</span> </p>
<p><span m="4598750">So</span> <span m="4599290">I</span> <span m="4599350">guess</span> <span m="4599510">the</span> <span m="4600050">last</span> <span m="4600670">thing</span> <span m="4600940">I</span> <span m="4601370">wanted</span> <span m="4601600">to</span> <span m="4602800">talk</span> <span m="4602840">about is</span> <span m="4603110">what</span> <span m="4603290">are</span> <span m="4603460">the</span> <span m="4604460">security</span> <span m="4604840">guarantees</span> <span m="4605390">that</span> <span m="4605770">Capsicum</span> <span m="4606400">provides?</span> <span m="4606810">So</span> <span m="4607400">should</span> <span m="4607590">you</span> <span m="4608460">trust it?</span> <span m="4609120">How</span> <span m="4609470">could</span> <span m="4609830">Capsicum go</span> <span m="4610400">wrong?</span> <span m="4614090">Presumably</span> <span m="4614160">you can</span> <span m="4614420">always</span> <span m="4614690">have</span> <span m="4614810">security</span> <span m="4615120">problems,</span> <span m="4615440">regardless</span> <span m="4615960">of</span> <span m="4616060">what</span> <span m="4617210">mechanism</span> <span m="4617560">you're using</span> <span m="4617740">underneath.</span> <span m="4617890">But</span> <span m="4617990">what</span> <span m="4618560">particular</span> <span m="4618890">things</span> <span m="4619110">should we</span> <span m="4619370">worry</span> <span m="4619640">about</span> <span m="4620260">in</span> <span m="4620440">Capsicum</span> <span m="4620970">when</span> <span m="4621140">we're</span> <span m="4621930">building</span> <span m="4622330">some</span> <span m="4622570">system</span> <span m="4622900">here?</span> </p>
<p><span m="4626710">Suppose</span> <span m="4626800">you</span> <span m="4626870">have</span> <span m="4627050">to</span> <span m="4627130">attack</span> <span m="4627430">this thing.</span> <span m="4628680">You</span> <span m="4628780">have</span> <span m="4628930">to</span> <span m="4629020">attack this</span> <span m="4629660">tcpdump</span> <span m="4630170">thing,</span> <span m="4630630">or</span> <span m="4631290">gzip,</span> <span m="4631970">or whatever it is</span> <span m="4632330">that they</span> <span m="4632620">implemented.</span> <span m="4634060">What</span> <span m="4634200">would you look at,</span> <span m="4634900">in</span> <span m="4635000">terms</span> <span m="4635260">of</span> <span m="4635960">bugs or</span> <span m="4637800">problems?</span> </p>
<p><span m="4638692">AUDIENCE: Well, it depends</span> <span m="4639164">on the</span> <span m="4639636">developers knowing</span> <span m="4640108">what they're</span> <span m="4640580">doing.</span> <span m="4641524">So they might give</span> <span m="4642940">a</span> <span m="4643412">bad</span> <span m="4643884">capability.</span> </p>
<p><span m="4644830">PROFESSOR: That's</span> <span m="4645090">right. Yeah.</span> <span m="4645350">So it's actually</span> <span m="4645780">one</span> <span m="4646020">interesting</span> <span m="4646440">property</span> <span m="4646850">of</span> <span m="4647220">Capsicum</span> <span m="4647710">is</span> <span m="4648020">that</span> <span m="4648330">it's</span> <span m="4648500">not</span> <span m="4648650">a</span> <span m="4648700">guarantee</span> <span m="4648970">that</span> <span m="4649240">the</span> <span m="4649760">user</span> <span m="4650070">of</span> <span m="4650160">the</span> <span m="4650250">system</span> <span m="4650640">gets.</span> <span m="4651430">It's</span> <span m="4651640">really</span> <span m="4651940">a</span> <span m="4652100">tool</span> <span m="4652540">that the</span> <span m="4652630">developer</span> <span m="4653290">has</span> <span m="4653980">to</span> <span m="4654430">build</span> <span m="4654740">more</span> <span m="4654970">trustworthy</span> <span m="4655670">or</span> <span m="4655800">better</span> <span m="4656140">application</span> <span m="4656760">software.</span> <span m="4658260">But</span> <span m="4658570">I,</span> <span m="4658750">as</span> <span m="4658940">a user of the system,</span> <span m="4659480">have</span> <span m="4659700">no</span> <span m="4659960">idea</span> <span m="4660220">whether</span> <span m="4660780">this is a</span> <span m="4661330">good or bad</span> <span m="4661450">thing that the</span> <span m="4662080">application</span> <span m="4662340">is using</span> <span m="4662600">Capsicum.</span> <span m="4663170">You</span> <span m="4663830">could</span> <span m="4664220">totally</span> <span m="4664330">misuse</span> <span m="4664620">it,</span> <span m="4664910">as</span> <span m="4665230">you're</span> <span m="4665550">absolutely</span> <span m="4665680">right.</span> </p>
<p><span m="4666440">So</span> <span m="4666605">maybe</span> <span m="4666770">one</span> <span m="4667220">example</span> <span m="4667670">is,</span> <span m="4667810">as</span> <span m="4668000">they</span> <span m="4668210">show</span> <span m="4668440">in the</span> <span m="4668560">paper,</span> <span m="4669170">you</span> <span m="4669380">could</span> <span m="4669930">give</span> <span m="4670160">too</span> <span m="4670330">many</span> <span m="4670510">privileges</span> <span m="4670750">to the</span> <span m="4671360">sandbox</span> <span m="4671675">process.</span> <span m="4671990">Like the</span> <span m="4672240">the</span> <span m="4672480">TCP</span> <span m="4672790">helper,</span> <span m="4673100">or</span> <span m="4673590">maybe</span> <span m="4673810">it has access to my</span> <span m="4674420">console.</span> <span m="4675030">And that's</span> <span m="4675790">not so</span> <span m="4676560">great,</span> <span m="4676810">but</span> <span m="4677050">it's</span> <span m="4677280">hard</span> <span m="4677580">for</span> <span m="4677730">me</span> <span m="4677900">as</span> <span m="4677990">a</span> <span m="4678210">user to</span> <span m="4678670">really tell this</span> <span m="4678940">in a</span> <span m="4679350">general</span> <span m="4679640">purpose</span> <span m="4680010">fashion.</span> <span m="4681130">Yeah?</span> </p>
<p><span m="4681828">AUDIENCE: It might also</span> <span m="4682286">be</span> <span m="4682744">that</span> <span m="4684120">when</span> <span m="4684385">you</span> <span m="4684650">set</span> <span m="4684820">the</span> <span m="4685340">permissions to the</span> <span m="4685650">masks</span> <span m="4686750">on</span> <span m="4686950">any</span> <span m="4687150">given</span> <span m="4688124">file</span> <span m="4688611">descriptor</span> <span m="4689100">that you</span> <span m="4689250">set</span> <span m="4689505">two</span> <span m="4689760">permission</span> <span m="4690460">masks.</span> </p>
<p><span m="4691360">PROFESSOR: Yeah.</span> <span m="4691970">Right.</span> <span m="4692170">So it's</span> <span m="4692760">not</span> <span m="4693020">just</span> <span m="4693220">the file descriptors.</span> <span m="4693720">Also,</span> <span m="4694080">what</span> <span m="4694280">can you</span> <span m="4694410">do</span> <span m="4694530">with</span> <span m="4694730">those</span> <span m="4694930">file</span> <span m="4695120">descriptors?</span> <span m="4695610">You're right.</span> <span m="4696220">Yes.</span> <span m="4696450">These</span> <span m="4696640">maps</span> <span m="4697070">are</span> <span m="4697340">another</span> <span m="4697660">part</span> <span m="4697950">of</span> <span m="4698020">the story that you have to</span> <span m="4698980">watch out</span> <span m="4699240">for.</span> <span m="4701460">OK.</span> <span m="4701980">So</span> <span m="4702300">suppose we</span> <span m="4702440">got</span> <span m="4702600">the</span> <span m="4703040">masks</span> <span m="4703620">right.</span> <span m="4704150">We</span> <span m="4704270">got the file</span> <span m="4704410">descriptors</span> <span m="4704710">right.</span> <span m="4705010">We</span> <span m="4705260">haven't used</span> <span m="4705820">lth_start.</span> <span m="4706120">There's</span> <span m="4706880">nothing</span> <span m="4707030">extra in</span> <span m="4707640">memory.</span> </p>
<p><span m="4708740">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="4711330">PROFESSOR: That's true.</span> <span m="4711490">Yes.</span> <span m="4711990">So maybe</span> <span m="4712260">there's</span> <span m="4712560">like</span> <span m="4712730">something</span> <span m="4713060">before</span> <span m="4713530">you</span> <span m="4713710">even</span> <span m="4714030">add the</span> <span m="4714300">capability</span> <span m="4714570">mode</span> <span m="4714730">that's</span> <span m="4715060">damaging.</span> <span m="4715950">So</span> <span m="4716400">it</span> <span m="4716480">only</span> <span m="4717030">helps</span> <span m="4717880">once you</span> <span m="4717990">jump</span> <span m="4718280">in.</span> <span m="4719030">And</span> <span m="4719440">one</span> <span m="4721130">slightly</span> <span m="4721590">annoying</span> <span m="4721870">thing</span> <span m="4722120">is</span> <span m="4722240">that</span> <span m="4723270">it</span> <span m="4723450">seems</span> <span m="4723760">like</span> <span m="4723910">it</span> <span m="4724040">can't</span> <span m="4724480">do</span> <span m="4724720">a</span> <span m="4724770">whole</span> <span m="4725410">lot</span> <span m="4726080">inside</span> <span m="4726730">of</span> <span m="4726850">capability</span> <span m="4727360">mode,</span> <span m="4728550">not</span> <span m="4728820">in</span> <span m="4728900">the</span> <span m="4728980">sense</span> <span m="4729240">that</span> <span m="4729430">you</span> <span m="4729530">can't</span> <span m="4730100">run</span> <span m="4730690">large</span> <span m="4730950">computations,</span> <span m="4731560">but</span> <span m="4732155">you can't</span> <span m="4733110">really put a</span> <span m="4733210">large</span> <span m="4733810">part</span> <span m="4734010">of</span> <span m="4734070">a</span> <span m="4734170">complicated</span> <span m="4734720">system</span> <span m="4735010">into</span> <span m="4735330">capability</span> <span m="4735710">mode.</span> <span m="4735900">Because</span> <span m="4736170">inevitably,</span> <span m="4736460">in</span> <span m="4736750">Unix,</span> <span m="4737100">you'll</span> <span m="4737250">need</span> <span m="4737570">to</span> <span m="4737630">do</span> <span m="4737790">something</span> <span m="4738290">with</span> <span m="4738930">new</span> <span m="4739160">processes,</span> <span m="4739820">opening</span> <span m="4740200">network</span> <span m="4740370">connections,</span> <span m="4740670">et</span> <span m="4740970">cetera.</span> </p>
<p><span m="4741870">And</span> <span m="4742270">you'll</span> <span m="4742500">probably</span> <span m="4742830">need</span> <span m="4743090">to</span> <span m="4743355">use some of these</span> <span m="4743790">global</span> <span m="4744080">namespaces</span> <span m="4744680">that</span> <span m="4744810">are</span> <span m="4744890">not</span> <span m="4745130">available</span> <span m="4745600">in</span> <span m="4746050">capability mode.</span> <span m="4746790">So</span> <span m="4746900">it's</span> <span m="4747000">probably</span> <span m="4747390">going</span> <span m="4747520">to</span> <span m="4747590">be</span> <span m="4748050">quite</span> <span m="4748330">difficult</span> <span m="4748680">to</span> <span m="4748750">put</span> <span m="4748990">large</span> <span m="4749530">chunks</span> <span m="4749810">of</span> <span m="4749940">logic</span> <span m="4750690">or</span> <span m="4751530">intricate</span> <span m="4752430">system</span> <span m="4752790">code</span> <span m="4753610">inside</span> <span m="4754010">of</span> <span m="4754305">capability mode.</span> <span m="4755370">So only</span> <span m="4757880">well-defined</span> <span m="4758830">chunks</span> <span m="4759100">of</span> <span m="4759170">an</span> <span m="4759250">application</span> <span m="4759760">are</span> <span m="4759890">likely</span> <span m="4760260">to</span> <span m="4760320">be</span> <span m="4760440">running</span> <span m="4760800">in capability mode.</span> <span m="4762580">It</span> <span m="4762680">depends.</span> <span m="4763000">I don't know if this is</span> <span m="4763720">entirely</span> <span m="4764140">true or not.</span> <span m="4765520">In</span> <span m="4765720">Chrome,</span> <span m="4766080">for</span> <span m="4766220">example,</span> <span m="4766660">large</span> <span m="4767030">processes do run</span> <span m="4767480">in</span> <span m="4767580">capability</span> <span m="4767870">mode</span> <span m="4768180">in</span> <span m="4768540">their</span> <span m="4768650">design.</span> </p>
<p><span m="4770460">It</span> <span m="4771030">might</span> <span m="4771220">be</span> <span m="4771320">that</span> <span m="4771550">you</span> <span m="4772105">basically</span> <span m="4772380">have</span> <span m="4772960">to</span> <span m="4773640">have</span> <span m="4773900">non-capability mode</span> <span m="4774560">chunks</span> <span m="4774933">of</span> <span m="4775850">your</span> <span m="4776020">application</span> <span m="4777190">because</span> <span m="4777640">you</span> <span m="4777750">wanted</span> <span m="4778320">to</span> <span m="4778770">incorporate</span> <span m="4779370">nicely</span> <span m="4779680">with</span> <span m="4779920">Unix,</span> <span m="4780390">or</span> <span m="4780640">whatever</span> <span m="4780930">is</span> <span m="4781220">is</span> <span m="4781460">you're</span> <span m="4781640">running</span> <span m="4782160">alongside</span> <span m="4782460">of</span> <span m="4782610">it.</span> </p>
<p><span m="4784330">OK.</span> <span m="4784910">Any</span> <span m="4785070">other</span> <span m="4785270">thing</span> <span m="4785490">you</span> <span m="4785550">should</span> <span m="4785700">worry</span> <span m="4785870">about?</span> <span m="4788460">Yeah?</span> </p>
<p><span m="4789170">AUDIENCE: Well,</span> <span m="4789510">whether they</span> <span m="4790320">implemented</span> <span m="4791050">capabilities</span> <span m="4791450">correctly.</span> </p>
<p><span m="4792090">PROFESSOR: Yeah.</span> </p>
<p><span m="4793012">AUDIENCE: Whether</span> <span m="4793473">they've covered</span> <span m="4793934">all the</span> <span m="4794395">system</span> <span m="4794856">calls.</span> </p>
<p><span m="4795320">PROFESSOR: That's</span> <span m="4795490">right.</span> <span m="4795750">Yes.</span> <span m="4796010">So that's actually</span> <span m="4796240">a</span> <span m="4796300">huge</span> <span m="4796790">problem,</span> <span m="4797390">in</span> <span m="4797670">some</span> <span m="4797850">sense,</span> <span m="4798220">already.</span> <span m="4798980">If</span> <span m="4799070">you</span> <span m="4799760">think</span> <span m="4799980">about</span> <span m="4800230">it,</span> <span m="4800640">there's</span> <span m="4800730">probably</span> <span m="4801230">hundreds</span> <span m="4801340">of</span> <span m="4801900">system</span> <span m="4802220">calls that the</span> <span m="4802650">kernel</span> <span m="4802990">provides</span> <span m="4803275">you.</span> <span m="4803960">And</span> <span m="4804540">they're</span> <span m="4804700">not</span> <span m="4805100">especially</span> <span m="4805930">precisely</span> <span m="4806910">documented,</span> <span m="4807205">so</span> <span m="4807500">you</span> <span m="4807610">probably</span> <span m="4807850">have</span> <span m="4808000">to look at their</span> <span m="4808370">implementation</span> <span m="4808695">and</span> <span m="4809020">see</span> <span m="4809305">if,</span> <span m="4809590">for</span> <span m="4809750">every</span> <span m="4810080">system</span> <span m="4810370">call,</span> <span m="4811010">if there's some</span> <span m="4811360">way</span> <span m="4811650">for</span> <span m="4811940">the</span> <span m="4812540">applications</span> <span m="4813150">to</span> <span m="4813380">get</span> <span m="4813650">the system call</span> <span m="4814200">to</span> <span m="4814710">perform</span> <span m="4815090">some</span> <span m="4815410">operation</span> <span m="4816010">on</span> <span m="4816100">some</span> <span m="4816260">extra</span> <span m="4816530">object</span> <span m="4816940">that didn't have</span> <span m="4817280">a</span> <span m="4817660">file descriptor to it.</span> </p>
<p><span m="4818600">And</span> <span m="4818850">most</span> <span m="4819100">Unix system calls</span> <span m="4819880">weren't</span> <span m="4820490">written</span> <span m="4821050">with</span> <span m="4821210">the</span> <span m="4821740">expectation</span> <span m="4822280">of</span> <span m="4822350">everything</span> <span m="4822870">has</span> <span m="4823020">to</span> <span m="4823080">be</span> <span m="4823380">operation</span> <span m="4823510">on</span> <span m="4823640">a</span> <span m="4823770">file</span> <span m="4824160">descriptor.</span> <span m="4824600">So</span> <span m="4825150">you</span> <span m="4825230">really</span> <span m="4825430">have to</span> <span m="4825730">get</span> <span m="4825960">every</span> <span m="4826240">system</span> <span m="4826590">all</span> <span m="4826720">right.</span> <span m="4827160">And</span> <span m="4827670">probably</span> <span m="4827980">more</span> <span m="4828230">worryingly</span> <span m="4828900">is</span> <span m="4829090">that</span> <span m="4829480">the</span> <span m="4829630">kernel</span> <span m="4829940">has</span> <span m="4830100">to</span> <span m="4830480">be</span> <span m="4830640">free</span> <span m="4830880">of bugs,</span> <span m="4831365">like</span> <span m="4831850">buffer</span> <span m="4832075">overflows</span> <span m="4832300">or</span> <span m="4833260">whatever</span> <span m="4833560">other</span> <span m="4833690">memory</span> <span m="4833960">corruption</span> <span m="4834430">like</span> <span m="4834620">you guys</span> <span m="4834960">explained</span> <span m="4835110">[INAUDIBLE].</span> </p>
<p><span m="4835800">Otherwise,</span> <span m="4836700">all of this</span> <span m="4836940">is</span> <span m="4837260">complete</span> <span m="4837580">nonsense.</span> <span m="4837940">You just are</span> <span m="4838320">on</span> <span m="4838680">arbitrary</span> <span m="4839150">assembly</span> <span m="4839210">code</span> <span m="4839490">in the</span> <span m="4839840">kernel,</span> <span m="4840300">and</span> <span m="4840926">you have full</span> <span m="4841700">control of the</span> <span m="4842050">machine.</span> </p>
<p><span m="4843768">AUDIENCE: [INAUDIBLE].</span> </p>
<p><span m="4852225">PROFESSOR:</span> <span m="4852650">Yeah.</span> <span m="4853300">I</span> <span m="4853560">guess,</span> <span m="4853990">yeah.</span> <span m="4854100">So the one</span> <span m="4854300">thing I</span> <span m="4854630">didn't get a</span> <span m="4855190">chance to</span> <span m="4855380">talk</span> <span m="4855600">about</span> <span m="4855900">is</span> <span m="4856090">alternative</span> <span m="4856560">things.</span> <span m="4856780">So</span> <span m="4856943">this</span> <span m="4857106">is</span> <span m="4857270">in</span> <span m="4857720">FreeBSD.</span> <span m="4858150">Linux</span> <span m="4858480">has this</span> <span m="4858720">thing</span> <span m="4858960">called</span> <span m="4859210">[INAUDIBLE],</span> <span m="4859990">that</span> <span m="4860310">allows</span> <span m="4860580">you</span> <span m="4860670">to</span> <span m="4860750">specify</span> <span m="4861110">which</span> <span m="4861340">system</span> <span m="4861780">calls</span> <span m="4862080">you</span> <span m="4862410">can operate.</span> <span m="4864140">If you</span> <span m="4864420">squinted,</span> <span m="4864610">it's</span> <span m="4865060">kind of</span> <span m="4865420">like</span> <span m="4865600">Capsicum</span> <span m="4866070">but</span> <span m="4866100">very</span> <span m="4866700">different,</span> <span m="4867130">in</span> <span m="4867210">the</span> <span m="4867300">sense</span> <span m="4867540">that</span> <span m="4867800">Capsicum</span> <span m="4868190">talks</span> <span m="4868410">about</span> <span m="4868600">specific</span> <span m="4869060">file</span> <span m="4869400">descriptors that you can</span> <span m="4869950">operate.</span> <span m="4871010">And</span> <span m="4871340">in</span> <span m="4871510">Linux,</span> <span m="4871720">the</span> <span m="4871830">[INAUDIBLE]</span> <span m="4872370">mechanism</span> <span m="4872970">lets</span> <span m="4873130">you</span> <span m="4873200">talk</span> <span m="4873380">about</span> <span m="4873580">specific</span> <span m="4874040">system calls</span> <span m="4874520">that you could</span> <span m="4875100">run.</span> </p>
<p><span m="4876040">So</span> <span m="4876610">it's</span> <span m="4876810">probably</span> <span m="4877160">less</span> <span m="4877540">fine</span> <span m="4877840">grained,</span> <span m="4878670">but</span> <span m="4879005">it's</span> <span m="4879660">what's</span> <span m="4879990">available</span> <span m="4880400">in</span> <span m="4880530">Linux</span> <span m="4880660">today.</span> <span m="4882110">And</span> <span m="4882800">it's</span> <span m="4883240">actually</span> <span m="4883520">probably</span> <span m="4883770">a</span> <span m="4883810">good</span> <span m="4883960">idea</span> <span m="4884330">to</span> <span m="4884540">look</span> <span m="4884830">at your</span> <span m="4884920">applications</span> <span m="4885260">and</span> <span m="4885600">see</span> <span m="4885650">what</span> <span m="4885820">system</span> <span m="4886120">call</span> <span m="4886455">do you</span> <span m="4886790">expect</span> <span m="4887120">it to make</span> <span m="4887515">and</span> <span m="4887980">then</span> <span m="4888240">code in</span> <span m="4888570">a</span> <span m="4888940">filter</span> <span m="4889450">and</span> <span m="4890130">allow it</span> <span m="4890510">to</span> <span m="4890570">make</span> <span m="4890870">only</span> <span m="4891090">those</span> <span m="4891260">system</span> <span m="4891430">calls.</span> <span m="4891770">The problem</span> <span m="4891980">is that</span> <span m="4892430">if you</span> <span m="4892500">have</span> <span m="4892660">any</span> <span m="4893010">interesting</span> <span m="4893340">applications,</span> <span m="4893790">it'll</span> <span m="4894150">probably</span> <span m="4894430">run</span> <span m="4894630">exec</span> <span m="4894940">and</span> <span m="4895390">open</span> <span m="4895800">and</span> <span m="4895940">write,</span> <span m="4896215">and</span> <span m="4896490">that's</span> <span m="4896680">probably</span> <span m="4896930">enough</span> <span m="4897200">to</span> <span m="4897420">do</span> <span m="4897690">quite</span> <span m="4897970">a</span> <span m="4898020">bit</span> <span m="4898260">of</span> <span m="4898370">damage</span> <span m="4898680">to</span> <span m="4898950">the</span> <span m="4899070">system.</span> <span m="4899460">So that's why you</span> <span m="4899570">probably want</span> <span m="4899700">the</span> <span m="4900410">more</span> <span m="4900660">fine-grained</span> <span m="4900990">system like</span> <span m="4901260">Capsicum,</span> <span m="4902280">where</span> <span m="4902450">you</span> <span m="4902560">can</span> <span m="4902930">say,</span> <span m="4903170">well,</span> <span m="4903480">you</span> <span m="4903590">can</span> <span m="4903770">run</span> <span m="4904060">right,</span> <span m="4904380">but only on</span> <span m="4905150">this</span> <span m="4905360">thing,</span> <span m="4905630">not on</span> <span m="4905970">my</span> <span m="4907330">entire</span> <span m="4907620">home</span> <span m="4907810">directory.</span> </p>
<p><span m="4909530">All</span> <span m="4909610">right.</span> <span m="4909850">So I</span> <span m="4909920">guess</span> <span m="4910070">we're</span> <span m="4910330">out of time</span> <span m="4910600">to talk about</span> <span m="4910800">Capsicum.</span> <span m="4911520">So</span> <span m="4911810">let's</span> <span m="4912010">talk</span> <span m="4912280">about</span> <span m="4912630">native</span> <span m="4912890">clients</span> <span m="4913250">on</span> <span m="4913710">Wednesday</span> <span m="4914050">and a</span> <span m="4914390">different</span> <span m="4914690">way to</span> <span m="4914990">sandbox</span> <span m="4915290">programs.</span> </p>
</div>
        <div id="vid_related" itemprop="description" class="tabContent hide">
<h2 class="subhead">Free Downloads</h2>
<h3 class="subsubhead">Video</h3>
<ul>
<li>iTunes U (<a href="https://itunes.apple.com/us/itunes-u/id1017908130">MP4 - 182MB</a>)</li>
<li>Internet Archive (<a href="https://archive.org/download/MIT6.858F14/MIT6_858F14_lec06_300k.mp4">MP4 - 182MB</a>)</li>
</ul>
<br><h3 class="subsubhead">Subtitle</h3>
<ul><li>English - US (<a href="../../../contents/video-lectures/lecture-6-capabilities/TQhmua7Z2cY.srt">SRT</a>)</li></ul>
</div>
    
   </div>  



      					 
        <div class="" id="parent-fieldname-bottom_html_area">
            
            
        </div>
    
               </main><!--Course_inner_media tag close -->
</div>
<!--Course_wrapper tag close -->
            </div>
<!--left tag close -->
            <aside id="right"><!--Begin Right Portion --><div>
    
<div id="portletwrapper-6f63772e7269676874746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a646f6e617465" class="portletWrapper kssattr-portlethash-6f63772e7269676874746f70706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a646f6e617465">
<div class="portletStaticText portlet-static-donate"><p class="zero"><a href="http://ocw.mit.edu/give"><img src="../../../common/images/button_donate-now.png" alt="Give Now." class="donate"></a></p></div>

</div>




</div>

                	<div>
    



</div>


        <div class="" id="parent-fieldname-rsi_top_html_area">
            
            
        </div>
    

<!-- RSI google ad space-->


<div id="google_ads">    
    <script type="text/javascript" src="https://partner.googleadservices.com/gampad/google_service.js"></script><script type="text/javascript">GS_googleAddAdSenseService("ca-pub-6588555046597237");GS_googleEnableAllServices();</script><script type="text/javascript">GA_googleAddSlot("ca-pub-6588555046597237", "VIDEO_INDIVIDUAL_SLOT_A_DL");GA_googleAddSlot("ca-pub-6588555046597237", "VIDEO_INDIVIDUAL_SLOT_B_DL");GA_googleAddSlot("ca-pub-6588555046597237", "VIDEO_INDIVIDUAL_SLOT_C_DL");</script><script type="text/javascript">GA_googleFetchAds();</script><script language="javascript" type="text/javascript">
GA_googleAddAttr("TYPE","HOUSE");
GA_googleAddAttr("DEPARTMENT","6");
GA_googleAddAttr("CRS_BEG2","85");
GA_googleAddAttr("CRS_END","8");
GA_googleAddAttr("SESSION","F");
GA_googleAddAttr("YEAR","14");
</script><script type="text/javascript">GA_googleFillSlot("VIDEO_INDIVIDUAL_SLOT_A_DL");</script><script type="text/javascript">GA_googleFillSlot("VIDEO_INDIVIDUAL_SLOT_B_DL");</script><script type="text/javascript">GA_googleFillSlot("VIDEO_INDIVIDUAL_SLOT_C_DL");</script>
</div>

<!-- End RSI ads--> 

<div>
    



</div>

            </aside><!--Right div close --><div class="clear"></div>
        </div>
<!--grid tag close -->
      </div>
		
		<footer id="bottom"><div id="grid">
				
<div id="portletwrapper-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572" class="portletWrapper kssattr-portlethash-6f63772e626f74746f6d706f72746c65746d616e616765720a636f6e746578740a2f506c6f6e650a736974652d666f6f746572">
<div class="portletStaticText portlet-static-site-footer"><div id="footer">
<nav aria-label="Footer"><nav id="foot-c1" class="grid_2 alpha" aria-labelledby="f-find-courses"><span class="footer" id="f-find-courses" aria-hidden="true">Find Courses</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/courses/find-by-topic/">Find by Topic</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-number/">Find by Course Number</a></li>
    <li><a href="https://ocw.mit.edu/courses/find-by-department/">Find by Department</a></li>
    <li><a href="https://ocw.mit.edu/educator/?view=instructional&amp;utm_campaign=Educator&amp;utm_source=footer&amp;utm_medium=find-courses&amp;utm_content=approaches">Instructional Approach</a></li>
    <li><a href="https://ocw.mit.edu/educator/?view=teaching&amp;utm_campaign=Educator&amp;utm_source=footer&amp;utm_medium=find-courses&amp;utm_content=materials">Teaching Materials</a></li>
    <li><a href="https://ocw.mit.edu/courses/new-courses/">New Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/most-visited-courses/">Most Visited Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/ocw-scholar/">OCW Scholar Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/audio-video-courses/">Audio/Video Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/subtitled/">Courses with Subtitles</a></li>
    <li><a href="https://ocw.mit.edu/courses/online-textbooks/">Online Textbooks</a></li>
    <li><a href="https://ocw.mit.edu/courses/instructor-insights/">Instructor Insights</a></li>
    <li><a href="https://ocw.mit.edu/resources/">Supplemental Resources</a></li>
    <li><a href="https://ocw.mit.edu/courses/translated-courses/">Translated Courses</a></li>
    <li><a href="https://ocw.mit.edu/courses/?utm_source=ocw-footer&amp;utm_medium=link&amp;utm_campaign=mclstudy">View All Courses</a></li>
</ul></nav><div id="foot-c2" class="grid_2">
<nav aria-labelledby="f-about"><span id="f-about" class="footer" aria-hidden="true">About</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/about/">About OpenCourseWare</a></li>
    <li><a href="https://ocw.mit.edu/about/site-statistics/">Site Statistics</a></li>
    <li><a href="https://ocw.mit.edu/about/ocw-stories/">OCW Stories</a></li>
    <li><a href="https://ocw.mit.edu/about/newsletter/">News</a></li>
    <li><a href="https://ocw.mit.edu/about/media-coverage/press-releases/">Press Releases</a></li>
</ul></nav><!--about--><nav aria-labelledby="f-tools"><span id="f-tools" class="footer" aria-hidden="true">Tools</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/help/">Help &amp; FAQs</a></li>
    <li><a href="../../../common/jsp/feedback.htm">Contact Us</a></li>
    <li><a href="../../../common/search/AdvancedSearch.htm">Advanced Search</a></li>
    <li><a href="https://ocw.mit.edu/help/site-map/">Site Map</a></li>
    <li><a href="../../../common/terms/index.htm">Privacy &amp; Terms of Use</a></li>
    <li><a href="https://ocw.mit.edu/help/rss/">RSS Feeds</a></li>
</ul></nav><!--tools-->
</div>
<nav class="grid_2" id="foot-c3" aria-labelledby="f-donate"><span id="f-donate" class="footer" aria-hidden="true">Give Now</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/give/">Make a Donation</a></li>
    <li><a href="https://ocw.mit.edu/give/why-give/">Why Give?</a></li>
    <li><a href="https://ocw.mit.edu/give/our-supporters/">Our Supporters</a></li>
    <li><a href="https://ocw.mit.edu/give/other-ways-to-contribute/">Other Ways to Contribute</a></li>
    <li><a href="https://ocw.mit.edu/give/shop-ocw/">Shop OCW</a></li>
    <li><a href="https://ocw.mit.edu/support/">Become a Corporate Sponsor</a></li>
</ul></nav><div class="grid_2" id="foot-c4"><nav aria-labelledby="f-featured-sites"><span id="f-featured-sites" class="footer" aria-hidden="true">Featured Sites</span>
<ul class="foot-bullet" role="presentation">
<li><a href="https://ocw.mit.edu/high-school/">Highlights for High School</a></li>
    <li><a href="https://ocw.mit.edu/educator/?utm_campaign=Educator&amp;utm_source=footer&amp;utm_medium=featured-sites">OCW Educator</a></li>
    <li><a href="https://ocw.mit.edu/courses/crosslinks/">MIT Crosslinks and OCW</a></li>
    <li><a href="https://ocw.mit.edu/courses/mitx-related-courseware/">MITx and Related OCW Courses</a></li>
    <li><a href="http://k12videos.mit.edu" aria-label="External Link: MIT+K12 Videos">MIT+K12 Videos</a></li>
    <li><a href="http://teachingexcellence.mit.edu/" aria-label="External Link: Teaching Excellence at MIT">Teaching Excellence at MIT</a></li>
    <li><a href="https://outreach.mit.edu/" aria-label="External Link: Outreach at MIT">Outreach@MIT</a></li>
    <li><a href="http://www.oeconsortium.org/" aria-label="External Link: Open Education Consortium">Open Education Consortium</a></li>
</ul></nav></div>
</nav><aside style="min-height: 289px;" aria-labelledby="f-our-corporate-supporters" class="grid_4 omega" id="foot-c5"><span aria-hidden="true" class="footer" id="f-our-corporate-supporters">Our Corporate Supporters</span>           <!-- HOME_CORP_LOGO_1 -->
<div id="div-gpt-ad-1388181177156-0" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-0'); });
            </script></div>
<!-- HOME_CORP_LOGO_2 -->
<div id="div-gpt-ad-1388181177156-1" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-1'); });
            </script></div>
<!-- HOME_CORP_LOGO_3 -->
<div id="div-gpt-ad-1388181177156-2" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-2'); });
            </script></div>
<!-- HOME_CORP_LOGO_4 -->
<div id="div-gpt-ad-1388181177156-3" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-3'); });
            </script></div>
<!-- HOME_CORP_LOGO_5 -->
<div id="div-gpt-ad-1388181177156-4" class="sponsors_google_ads_even"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-4'); });
              </script></div>
<!-- HOME_CORP_LOGO_6 -->
<div id="div-gpt-ad-1388181177156-5" class="sponsors_google_ads_odd"><script type="text/javascript">
              googletag.cmd.push(function() { googletag.display('div-gpt-ad-1388181177156-5'); });
              </script></div>
</aside><div class="grid_12 alpha omega" itemprop="publisher" itemscope="" itemtype="http://schema.org/CollegeOrUniversity">
<h4 class="footer" style="border-top: thin solid #d5c9ba; padding-top: 10px; margin-bottom: 10px;">About <span itemprop="name">MIT OpenCourseWare</span>
</h4>
<p style="color: #999; font-size: 1em; line-height: 1.5em; margin-top: 10px;" itemprop="description">MIT OpenCourseWare makes the materials used in the teaching of almost all of MIT's subjects available on the Web, free of charge. With more than 2,400 courses available, OCW is delivering on the promise of open sharing of knowledge. <a href="http://ocw.mit.edu/about/">Learn more »</a></p>
</div>
<div id="foot-copy" class="grid_12 alpha omega" style="border-top: none;">
<a href="http://web.mit.edu"><img src="../../../common/images/logo_mit.png" alt="Massachusetts Institute of Technology logo and name." style="width: 195; height: 44;"></a><a href="http://odl.mit.edu"><img src="https://ocw.mit.edu/images/logo_odl.png" alt="MIT Office of Digital Learning logo and name." style="width: 289; height: 54; vertical-align: top;"></a><a href="http://www.oeconsortium.org/"><img src="https://ocw.mit.edu/images/logo_oec.png" alt="Open Education Consortium logo." style="width: 219px; height: 59px; vertical-align: top;"></a><a rel="license" itemprop="useRightsUrl" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="../../../common/images/cc_by-nc-sa.png" alt="Creative Commons logo with terms BY-NC-SA." style="width: 126px; height: 44px; margin-right: 0; margin-left: 13px;"></a>
<p class="copyright">© 2001–2017<br>
Massachusetts Institute of Technology</p>
<p style="font-size: 0.9em; margin-bottom: 15px;">Your use of the MIT OpenCourseWare site and materials is subject to our <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license">Creative Commons License</a> and other <a href="../../../common/terms/index.htm" rel="cc:morePermissions">terms of use</a>.</p>
</div>
</div></div>

</div>





                
			</div> <!-- bottom grid end -->
		</footer><!-- footer bottom end -->
</body>
</html>
